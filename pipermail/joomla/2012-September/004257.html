<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-51353372-3"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-51353372-3');
</script>
   <TITLE> [joomla] question about redirect - remediating hacked Joomla website
   </TITLE>
   <LINK REL="Index" HREF="http://nyphp.org/pipermail/joomla/2012-September/index.html" >
   <LINK REL="made" HREF="mailto:joomla%40lists.nyphp.org?Subject=Re:%20Re%3A%20%5Bjoomla%5D%20question%20about%20redirect%20-%20remediating%20hacked%20Joomla%20website&In-Reply-To=%3C4351643.2126991.1346788860941.JavaMail.root%40vms170031%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   
   <LINK REL="Next"  HREF="004258.html">
 <meta name="description" content="PHP jobs stackware web application support and development forums for Mongo LAMP MySQL SQL Windows IIS Linux." />
<meta name="author" content="Stackware Web Development - http://stackware.com" />
<meta name="verify-v1" content="zWMoPwMn/dolscLkjLXTpRqgr9K8bzlzL1vM9WTjpHc=" />
<meta name="msvalidate.01" content="F85F81C1D0BAB5C349E8395628845E27" />
<meta name="y_key" content="265502be3db4fb6e" />
</HEAD>
         <BODY BGCOLOR="#ffffff">
<h1 style="float: right; margin: 0; padding: 0 0 0 15px;"><a href="https://www.meetup.com/new-york-php/">NYCPHP Meetup</a></h1><h1><a href="http://www.nyphp.org">NYPHP.org</a></h1>
   <H1>[joomla] question about redirect - remediating hacked Joomla website</H1>
    <B>Mark Simko</B> 
    <A HREF="mailto:joomla%40lists.nyphp.org?Subject=Re:%20Re%3A%20%5Bjoomla%5D%20question%20about%20redirect%20-%20remediating%20hacked%20Joomla%20website&In-Reply-To=%3C4351643.2126991.1346788860941.JavaMail.root%40vms170031%3E"
       TITLE="[joomla] question about redirect - remediating hacked Joomla website">masimko at verizon.net
       </A><BR>
    <I>Tue Sep  4 16:01:00 EDT 2012</I>
    <P><UL>
        
        <LI>Next message: <A HREF="004258.html">[joomla] question about redirect - remediating hacked Joomla	website
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#4257">[ date ]</a>
              <a href="thread.html#4257">[ thread ]</a>
              <a href="subject.html#4257">[ subject ]</a>
              <a href="author.html#4257">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>I've fixed up a Joomla 1.5 based web site that was hacked to redirect to a malware site.

I was not able to find any of the Joomla files changed, nor did I find any changes in the database.

What I did find is that the .htaccess file was changed. In addition, several other .htaccess files were added in several subdirectories of the site.
Also found several php files in the tmp directory with the redirect url encoded with a preg_replace function. The evaluation string had another string encased in single quotes inserted to it.

I was able to ftp the whole site preserving the time stamps on the files. I removed all the .htaccess files and replaced the original one with an unadulterated one.

that set most of the site back to normal. I have one persistent problem.

I have looked through the database using string search, and I have replaced all the joomla core with newest version.

And I've looked for index.html files that might be adulterated, but haven't found any.

The problem ... (finally!)

When I direct a browser to:

<A HREF="http://affectedsite.com/adminstrator/index.php">http://affectedsite.com/adminstrator/index.php</A>

I can get to the administrator console.

I cannot get to the admin console with

<A HREF="http://affectedsite.com/administrator">http://affectedsite.com/administrator</A>

for that I get an error message in the browser window

Illegal variable _files or _env or _get or _post or _cookie or _server or _session or globals passed to script.

and the address in the browser is

<A HREF="http://affectedsite.com/kunend/homepages/4/changed/htdocs/administrator/htttp://reltime2012(dont">http://affectedsite.com/kunend/homepages/4/changed/htdocs/administrator/htttp://reltime2012(dont</A> try it)ru/frunleh?9

Note the second malformed url inserted at the end! 

======

Does anyone know where I can look to find where this is coming from. I thought perhaps a plugin, but I haven't been able to find anything. I also checked for an index.html file, but none is there.

Thanks,
Mark

</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	
	<LI>Next message: <A HREF="004258.html">[joomla] question about redirect - remediating hacked Joomla	website
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#4257">[ date ]</a>
              <a href="thread.html#4257">[ thread ]</a>
              <a href="subject.html#4257">[ subject ]</a>
              <a href="author.html#4257">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.nyphp.org/mailman/listinfo/joomla">More information about the Joomla
mailing list</a><br>
</body></html>
