<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-51353372-3"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-51353372-3');
</script>
   <TITLE> [mambo] Access Control Question
   </TITLE>
   <LINK REL="Index" HREF="http://nyphp.org/pipermail/joomla/2005-July/index.html" >
   <LINK REL="made" HREF="mailto:joomla%40lists.nyphp.org?Subject=Re:%20Re%3A%20%5Bmambo%5D%20Access%20Control%20Question&In-Reply-To=%3C004201c58249%24351ddc20%245106a8c0%40picnetryan%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="000256.html">
   <LINK REL="Next"  HREF="000258.html">
 <meta name="description" content="PHP jobs stackware web application support and development forums for Mongo LAMP MySQL SQL Windows IIS Linux." />
<meta name="author" content="Stackware Web Development - http://stackware.com" />
<meta name="verify-v1" content="zWMoPwMn/dolscLkjLXTpRqgr9K8bzlzL1vM9WTjpHc=" />
<meta name="msvalidate.01" content="F85F81C1D0BAB5C349E8395628845E27" />
<meta name="y_key" content="265502be3db4fb6e" />
</HEAD>
         <BODY BGCOLOR="#ffffff">
<h1 style="float: right; margin: 0; padding: 0 0 0 15px;"><a href="https://www.meetup.com/new-york-php/">NYCPHP Meetup</a></h1><h1><a href="http://www.nyphp.org">NYPHP.org</a></h1>
   <H1>[mambo] Access Control Question</H1>
    <B>Ryan Ozimek</B> 
    <A HREF="mailto:joomla%40lists.nyphp.org?Subject=Re:%20Re%3A%20%5Bmambo%5D%20Access%20Control%20Question&In-Reply-To=%3C004201c58249%24351ddc20%245106a8c0%40picnetryan%3E"
       TITLE="[mambo] Access Control Question">cozimek at picnet.net
       </A><BR>
    <I>Wed Jul  6 12:38:58 EDT 2005</I>
    <P><UL>
        <LI>Previous message: <A HREF="000256.html">[mambo] Access Control Question
</A></li>
        <LI>Next message: <A HREF="000258.html">[mambo] Access Control Question
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#257">[ date ]</a>
              <a href="thread.html#257">[ thread ]</a>
              <a href="subject.html#257">[ subject ]</a>
              <a href="author.html#257">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hans,

So, if I'm reading this right, these functions you have below can control
front-end access to components, such as those you're developing or adding
to, correct?  I'm wondering if anyone has done this on the back-end as well.
It would be great to have some funcs I can drop into our homemade components
that will allow access to the components only if the administrator has the
right level of access in the backend permissions.

Did that make sense?

-Ryan

-----Original Message-----
From: <A HREF="http://lists.nyphp.org/mailman/listinfo/joomla">mambo-bounces at lists.nyphp.org</A> [mailto:<A HREF="http://lists.nyphp.org/mailman/listinfo/joomla">mambo-bounces at lists.nyphp.org</A>]
On Behalf Of Hans C. Kaspersetz
Sent: Wednesday, July 06, 2005 9:35 AM
To: <A HREF="http://lists.nyphp.org/mailman/listinfo/joomla">NYPHP at nyphp.org</A>; <A HREF="http://lists.nyphp.org/mailman/listinfo/joomla">SIG at nyphp.org</A>:Mambo
Subject: [mambo] Access Control Question


Over the last week I have been developing a site using components 
developed by third parties.  One of the biggest problems I have found is 
the inconsistent or non-existent support of access controls in 
components.  Below you will find two functions I pulled from 
com_comprofiler.  I have been adding these functions to other components 
like com_mtree and com_akoForms to control access to them.  I am 
interested to know if the Mambo core has functions that do what 
allowAccess and userGID do?  I would like to use Mambo core code and not 
access control code placed in each component.  I looked through the API 
documentation on the Mambo site and nothing jumped out at me.

Also, is there a standard way component developers should implement 
access control in their components?  Has the Mambo team documented the 
recommended implementation?

I regularly find it mind numbing that component developers charge for 
incomplete or buggy components.  For example, Mosets Tree offers no 
access controls to their content.  I emailed the developer and he said 
that I should not post the link to the content, to control access.  
Arrgg.......  My one bit of gratitude is that I have to source and can 
add access controls if I like and can submit the patches.

Thanks,
Hans

So here is the source:

/*************************************************************
* Mambo Community Builder
* Author MamboJoe
* @ Released under GNU/GPL License : <A HREF="http://www.gnu.org/copyleft/gpl.html">http://www.gnu.org/copyleft/gpl.html</A>
*************************************************************/


function allowAccess( $accessgroupid,$recurse, $usersgroupid, &amp;$acl)
   {
    // &quot;agroup:&quot;.$accessgroupid.&quot; ugroupid:&quot;.$usersgroupid.&quot; recurse 
&quot;.$recurse;
      if ($accessgroupid == -2 || ($accessgroupid == -1 &amp;&amp; $usersgroupid 
 &gt; 0)  || $usersgroupid == 17 || $usersgroupid == 23|| $usersgroupid == 
24|| $usersgroupid == 25) {
    //grant public access or access to all registered users
         return 1;
      }
      else {
    //need to do more checking based on more restrictions
         if( $usersgroupid == $accessgroupid ) {
         //direct match
         return 1;
         }
         else {
            if ($recurse=='RECURSE') {
               //check if there are children groups
               $groupchildern=array();
               $groupchildren=$acl-&gt;get_group_children( $accessgroupid, 
'ARO', $recurse );

               if ( is_array( $groupchildren ) &amp;&amp; count( $groupchildren 
) &gt; 0) {
                  if ( in_array($usersgroupid, $groupchildren) ) {
                     //match
                     return 1;
                  }
               }
            }
         }
     //deny access
     return 0;
   }
}

function userGID($oID){
      global $database;
    if($oID &gt; 0) {
    $query = &quot;SELECT gid FROM #__users WHERE id = '&quot;.$oID.&quot;'&quot;;
    $database-&gt;setQuery($query);
    $gid = $database-&gt;loadResult();
    return $gid;
    }
    else return 0;
}
_______________________________________________
New to Mambo? Get a great start here:
<A HREF="http://forum.mamboserver.com/showthread.php?t=42100">http://forum.mamboserver.com/showthread.php?t=42100</A>

New York PHP SIG: Mambo Mailing List
AMP Technology
Supporting Apache, MySQL, PHP &amp;amp; Mambo!
<A HREF="http://lists.nyphp.org/mailman/listinfo/mambo">http://lists.nyphp.org/mailman/listinfo/mambo</A>
<A HREF="http://www.nyphp.org">http://www.nyphp.org</A>




</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="000256.html">[mambo] Access Control Question
</A></li>
	<LI>Next message: <A HREF="000258.html">[mambo] Access Control Question
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#257">[ date ]</a>
              <a href="thread.html#257">[ thread ]</a>
              <a href="subject.html#257">[ subject ]</a>
              <a href="author.html#257">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.nyphp.org/mailman/listinfo/joomla">More information about the Joomla
mailing list</a><br>
</body></html>
