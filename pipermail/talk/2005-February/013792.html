<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-51353372-3"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-51353372-3');
</script>
   <TITLE> [nycphp-talk] Safely running root commands
   </TITLE>
   <LINK REL="Index" HREF="http://nyphp.org/pipermail/talk/2005-February/index.html" >
   <LINK REL="made" HREF="mailto:talk%40lists.nyphp.org?Subject=Re:%20Re%3A%20%5Bnyphp-talk%5D%20Safely%20running%20root%20commands&In-Reply-To=%3C0MKyxe-1D5bp636wl-00016Z%40mrelay.perfora.net%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="013791.html">
   <LINK REL="Next"  HREF="013793.html">
 <meta name="description" content="PHP jobs stackware web application support and development forums for Mongo LAMP MySQL SQL Windows IIS Linux." />
<meta name="author" content="Stackware Web Development - http://stackware.com" />
<meta name="verify-v1" content="zWMoPwMn/dolscLkjLXTpRqgr9K8bzlzL1vM9WTjpHc=" />
<meta name="msvalidate.01" content="F85F81C1D0BAB5C349E8395628845E27" />
<meta name="y_key" content="265502be3db4fb6e" />
</HEAD>
         <BODY BGCOLOR="#ffffff">
<h1 style="float: right; margin: 0; padding: 0 0 0 15px;"><a href="https://www.meetup.com/new-york-php/">NYCPHP Meetup</a></h1><h1><a href="http://www.nyphp.org">NYPHP.org</a></h1>
   <H1>[nycphp-talk] Safely running root commands</H1>
    <B>Hans Zaunere</B> 
    <A HREF="mailto:talk%40lists.nyphp.org?Subject=Re:%20Re%3A%20%5Bnyphp-talk%5D%20Safely%20running%20root%20commands&In-Reply-To=%3C0MKyxe-1D5bp636wl-00016Z%40mrelay.perfora.net%3E"
       TITLE="[nycphp-talk] Safely running root commands">lists at zaunere.com
       </A><BR>
    <I>Sun Feb 27 22:43:55 EST 2005</I>
    <P><UL>
        <LI>Previous message: <A HREF="013791.html">[nycphp-talk] Safely running root commands
</A></li>
        <LI>Next message: <A HREF="013793.html">[nycphp-talk] Safely running root commands
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#13792">[ date ]</a>
              <a href="thread.html#13792">[ thread ]</a>
              <a href="subject.html#13792">[ subject ]</a>
              <a href="author.html#13792">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>
&gt;<i> &gt; I've thought of three ways to do it: 1) have the sysadmin create a sudo
</I>&gt;<i> &gt; user that can run the given commands with no password, 2) create a
</I>&gt;<i> &gt; sudo user and store his name and password outside of the document root,
</I>&gt;<i> &gt; or 3) write some C wrappers and set them suid. I'm not crazy about any
</I>&gt;<i> &gt; of these solutions.
</I>&gt;<i> 
</I>&gt;<i> When faced with these options, I would choose #1.
</I>
The simplest and most straight forward would probably be number 1 or 2 - but then don't forget that sudo is basically like giving them root for that command.  If that command can modify, the sudo can too.

3) is probably the safest if written well, but then there lies the trick :)  For complex root operations, like filesystem stuff, I hand commands off to a very simple and carefully written daemon that runs as root.  The daemon only accepts very specific commands and responds accodringly.  This is actually similar to option 3, except that the apache process is &quot;further&quot; away from the infamous UID 0 in many ways.

&gt;<i> &gt; Anybody else have a better idea?
</I>&gt;<i> 
</I>&gt;<i> Well back in the old days I would copy the binaries required (when
</I>&gt;<i> possible) to a separate path for the httpd/apache user, but I was
</I>&gt;<i> always very careful to restrict what the apache user could do.
</I>&gt;<i> 
</I>&gt;<i> Your OS on the server may also provide some extra protection (chroot
</I>&gt;<i> jails etc.). I'm definitely interested to see what everyone else would
</I>&gt;<i> do in this situation.
</I>
Since the scope of root operations needed in this case seem limited, I'd avoid root all together.  How about a cronjob that dumps the info you need to a database, or even a file?  Or a queue system, where jobs are queued by apache, and a cronjob wakes up every so often to fill the queue with a response?  There might be some delay, but depending on the load you expect, it might be insignificant.


---
Hans Zaunere
President, Founder

New York PHP
<A HREF="http://www.nyphp.org">http://www.nyphp.org</A>

AMP Technology
Supporting Apache, MySQL and PHP



</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="013791.html">[nycphp-talk] Safely running root commands
</A></li>
	<LI>Next message: <A HREF="013793.html">[nycphp-talk] Safely running root commands
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#13792">[ date ]</a>
              <a href="thread.html#13792">[ thread ]</a>
              <a href="subject.html#13792">[ subject ]</a>
              <a href="author.html#13792">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.nyphp.org/mailman/listinfo/talk">More information about the talk
mailing list</a><br>
</body></html>
