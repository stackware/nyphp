<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-51353372-3"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-51353372-3');
</script>
   <TITLE> [nycphp-talk] Is it safe to log unsanitized,	unvalidated 	user-inputted data into a logfile?
   </TITLE>
   <LINK REL="Index" HREF="http://nyphp.org/pipermail/talk/2009-April/index.html" >
   <LINK REL="made" HREF="mailto:talk%40lists.nyphp.org?Subject=Re:%20Re%3A%20%5Bnyphp-talk%5D%20Is%20it%20safe%20to%20log%20unsanitized%2C%0A%09unvalidated%20%09user-inputted%20data%20into%20a%20logfile%3F&In-Reply-To=%3C78c6bd860904052017x7c47cd97v8a78c9069c730cb5%40mail.gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="027826.html">
   <LINK REL="Next"  HREF="027829.html">
 <meta name="description" content="PHP jobs stackware web application support and development forums for Mongo LAMP MySQL SQL Windows IIS Linux." />
<meta name="author" content="Stackware Web Development - http://stackware.com" />
<meta name="verify-v1" content="zWMoPwMn/dolscLkjLXTpRqgr9K8bzlzL1vM9WTjpHc=" />
<meta name="msvalidate.01" content="F85F81C1D0BAB5C349E8395628845E27" />
<meta name="y_key" content="265502be3db4fb6e" />
</HEAD>
         <BODY BGCOLOR="#ffffff">
<h1 style="float: right; margin: 0; padding: 0 0 0 15px;"><a href="https://www.meetup.com/new-york-php/">NYCPHP Meetup</a></h1><h1><a href="http://www.nyphp.org">NYPHP.org</a></h1>
   <H1>[nycphp-talk] Is it safe to log unsanitized,	unvalidated 	user-inputted data into a logfile?</H1>
    <B>Michael B Allen</B> 
    <A HREF="mailto:talk%40lists.nyphp.org?Subject=Re:%20Re%3A%20%5Bnyphp-talk%5D%20Is%20it%20safe%20to%20log%20unsanitized%2C%0A%09unvalidated%20%09user-inputted%20data%20into%20a%20logfile%3F&In-Reply-To=%3C78c6bd860904052017x7c47cd97v8a78c9069c730cb5%40mail.gmail.com%3E"
       TITLE="[nycphp-talk] Is it safe to log unsanitized,	unvalidated 	user-inputted data into a logfile?">ioplex at gmail.com
       </A><BR>
    <I>Sun Apr  5 23:17:05 EDT 2009</I>
    <P><UL>
        <LI>Previous message: <A HREF="027826.html">[nycphp-talk] Is it safe to log unsanitized,	unvalidated 	user-inputted data into a logfile?
</A></li>
        <LI>Next message: <A HREF="027829.html">[nycphp-talk] Is it safe to log unsanitized,	unvalidated 	user-inputted data into a logfile?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#27828">[ date ]</a>
              <a href="thread.html#27828">[ thread ]</a>
              <a href="subject.html#27828">[ subject ]</a>
              <a href="author.html#27828">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On Sun, Apr 5, 2009 at 9:06 PM, Brian Williams &lt;<A HREF="http://lists.nyphp.org/mailman/listinfo/talk">brianw1975 at gmail.com</A>&gt; wrote:
&gt;<i> phpinfo() pish...
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> $user_input = &quot;`rm -Rf /`&quot;
</I>&gt;<i>
</I>&gt;<i> nuff said.
</I>&gt;<i>
</I>&gt;<i> in case it wasn't - backticks are basically the short cut to get PHP to
</I>&gt;<i> execute something on the command line.
</I>
I don't understand how this has any impact on the OP's code. The
backticks would simply be written to the log file. If you are careless
enough to try to execute a log file as a shell script then you might
as well erase your disk.

&gt;<i> always check incoming user data.
</I>
Actually I do not validate incoming data. At least not when it is
first received. I assume everything is tainted until it gets to the
point of where it really matters and then I validate it there. If I'm
writing some field to a database, I always escape the data just before
it's inserted so if someone supplies total garbage it doesn't matter.
As long as it's escaped it's completely benign (to the database).

In fact I would go so far as to say that validating data at the
point-of-entry is a coding error. For example, Joomla! validates
usernames before it passes them to authentication plugins. This is an
error because Joomla! does not know what a valid username is in the
context of the external authority. At one point Joomla! would not work
with OpenID or Windows Active Directory because it explicitly excluded
certain characters that were valid for those external authorities. The
proper solution is to allow the authentication plugin to define
username validation and provide a default implementation that can
easily be overridden.

Note that even though validating data when it is first received is not
critical to security, escaping output /is/ critical to security. So
it's ok to receive garbage. Just don't send garbage. This leads me
back to the OP's question of &quot;do I need to validate user input that is
written to a log file?&quot;. The answer is no but you do need to escape
(or rather remove, truncate or flatten) anything that you don't want
to end up being read by a program that reads log files like passwords
and excessively long messages that might fill up the disk or prevent
someone from viewing the log.

Mike

&gt;<i> On Sun, Apr 5, 2009 at 8:56 PM, Konstantin Rozinov &lt;<A HREF="http://lists.nyphp.org/mailman/listinfo/talk">krozinov at gmail.com</A>&gt;
</I>&gt;<i> wrote:
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Hey guys,
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> I have a question about logging messages.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Is it safe to log unsanitized, unvalidated user-inputted data into a
</I>&gt;&gt;<i> logfile?
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> For example, if I have a function called check_username(), which
</I>&gt;&gt;<i> checks that the username only consists of A-Za-z0-9, is it safe to
</I>&gt;&gt;<i> have check_username() write to a logfile that it was called on the
</I>&gt;&gt;<i> particaular user-inputted string, like so:
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Function definition:
</I>&gt;&gt;<i> function check_username($username, &amp;$error)
</I>&gt;&gt;<i> {
</I>&gt;&gt;<i> &#160;.. set $log_file...
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> &#160;/* print out informational message. */
</I>&gt;&gt;<i> &#160;error_log(__FUNCTION__ . '(' . $username . '): called.', 3, $log_file);
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> &#160;..check the username for correctness..
</I>&gt;&gt;<i> }
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Function called like so:
</I>&gt;&gt;<i> check_username('$_POST['username'], $error);
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Output to logfile:
</I>&gt;&gt;<i> check_username(user1): called.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Is it possible for an attacker to submit &#160;a specific string as the
</I>&gt;&gt;<i> $username to somehow &quot;escape&quot; out of the error_log() function and have
</I>&gt;&gt;<i> code executed instead (like calling phpinfo())?
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> thanks,
</I>&gt;&gt;<i> Konstantin
</I>&gt;&gt;<i> _______________________________________________
</I>&gt;&gt;<i> New York PHP User Group Community Talk Mailing List
</I>&gt;&gt;<i> <A HREF="http://lists.nyphp.org/mailman/listinfo/talk">http://lists.nyphp.org/mailman/listinfo/talk</A>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> <A HREF="http://www.nyphp.org/show_participation.php">http://www.nyphp.org/show_participation.php</A>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> _______________________________________________
</I>&gt;<i> New York PHP User Group Community Talk Mailing List
</I>&gt;<i> <A HREF="http://lists.nyphp.org/mailman/listinfo/talk">http://lists.nyphp.org/mailman/listinfo/talk</A>
</I>&gt;<i>
</I>&gt;<i> <A HREF="http://www.nyphp.org/show_participation.php">http://www.nyphp.org/show_participation.php</A>
</I>&gt;<i>
</I>


-- 
Michael B Allen
Java Active Directory Integration
<A HREF="http://www.ioplex.com/">http://www.ioplex.com/</A>

</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="027826.html">[nycphp-talk] Is it safe to log unsanitized,	unvalidated 	user-inputted data into a logfile?
</A></li>
	<LI>Next message: <A HREF="027829.html">[nycphp-talk] Is it safe to log unsanitized,	unvalidated 	user-inputted data into a logfile?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#27828">[ date ]</a>
              <a href="thread.html#27828">[ thread ]</a>
              <a href="subject.html#27828">[ subject ]</a>
              <a href="author.html#27828">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.nyphp.org/mailman/listinfo/talk">More information about the talk
mailing list</a><br>
</body></html>
