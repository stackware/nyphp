<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-51353372-3"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-51353372-3');
</script>
   <TITLE> [nycphp-talk] Is it safe to log unsanitized,	unvalidated 	user-inputted data into a logfile?
   </TITLE>
   <LINK REL="Index" HREF="http://nyphp.org/pipermail/talk/2009-April/index.html" >
   <LINK REL="made" HREF="mailto:talk%40lists.nyphp.org?Subject=Re:%20Re%3A%20%5Bnyphp-talk%5D%20Is%20it%20safe%20to%20log%20unsanitized%2C%0A%09unvalidated%20%09user-inputted%20data%20into%20a%20logfile%3F&In-Reply-To=%3Cae0c70e80904052147p289ece2bh6ecee388e020fff3%40mail.gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="027828.html">
   <LINK REL="Next"  HREF="027830.html">
 <meta name="description" content="PHP jobs stackware web application support and development forums for Mongo LAMP MySQL SQL Windows IIS Linux." />
<meta name="author" content="Stackware Web Development - http://stackware.com" />
<meta name="verify-v1" content="zWMoPwMn/dolscLkjLXTpRqgr9K8bzlzL1vM9WTjpHc=" />
<meta name="msvalidate.01" content="F85F81C1D0BAB5C349E8395628845E27" />
<meta name="y_key" content="265502be3db4fb6e" />
</HEAD>
         <BODY BGCOLOR="#ffffff">
<h1 style="float: right; margin: 0; padding: 0 0 0 15px;"><a href="https://www.meetup.com/new-york-php/">NYCPHP Meetup</a></h1><h1><a href="http://www.nyphp.org">NYPHP.org</a></h1>
   <H1>[nycphp-talk] Is it safe to log unsanitized,	unvalidated 	user-inputted data into a logfile?</H1>
    <B>Brian Williams</B> 
    <A HREF="mailto:talk%40lists.nyphp.org?Subject=Re:%20Re%3A%20%5Bnyphp-talk%5D%20Is%20it%20safe%20to%20log%20unsanitized%2C%0A%09unvalidated%20%09user-inputted%20data%20into%20a%20logfile%3F&In-Reply-To=%3Cae0c70e80904052147p289ece2bh6ecee388e020fff3%40mail.gmail.com%3E"
       TITLE="[nycphp-talk] Is it safe to log unsanitized,	unvalidated 	user-inputted data into a logfile?">brianw1975 at gmail.com
       </A><BR>
    <I>Mon Apr  6 00:47:58 EDT 2009</I>
    <P><UL>
        <LI>Previous message: <A HREF="027828.html">[nycphp-talk] Is it safe to log unsanitized,	unvalidated 	user-inputted data into a logfile?
</A></li>
        <LI>Next message: <A HREF="027830.html">[nycphp-talk] Is it safe to log unsanitized,	unvalidated 	user-inputted data into a logfile?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#27829">[ date ]</a>
              <a href="thread.html#27829">[ thread ]</a>
              <a href="subject.html#27829">[ subject ]</a>
              <a href="author.html#27829">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On Sun, Apr 5, 2009 at 11:17 PM, Michael B Allen &lt;<A HREF="http://lists.nyphp.org/mailman/listinfo/talk">ioplex at gmail.com</A>&gt; wrote:

&gt;<i> On Sun, Apr 5, 2009 at 9:06 PM, Brian Williams &lt;<A HREF="http://lists.nyphp.org/mailman/listinfo/talk">brianw1975 at gmail.com</A>&gt;
</I>&gt;<i> wrote:
</I>&gt;<i> &gt; phpinfo() pish...
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; $user_input = &quot;`rm -Rf /`&quot;
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; nuff said.
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; in case it wasn't - backticks are basically the short cut to get PHP to
</I>&gt;<i> &gt; execute something on the command line.
</I>&gt;<i>
</I>&gt;<i> I don't understand how this has any impact on the OP's code. The
</I>&gt;<i> backticks would simply be written to the log file. If you are careless
</I>&gt;<i> enough to try to execute a log file as a shell script then you might
</I>&gt;<i> as well erase your disk.
</I>&gt;<i>
</I>
and if the text isn't passed with double quotes?



&gt;<i>
</I>&gt;<i> &gt; always check incoming user data.
</I>&gt;<i>
</I>&gt;<i> Actually I do not validate incoming data. At least not when it is
</I>&gt;<i> first received. I assume everything is tainted until it gets to the
</I>&gt;<i> point of where it really matters and then I validate it there. If I'm
</I>&gt;<i> writing some field to a database, I always escape the data just before
</I>&gt;<i> it's inserted so if someone supplies total garbage it doesn't matter.
</I>&gt;<i> As long as it's escaped it's completely benign (to the database).
</I>&gt;<i>
</I>
Don't be absurd.

You are long-windedly saying that you validate user-input just like everyone
else -- before you put it in the database and before you present it back to
the user.  All of that *typically* happens in short order.

You can't test the database for a username existance if you haven't
completely escaped it beforehand.



&gt;<i>
</I>&gt;<i> In fact I would go so far as to say that validating data at the
</I>&gt;<i> point-of-entry is a coding error. For example, Joomla! validates
</I>&gt;<i> usernames before it passes them to authentication plugins. This is an
</I>&gt;<i> error because Joomla! does not know what a valid username is in the
</I>&gt;<i> context of the external authority. At one point Joomla! would not work
</I>&gt;<i> with OpenID or Windows Active Directory because it explicitly excluded
</I>&gt;<i> certain characters that were valid for those external authorities. The
</I>&gt;<i> proper solution is to allow the authentication plugin to define
</I>&gt;<i> username validation and provide a default implementation that can
</I>&gt;<i> easily be overridden.
</I>

This is overly complicating the matter because the OP never mentioned
Joomla! or any other specific instances of using said data outside of
inserting into the log file.

if his code had read:

error_log(__FUNCTION__ . &quot;($username): called.&quot;, 3, $log_file);

I wouldn't have made any comment at all.

If the backticked code were not in double quotes it would be executed and
the resulting output of the backticked code would be recorded to the log.




&gt;<i> Note that even though validating data when it is first received is not
</I>&gt;<i> critical to security, escaping output /is/ critical to security. So
</I>&gt;<i> it's ok to receive garbage. Just don't send garbage.
</I>

are you joking?  how do you test for &quot;garbage&quot; without having tested the
input?  how do you tell your php script what garbage is?  You can't, at best
you can only program the script to test for what *isn't* garbage - i.e. a
regex. and then proceed to allow the function to work safely.



&gt;<i> This leads me
</I>&gt;<i> back to the OP's question of &quot;do I need to validate user input that is
</I>&gt;<i> written to a log file?&quot;. The answer is no but you do need to escape
</I>&gt;<i> (or rather remove, truncate or flatten) anything that you don't want
</I>&gt;<i> to end up being read by a program that reads log files like passwords
</I>&gt;<i> and excessively long messages that might fill up the disk or prevent
</I>&gt;<i> someone from viewing the log.
</I>

i admit, yes, you have to escape stuff before it gets recorded (which is
obvious)... but you also have to make sure that by contatenating text to
anything that the text does not actually *do* something if the text is
referenced without double quotes.

throw &lt;?php echo &quot;this is a test of `ls -al ./`&quot; . `ls -al ./`;?&gt; into a
file and see what happens.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.nyphp.org/pipermail/talk/attachments/20090406/d59e1d66/attachment.html">http://lists.nyphp.org/pipermail/talk/attachments/20090406/d59e1d66/attachment.html</A>&gt;
</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="027828.html">[nycphp-talk] Is it safe to log unsanitized,	unvalidated 	user-inputted data into a logfile?
</A></li>
	<LI>Next message: <A HREF="027830.html">[nycphp-talk] Is it safe to log unsanitized,	unvalidated 	user-inputted data into a logfile?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#27829">[ date ]</a>
              <a href="thread.html#27829">[ thread ]</a>
              <a href="subject.html#27829">[ subject ]</a>
              <a href="author.html#27829">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.nyphp.org/mailman/listinfo/talk">More information about the talk
mailing list</a><br>
</body></html>
