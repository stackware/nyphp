<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-51353372-3"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-51353372-3');
</script>
   <TITLE> [nycphp-talk] E-Commerce Shopping Carts
   </TITLE>
   <LINK REL="Index" HREF="http://nyphp.org/pipermail/talk/2008-September/index.html" >
   <LINK REL="made" HREF="mailto:talk%40lists.nyphp.org?Subject=Re:%20Re%3A%20%5Bnyphp-talk%5D%20E-Commerce%20Shopping%20Carts&In-Reply-To=%3C0K80001GJAB5CFT0%40mta5.srv.hcvlny.cv.net%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="026774.html">
   <LINK REL="Next"  HREF="026745.html">
 <meta name="description" content="PHP jobs stackware web application support and development forums for Mongo LAMP MySQL SQL Windows IIS Linux." />
<meta name="author" content="Stackware Web Development - http://stackware.com" />
<meta name="verify-v1" content="zWMoPwMn/dolscLkjLXTpRqgr9K8bzlzL1vM9WTjpHc=" />
<meta name="msvalidate.01" content="F85F81C1D0BAB5C349E8395628845E27" />
<meta name="y_key" content="265502be3db4fb6e" />
</HEAD>
         <BODY BGCOLOR="#ffffff">
<h1 style="float: right; margin: 0; padding: 0 0 0 15px;"><a href="https://www.meetup.com/new-york-php/">NYCPHP Meetup</a></h1><h1><a href="http://www.nyphp.org">NYPHP.org</a></h1>
   <H1>[nycphp-talk] E-Commerce Shopping Carts</H1>
    <B>(Margaret) Michele Waldman</B> 
    <A HREF="mailto:talk%40lists.nyphp.org?Subject=Re:%20Re%3A%20%5Bnyphp-talk%5D%20E-Commerce%20Shopping%20Carts&In-Reply-To=%3C0K80001GJAB5CFT0%40mta5.srv.hcvlny.cv.net%3E"
       TITLE="[nycphp-talk] E-Commerce Shopping Carts">mmwaldman at optonline.net
       </A><BR>
    <I>Tue Sep 30 07:23:30 EDT 2008</I>
    <P><UL>
        <LI>Previous message: <A HREF="026774.html">[nycphp-talk] E-Commerce Shopping Carts
</A></li>
        <LI>Next message: <A HREF="026745.html">[nycphp-talk] SWF -&gt; JPEG/GIF?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#26775">[ date ]</a>
              <a href="thread.html#26775">[ thread ]</a>
              <a href="subject.html#26775">[ subject ]</a>
              <a href="author.html#26775">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Paul,

Are you writing a shopping cart from scatch.

I don't think this is the easiest way to implement a shopping cart.

There are two open source shopping carts that I know about, oscommerce and
zencart.  Plus, there are many inexpensive shopping carts.

Zencart handles the payment notifications.  If you use a non supported or
merchant that doesn't have a plugin available, you have to write some of the
gateway yourself, but all of the email notifications come canned.

As far as the payment gateway.  If I'm correct, via curl or whatever you
sent connect to the merchant and request a payment, they return a success or
non success value, after which you can send an email.

You get the response right away, so I don't know why you want to poll.

Here's so snippets of code:

	  $QBMS_XML_Credit_Card_Charge = '&lt;?xml version=&quot;1.0&quot;?&gt;
	                                &lt;?qbmsxml version=&quot;2.0&quot;?&gt;
	
&lt;QBMSXML&gt;
	
&lt;SignonMsgsRq&gt;'.$QBMS_Auth.'
	
&lt;/SignonMsgsRq&gt;
	
&lt;QBMSXMLMsgsRq&gt;
	
&lt;CustomerCreditCardChargeRq&gt;
	
&lt;TransRequestID&gt;'.$QBMS_TransRequestID.'&lt;/TransRequestID&gt;
	
&lt;CreditCardNumber&gt;'.$_POST['CreditCardNumber'].'&lt;/CreditCardNumber&gt;
	
&lt;ExpirationMonth&gt;'.$_POST['ExpirationMonth'].'&lt;/ExpirationMonth&gt;
	
&lt;ExpirationYear&gt;'.$_POST['ExpirationYear'].'&lt;/ExpirationYear&gt;
	
&lt;IsECommerce&gt;true&lt;/IsECommerce&gt;
	
&lt;Amount&gt;'.$_POST['Amount'].'&lt;/Amount&gt;
	
&lt;NameOnCard&gt;'.$_POST['CreditCardOwner'].'&lt;/NameOnCard&gt;
	
&lt;CreditCardAddress&gt;'.$_POST['CreditCardAddress'].'&lt;/CreditCardAddress&gt;
	
&lt;CreditCardPostalCode&gt;'.$_POST['CreditCardPostalCode'].'&lt;/CreditCardPostalCo
de&gt;
	
&lt;CardSecurityCode&gt;'.$_POST['CardSecurityCode'].'&lt;/CardSecurityCode&gt;
	
&lt;/CustomerCreditCardChargeRq&gt;
	
&lt;/QBMSXMLMsgsRq&gt;
	
&lt;/QBMSXML&gt;';
   $QBMS_chargeRq = $this-&gt;qbms_call($QBMS_ApplicationPath,
$QBMS_XML_Credit_Card_Charge, MODULE_PAYMENT_QBMS_SSL_CERT);

	// Get the statusCode
   $QBMS_ChargeRq_Status = 1;
   $posLeft  = strpos($QBMS_chargeRq, &quot;&lt;CustomerCreditCardChargeRs
statusCode=\&quot;&quot;)+strlen(&quot;&lt;CustomerCreditCardChargeRs statusCode=\&quot;&quot;);
   $posRight = strpos($QBMS_chargeRq, &quot;\&quot;&quot;, $posLeft+1);
   $QBMS_ChargeRq_Status = intval(substr($QBMS_chargeRq, $posLeft,
$posRight-$posLeft));

	// QBMS will return statusCode=&quot;0&quot; or &quot;10100&quot; if charge was
successful
	switch ($QBMS_ChargeRq_Status)
    {
	  case 0:
	  case 10100:
		$this-&gt;qbms_charge_success($QBMS_chargeRq);
		return;
      case 10301:
	  case 10400:
	  case 10401:
	  case 10402:
	  case 10404:
	  case 10407:
	  case 10409:
		$error = MODULE_PAYMENT_QBMS_TEXT_DECLINED;
		break;
	  default:
		$error = MODULE_PAYMENT_QBMS_TEXT_SYSTEM_ERROR . &quot; &quot; .
$QBMS_ChargeRq_Status . &quot; &lt;!--&quot; . $QBMS_chargeRq . &quot;--&gt;&quot;;
		break;
    }
	$payment_error_return = 'payment_error=' . $this-&gt;code . '&amp;error=' .
urlencode($error) . '&amp;qbms_cc_owner=' . urlencode($_POST['CreditCardOwner'])
. '&amp;qbms_cc_expires_month=' . $_POST['ExpirationMonth'] .
'&amp;qbms_cc_expires_year=' . $_POST['ExpirationYear'];
    zen_redirect(zen_href_link(FILENAME_CHECKOUT_PAYMENT,
$payment_error_return, 'SSL', true, false));
  }


  function qbms_call($qbmsURL, $qbmsRequest, $qbmsCert) {
    global $_POST;
    $PHP_Header[] = &quot;Content-type: application/x-qbmsxml&quot;;
	$PHP_Header[] = &quot;Content-length: &quot;.strlen($qbmsRequest);

	$clientURL = curl_init();

	curl_setopt($clientURL, CURLOPT_POST, 1);
	curl_setopt($clientURL, CURLOPT_RETURNTRANSFER, 1);
	curl_setopt($clientURL, CURLOPT_CUSTOMREQUEST, 'POST');
	curl_setopt($clientURL, CURLOPT_URL, $qbmsURL);
//	curl_setopt($clientURL, CURLOPT_TIMEOUT, 60);
	curl_setopt($clientURL, CURLOPT_HTTPHEADER, $PHP_Header);
	curl_setopt($clientURL, CURLOPT_POSTFIELDS, $qbmsRequest);
	curl_setopt($clientURL, CURLOPT_VERBOSE, 1);
	curl_setopt($clientURL, CURLOPT_SSL_VERIFYPEER, 1);
//	if (MODULE_PAYMENT_QBMS_HOSTEDORDESKTOP == 'Hosted') {
//	    curl_setopt($clientURL, CURLOPT_SSLCERT, $qbmsCert);
//    }
   curl_setopt($clientURL, CURLOPT_USERAGENT, $_SERVER['HTTP_USER_AGENT']);
//??
   curl_setopt ($clientURL, CURLOPT_PROXYTYPE, CURLPROXY_HTTP);
   curl_setopt ($clientURL,
CURLOPT_PROXY,&quot;<A HREF="http://proxy.shr.secureserver.net:3128">http://proxy.shr.secureserver.net:3128</A>&quot;);
//    if (MODULE_PAYMENT_QBMS_IP_ADDRESS != '') {
//    	curl_setopt($clientURL, CURLOPT_INTERFACE,
MODULE_PAYMENT_QBMS_IP_ADDRESS);
//    }

	$qbmsResponse = curl_exec($clientURL);

	if ((curl_errno($clientURL)) || ($qbmsResponse == 1)) {

      $curlerrno = curl_errno($clientURL);
	  $error = MODULE_PAYMENT_QBMS_TEXT_SYSTEM_ERROR;
      $payment_error_return = 'payment_error=' . $this-&gt;code . '&amp;error=' .
urlencode($error) . '&amp;qbms_cc_owner=' . urlencode($_POST['CreditCardOwner'])
. '&amp;qbms_cc_expires_month=' . $_POST['ExpirationMonth'] .
'&amp;qbms_cc_expires_year=' . $_POST['ExpirationYear'];
      zen_redirect(zen_href_link(FILENAME_CHECKOUT_PAYMENT,
$payment_error_return, 'SSL', true, false));
	} else {
	  curl_close($clientURL);
	}

	return $qbmsResponse;
  }

Michele

-----Original Message-----
From: <A HREF="http://lists.nyphp.org/mailman/listinfo/talk">talk-bounces at lists.nyphp.org</A> [mailto:<A HREF="http://lists.nyphp.org/mailman/listinfo/talk">talk-bounces at lists.nyphp.org</A>] On
Behalf Of PaulCheung
Sent: Tuesday, September 30, 2008 4:49 AM
To: NYPHP Talk
Subject: [nycphp-talk] E-Commerce Shopping Carts

Hi,

Can anybody help?? I have run into a major problem, I do not understand how 
shopping carts work. I have tried asking technical support of the likes of 
PayPal, while they are all very knowledgeable businesswise, they are not PHP

developers. I was told that I should check my email periodically.

As a shopping cart newbie using PHP, I am lost. I understand it is develop 
myself or much the easiest and best way is to use a shopping cart, which I 
agree with.

&gt;<i>From a merchant's point of view, here is what I want. Once payment has been
</I>
made and confirmed, I want a token confirming payment (payment info) to be 
sent to my site and then, without manual intervention, I want to dispatch a 
confirmation email to the customer an invoice and then the goods/services to

the customer.

Is there a way of  automatically polling for this info?? Is there a better 
of doing things??

Cheers

Paul 

_______________________________________________
New York PHP Community Talk Mailing List
<A HREF="http://lists.nyphp.org/mailman/listinfo/talk">http://lists.nyphp.org/mailman/listinfo/talk</A>

NYPHPCon 2006 Presentations Online
<A HREF="http://www.nyphpcon.com">http://www.nyphpcon.com</A>

Show Your Participation in New York PHP
<A HREF="http://www.nyphp.org/show_participation.php">http://www.nyphp.org/show_participation.php</A>


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="026774.html">[nycphp-talk] E-Commerce Shopping Carts
</A></li>
	<LI>Next message: <A HREF="026745.html">[nycphp-talk] SWF -&gt; JPEG/GIF?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#26775">[ date ]</a>
              <a href="thread.html#26775">[ thread ]</a>
              <a href="subject.html#26775">[ subject ]</a>
              <a href="author.html#26775">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.nyphp.org/mailman/listinfo/talk">More information about the talk
mailing list</a><br>
</body></html>
