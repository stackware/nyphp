<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-51353372-3"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-51353372-3');
</script>
   <TITLE> [nycphp-talk] Best way to handle LimitRequestBody $_REQUEST	limitation
   </TITLE>
   <LINK REL="Index" HREF="http://nyphp.org/pipermail/talk/2004-June/index.html" >
   <LINK REL="made" HREF="mailto:talk%40lists.nyphp.org?Subject=Re:%20Re%3A%20%5Bnyphp-talk%5D%20Best%20way%20to%20handle%20LimitRequestBody%20%24_REQUEST%0A%09limitation&In-Reply-To=%3C40D76614.5040102%40adnet-sys.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="009991.html">
   <LINK REL="Next"  HREF="009993.html">
 <meta name="description" content="PHP jobs stackware web application support and development forums for Mongo LAMP MySQL SQL Windows IIS Linux." />
<meta name="author" content="Stackware Web Development - http://stackware.com" />
<meta name="verify-v1" content="zWMoPwMn/dolscLkjLXTpRqgr9K8bzlzL1vM9WTjpHc=" />
<meta name="msvalidate.01" content="F85F81C1D0BAB5C349E8395628845E27" />
<meta name="y_key" content="265502be3db4fb6e" />
</HEAD>
         <BODY BGCOLOR="#ffffff">
<h1 style="float: right; margin: 0; padding: 0 0 0 15px;"><a href="https://www.meetup.com/new-york-php/">NYCPHP Meetup</a></h1><h1><a href="http://www.nyphp.org">NYPHP.org</a></h1>
   <H1>[nycphp-talk] Best way to handle LimitRequestBody $_REQUEST	limitation</H1>
    <B>Phillip Powell</B> 
    <A HREF="mailto:talk%40lists.nyphp.org?Subject=Re:%20Re%3A%20%5Bnyphp-talk%5D%20Best%20way%20to%20handle%20LimitRequestBody%20%24_REQUEST%0A%09limitation&In-Reply-To=%3C40D76614.5040102%40adnet-sys.com%3E"
       TITLE="[nycphp-talk] Best way to handle LimitRequestBody $_REQUEST	limitation">phillip.powell at adnet-sys.com
       </A><BR>
    <I>Mon Jun 21 18:49:56 EDT 2004</I>
    <P><UL>
        <LI>Previous message: <A HREF="009991.html">[nycphp-talk] Best way to handle LimitRequestBody $_REQUEST	limitation
</A></li>
        <LI>Next message: <A HREF="009993.html">[nycphp-talk] Best way to handle LimitRequestBody	$_REQUESTlimitation
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#9992">[ date ]</a>
              <a href="thread.html#9992">[ thread ]</a>
              <a href="subject.html#9992">[ subject ]</a>
              <a href="author.html#9992">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hans Zaunere wrote:

&gt;&gt;<i>Background: I'm building a totally portable/scalable/secure file 
</I>&gt;&gt;<i>cataloging system in PHP version 4.3.2; this application will be 
</I>&gt;&gt;<i>portable for all systems that have PHP, whether Windows or Unix or 
</I>&gt;&gt;<i>whatever as its goal as it is a web-based portable application.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>This application allows you to upload a file of a certain file size
</I>&gt;&gt;<i>    
</I>&gt;&gt;<i>
</I>&gt;<i>that 
</I>&gt;<i>  
</I>&gt;<i>
</I>&gt;&gt;<i>I have set up.  For example, if you set $maxImageFileSize to 100K then
</I>&gt;&gt;<i>    
</I>&gt;&gt;<i>
</I>&gt;<i>
</I>&gt;<i>  
</I>&gt;<i>
</I>&gt;&gt;<i>no image larger than 100K can be uploaded to the system, it won't let 
</I>&gt;&gt;<i>you.  This works just fine.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>However, if I try to upload an image or something that is larger than 
</I>&gt;&gt;<i>LimitRequestBody size of, for example, 524K, the results are a bit
</I>&gt;&gt;<i>    
</I>&gt;&gt;<i>
</I>&gt;<i>more 
</I>&gt;<i>  
</I>&gt;<i>
</I>&gt;&gt;<i>problematic than an error message, all sorts of bad crap occur
</I>&gt;&gt;<i>    
</I>&gt;&gt;<i>
</I>&gt;<i>depending 
</I>&gt;<i>  
</I>&gt;<i>
</I>&gt;&gt;<i>on your browser that blows up the entire application.
</I>&gt;&gt;<i>    
</I>&gt;&gt;<i>
</I>&gt;<i>
</I>&gt;<i>Aye... because Apache doesn't like it.
</I>&gt;<i>  
</I>&gt;<i>
</I>
Yeppers.. not a PHP thing, it's an Apache thing.  No friendly means that 
I know of to say &quot;Hey too big get over it!&quot;

&gt;<i>  
</I>&gt;<i>
</I>&gt;&gt;<i>I want to know the best-practice method to handle this.  Readjusting 
</I>&gt;&gt;<i>LimitRequestBody in /etc/httpd/conf.d/php.conf is not an option 
</I>&gt;&gt;<i>according to my company because this application is, again, designed
</I>&gt;&gt;<i>    
</I>&gt;&gt;<i>
</I>&gt;<i>to 
</I>&gt;<i>  
</I>&gt;<i>
</I>&gt;&gt;<i>be portable, so that it can be mounted on Client A's server or Client 
</I>&gt;&gt;<i>B's server or Client Z's server and work exactly the same on all three
</I>&gt;&gt;<i>    
</I>&gt;&gt;<i>
</I>&gt;<i>
</I>&gt;<i>  
</I>&gt;<i>
</I>&gt;&gt;<i>even if all three have completely different configurations to 
</I>&gt;&gt;<i>LimitRequestBody.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>So, what do I do?  Files &lt; 100K are fine; files 100K+ - 524K are fine;
</I>&gt;&gt;<i>    
</I>&gt;&gt;<i>
</I>&gt;<i>
</I>&gt;<i>  
</I>&gt;<i>
</I>&gt;&gt;<i>files &gt; 524K bomb the entire application and I can't figure out what
</I>&gt;&gt;<i>    
</I>&gt;&gt;<i>
</I>&gt;<i>to 
</I>&gt;<i>  
</I>&gt;<i>
</I>&gt;&gt;<i>do about that.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>I tried displaying a message that stated that the maximum image file 
</I>&gt;&gt;<i>size that this installation of PHP on this server can handle is 524K
</I>&gt;&gt;<i>    
</I>&gt;&gt;<i>
</I>&gt;<i>but 
</I>&gt;<i>  
</I>&gt;<i>
</I>&gt;&gt;<i>using ini_get('LimitRequestBody') and get_cfg_var('LimitRequestBody') 
</I>&gt;&gt;<i>both failed.
</I>&gt;&gt;<i>    
</I>&gt;&gt;<i>
</I>&gt;<i>
</I>&gt;<i>LimitRequestBody isn't a PHP configuration directive... it's from Apache
</I>&gt;<i>itself.
</I>&gt;<i>
</I>&gt;<i><A HREF="http://httpd.apache.org/docs/mod/core.html#limitrequestbody">http://httpd.apache.org/docs/mod/core.html#limitrequestbody</A>
</I>&gt;<i>
</I>&gt;<i>AFAIK there's no way to set it in PHP.  That said, it's not set by
</I>&gt;<i>default.  Otherwise, you could include a .htaccess file that sets it to
</I>&gt;<i>0 explicitly and thus make it unlimited.  Then again, if the deployed-to
</I>&gt;<i>Apache environment doesn't allow .htaccess directives, it wouldn't work.
</I>&gt;<i>
</I>&gt;<i>H
</I>&gt;<i>
</I>&gt;<i>_______________________________________________
</I>&gt;<i>talk mailing list
</I>&gt;<i><A HREF="http://lists.nyphp.org/mailman/listinfo/talk">talk at lists.nyphp.org</A>
</I>&gt;<i><A HREF="http://lists.nyphp.org/mailman/listinfo/talk">http://lists.nyphp.org/mailman/listinfo/talk</A>
</I>&gt;<i>
</I>&gt;<i>  
</I>&gt;<i>
</I>Cool possibly, Hans, but again, background: this application must be 
completely portable with virtually NO changes to the client's server 
environment to run it. 

I came up with the following.. works in Apache, but fails in IIS:

Following is my function I wrote to retrieve the value of 
LimitRequestBody in php.conf if the webserver is Apache:

[PHP]
/*-----------------------------------------------------------------------------------------------------------------------------
    There is no native method in PHP to obtain a value that is in a 
separate CONFIG file, particularly
    /etc/httpd/conf.d/php.conf, therefore, you will have to obtain it 
yourself the hard way: splice up the
    file and retrieve and set into a session variable, or, obtain from 
the existing session variable
  
-------------------------------------------------------------------------------------------------------------------------------*/
  function &amp;getLimitRequestBody() {
    global $limitRequestBodyFilePath;
    if ($_SESSION['limitRequestBody']) {
       return $_SESSION['limitRequestBody'];
    } else {
     $fileID = @fopen($limitRequestBodyFilePath, 'r');
     if (!$fileID) return 0;    // BOMB OUT - $limitRequestBodyFilePath 
SET IN CSV FILE AND IS REQUIRED TO OBTAIN LimitRequestBody
     $contents = @fread($fileID, filesize($limitRequestBodyFilePath));
     @fclose($fileID);
     preg_match('/LimitRequestBody[\s\t]*([0-9]+)\n*/i', $contents, 
$matchArray);
         $_SESSION['limitRequestBody'] = (int)trim($matchArray[1]);
     return (int)trim($matchArray[1]);
    }
  }               


[/PHP]

Nice function, however, HUGE dilemma: the application that will use this 
function is designed to be fully portable, that is, it can run in Apache 
or IIS or anything that can run PHP.  That means everything in this 
application needs to run equally in any webserver that can handle PHP, 
including this function.

This function works only if you're using Apache since it retrieves a 
specific file /etc/httpd/conf.d/php.conf that has a value I need that 
PHP itself cannot provide to determine the absolute limit of a request.

So how do I write this for IIS or any other PHP-friendly webserver?

Thanx
Phil

-- 
---------------------------------------------------------------------------------
Phil Powell
Multimedia Programmer
BPX Technologies, Inc.
#: (703) 709-7218 x107 
Fax: (703) 709-7219

	


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="009991.html">[nycphp-talk] Best way to handle LimitRequestBody $_REQUEST	limitation
</A></li>
	<LI>Next message: <A HREF="009993.html">[nycphp-talk] Best way to handle LimitRequestBody	$_REQUESTlimitation
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#9992">[ date ]</a>
              <a href="thread.html#9992">[ thread ]</a>
              <a href="subject.html#9992">[ subject ]</a>
              <a href="author.html#9992">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.nyphp.org/mailman/listinfo/talk">More information about the talk
mailing list</a><br>
</body></html>
