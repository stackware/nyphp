<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-51353372-3"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-51353372-3');
</script>
   <TITLE> [nycphp-talk] [Fwd: [Full-Disclosure] iDEFENSE Security Advisory 06.07.04: PHP Win32 escapeshellcmd() and escapeshellarg() Input Validation Vulnerability]
   </TITLE>
   <LINK REL="Index" HREF="http://nyphp.org/pipermail/talk/2004-June/index.html" >
   <LINK REL="made" HREF="mailto:talk%40lists.nyphp.org?Subject=Re:%20Re%3A%20%5Bnyphp-talk%5D%20%5BFwd%3A%20%5BFull-Disclosure%5D%20iDEFENSE%20Security%20Advisory%0A%2006.07.04%3A%20PHP%0A%20Win32%20escapeshellcmd%28%29%20and%20escapeshellarg%28%29%20Input%20Validation%20Vulnerability%5D&In-Reply-To=%3C40C4DF6E.9000305%40jonbaer.net%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="009790.html">
   <LINK REL="Next"  HREF="009792.html">
 <meta name="description" content="PHP jobs stackware web application support and development forums for Mongo LAMP MySQL SQL Windows IIS Linux." />
<meta name="author" content="Stackware Web Development - http://stackware.com" />
<meta name="verify-v1" content="zWMoPwMn/dolscLkjLXTpRqgr9K8bzlzL1vM9WTjpHc=" />
<meta name="msvalidate.01" content="F85F81C1D0BAB5C349E8395628845E27" />
<meta name="y_key" content="265502be3db4fb6e" />
</HEAD>
         <BODY BGCOLOR="#ffffff">
<h1 style="float: right; margin: 0; padding: 0 0 0 15px;"><a href="https://www.meetup.com/new-york-php/">NYCPHP Meetup</a></h1><h1><a href="http://www.nyphp.org">NYPHP.org</a></h1>
   <H1>[nycphp-talk] [Fwd: [Full-Disclosure] iDEFENSE Security Advisory 06.07.04: PHP Win32 escapeshellcmd() and escapeshellarg() Input Validation Vulnerability]</H1>
    <B>Jon Baer</B> 
    <A HREF="mailto:talk%40lists.nyphp.org?Subject=Re:%20Re%3A%20%5Bnyphp-talk%5D%20%5BFwd%3A%20%5BFull-Disclosure%5D%20iDEFENSE%20Security%20Advisory%0A%2006.07.04%3A%20PHP%0A%20Win32%20escapeshellcmd%28%29%20and%20escapeshellarg%28%29%20Input%20Validation%20Vulnerability%5D&In-Reply-To=%3C40C4DF6E.9000305%40jonbaer.net%3E"
       TITLE="[nycphp-talk] [Fwd: [Full-Disclosure] iDEFENSE Security Advisory 06.07.04: PHP Win32 escapeshellcmd() and escapeshellarg() Input Validation Vulnerability]">jonbaer at jonbaer.net
       </A><BR>
    <I>Mon Jun  7 17:34:38 EDT 2004</I>
    <P><UL>
        <LI>Previous message: <A HREF="009790.html">[nycphp-talk] OT:  Solaris is going open source
</A></li>
        <LI>Next message: <A HREF="009792.html">[nycphp-talk]Download Error -- need help!
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#9791">[ date ]</a>
              <a href="thread.html#9791">[ thread ]</a>
              <a href="subject.html#9791">[ subject ]</a>
              <a href="author.html#9791">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

Just FYI for those on W32 + haven't upgraded yet ...

- - Jon

- -------- Original Message --------
Subject: [Full-Disclosure] iDEFENSE Security Advisory 06.07.04: PHP
Win32 escapeshellcmd() and escapeshellarg() Input Validation Vulnerability
Date: Mon, 7 Jun 2004 15:19:29 -0400
From: <A HREF="http://lists.nyphp.org/mailman/listinfo/talk">idlabs-advisories at idefense.com</A>
Reply-To: <A HREF="http://lists.nyphp.org/mailman/listinfo/talk">customerservice at idefense.com</A>
To: &lt;<A HREF="http://lists.nyphp.org/mailman/listinfo/talk">idlabs-advisories at idefense.com</A>&gt;

PHP Win32 escapeshellcmd() and escapeshellarg() Input Validation
Vulnerability

iDEFENSE Security Advisory 06.07.04:
www.idefense.com/application/poi/display?id=108&amp;type=vulnerabilities
June 7, 2004

I. BACKGROUND

PHP is a widely-used general-purpose scripting language that is
especially suited for Web development and can be embedded into HTML.
More information is available at <A HREF="http://www.php.net.">http://www.php.net.</A>

II. DESCRIPTION

Remote exploitation of an input validation vulnerability in The PHP
Group's HTML-embedded scripting language PHP allows attackers to bypass
security protections.

The problem specifically exists within the shell command escape routines
escapeshellcmd() and escapeshellarg(). These routines are intended for
escaping shell metacharacters that may be present in user-supplied data
prior to passing them to command execution routines such as system(),
passthru(), popen(), exec() or the backtick operator. While both filter
routines are functional on the Unix platform, they fail to filter all
characters on the Windows platform. The escapeshellcmd() routine fails
to filter the characters '%|&gt;', allowing attackers to access environment
variables, redirect output and execute arbitrary commands. The
escapeshellarg() routine fails to filter the character '%', allowing an
attacker to access environment variables.

III. ANALYSIS

Exploitation allows attackers to compromise an affected system under the
web server's privileges. Systems are not vulnerable by default, as a
publicly accessible script must be present that utilizes one of the
affected routines with user-supplied data.

IV. DETECTION

iDEFENSE has confirmed the existence of this vulnerability in PHP
version 4.3.6 running on Microsoft Windows platforms. It is suspected
that previous versions are also vulnerable.

V. WORKAROUND

Pass user-supplied data through custom character filters implemented
with str_replace() or preg_replace(). Example:

~    $user_supplied = preg_replace(&quot;/[&gt;|%]/&quot;, &quot;&quot;, $user_supplied);

VI. VENDOR RESPONSE

The input validation vulnerability inside escapeshellcmd() and
escapeshellarg() on Win32 platform has been resolved. A new PHP version
(4.3.7) immune to this vulnerability is due to be released on June 3rd,
2004.

VII. CVE INFORMATION

A Mitre Corp. Common Vulnerabilities and Exposures (CVE) number has not
been assigned yet.

VIII. DISCLOSURE TIMELINE

04/05/03   Vulnerability acquired by iDEFENSE
05/07/04   iDEFENSE clients notified
05/07/04   Initial vendor notification
05/17/04   Initial vendor response
06/07/04   Public disclosure

IX. CREDIT

3APA3A is credited with this discovery.

Get paid for vulnerability research
<A HREF="http://www.idefense.com/poi/teams/vcp.jsp">http://www.idefense.com/poi/teams/vcp.jsp</A>

X. LEGAL NOTICES

Copyright (c) 2004 iDEFENSE, Inc.

Permission is granted for the redistribution of this alert
electronically. It may not be edited in any way without the express
written consent of iDEFENSE. If you wish to reprint the whole or any
part of this alert in any other medium other than electronically, please
email <A HREF="http://lists.nyphp.org/mailman/listinfo/talk">customerservice at idefense.com</A> for permission.

Disclaimer: The information in the advisory is believed to be accurate
at the time of publishing based on currently available information. Use
of the information constitutes acceptance for use in an AS IS condition.
There are no warranties with regard to this information. Neither the
author nor the publisher accepts any liability for any direct, indirect,
or consequential loss or damage arising from use of, or reliance on,
this information.

_______________________________________________
Full-Disclosure - We believe in it.
Charter: <A HREF="http://lists.netsys.com/full-disclosure-charter.html">http://lists.netsys.com/full-disclosure-charter.html</A>




- --

pgp key: <A HREF="http://www.jonbaer.net/jonbaer.asc">http://www.jonbaer.net/jonbaer.asc</A>
fingerprint: F438 A47E C45E 8B27 F68C 1F9B 41DB DB8B 9A0C AF47
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.2.4 (Cygwin)
Comment: Using GnuPG with Thunderbird - <A HREF="http://enigmail.mozdev.org">http://enigmail.mozdev.org</A>

iD8DBQFAxN9uQdvbi5oMr0cRAudWAJ4maczyY0qTbYdSGJqQWL5cDTXH6QCgmUqH
lOaqsCfoJXqT9vKsozQMu8w=
=I/6Q
-----END PGP SIGNATURE-----

</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="009790.html">[nycphp-talk] OT:  Solaris is going open source
</A></li>
	<LI>Next message: <A HREF="009792.html">[nycphp-talk]Download Error -- need help!
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#9791">[ date ]</a>
              <a href="thread.html#9791">[ thread ]</a>
              <a href="subject.html#9791">[ subject ]</a>
              <a href="author.html#9791">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.nyphp.org/mailman/listinfo/talk">More information about the talk
mailing list</a><br>
</body></html>
