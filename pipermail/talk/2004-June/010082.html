<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-51353372-3"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-51353372-3');
</script>
   <TITLE> [nycphp-talk] Recurring Monthly Calculations
   </TITLE>
   <LINK REL="Index" HREF="http://nyphp.org/pipermail/talk/2004-June/index.html" >
   <LINK REL="made" HREF="mailto:talk%40lists.nyphp.org?Subject=Re:%20Re%3A%20%5Bnyphp-talk%5D%20Recurring%20Monthly%20Calculations&In-Reply-To=%3CC0CDB9F5E81C234FBB42D84E7853125D012490B8%40intamail1.inta%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="010083.html">
   <LINK REL="Next"  HREF="010098.html">
 <meta name="description" content="PHP jobs stackware web application support and development forums for Mongo LAMP MySQL SQL Windows IIS Linux." />
<meta name="author" content="Stackware Web Development - http://stackware.com" />
<meta name="verify-v1" content="zWMoPwMn/dolscLkjLXTpRqgr9K8bzlzL1vM9WTjpHc=" />
<meta name="msvalidate.01" content="F85F81C1D0BAB5C349E8395628845E27" />
<meta name="y_key" content="265502be3db4fb6e" />
</HEAD>
         <BODY BGCOLOR="#ffffff">
<h1 style="float: right; margin: 0; padding: 0 0 0 15px;"><a href="https://www.meetup.com/new-york-php/">NYCPHP Meetup</a></h1><h1><a href="http://www.nyphp.org">NYPHP.org</a></h1>
   <H1>[nycphp-talk] Recurring Monthly Calculations</H1>
    <B>Kshitij Bedi</B> 
    <A HREF="mailto:talk%40lists.nyphp.org?Subject=Re:%20Re%3A%20%5Bnyphp-talk%5D%20Recurring%20Monthly%20Calculations&In-Reply-To=%3CC0CDB9F5E81C234FBB42D84E7853125D012490B8%40intamail1.inta%3E"
       TITLE="[nycphp-talk] Recurring Monthly Calculations">Kbedi at inta.org
       </A><BR>
    <I>Fri Jun 25 12:39:00 EDT 2004</I>
    <P><UL>
        <LI>Previous message: <A HREF="010083.html">[nycphp-talk] Recurring Monthly Calculations
</A></li>
        <LI>Next message: <A HREF="010098.html">[nycphp-talk] php5-rc hosting?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#10082">[ date ]</a>
              <a href="thread.html#10082">[ thread ]</a>
              <a href="subject.html#10082">[ subject ]</a>
              <a href="author.html#10082">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>This is something I wrote for recurring events
You can choose a date from when the event starts to occur
($month,$day,$year)
and then till when to run($month2,$day2,$year2)
It can run for daily weekly biweekly or monthly.

I hope it helps you out

----------------------------------------------------------------------------
-----------------

//$repeat day is 1 through 7 for each day of the week starting from Monday
you want the even to occur

//$occurence=1 (Daily) 
//=7(weekly) = 
//14(biweekly) 
//=28 (Monthly)

//skip saturday and sunday
$arrskipdays=array(0,6);

//$month,$day,$year is when the events starts to occur and
$month2,$day2,$year2 is until when
//The loop will run for each day of the week requested which is stored in
$repeatday.

foreach ($repeatday as $value)
	{
		//Difference between today and the day the event should
start from.
		$daydiff=$value - intval(date(&quot;w&quot;,mktime (0,0,0,$month,
$day, $year)));
		
		//if day difference is less than zero than that means that
the day should start from next week.
		if ($daydiff&lt;0) $daydiff+=7;
		
		$counter=0;
		
		//occurring weekly biweekly or monthly.
		while($counter&lt;=$diff) 
		{
			//Only insert if resulting date is less or equal to
the final date.
			if (mktime (0,0,0,$month, ($day + $daydiff +
$counter),  $year)&lt;=mktime(0,0,0,$month2,$day2,$year2))
			{
				if(!in_array(intval(date(&quot;w&quot;,mktime
(0,0,0,$month, ($day + $counter),  $year))),$arrskipdays))
				{
					echo
date(&quot;Y-m-d&quot;,mktime(0,0,0,$month, ($day + $daydiff + $counter),  $year));
					$counter=$counter + $occurrence;
				}
			}
		}	
	}

-----Original Message-----
From: Hans Zaunere [mailto:hans not <A HREF="http://lists.nyphp.org/mailman/listinfo/talk">junk at nyphp.com</A>]
Sent: Friday, June 25, 2004 12:11 PM
To: NYPHP Talk
Subject: [nycphp-talk] Recurring Monthly Calculations



Hey all,

I needed to write a function that will tell me the dates of future
events that recurr monthly by day of month.  So for instance, &quot;4th
Tuesday of the month for the next 6 months&quot;

It ended up to be more difficult than I thought and I wanted to run the
function past you guys.  See attached.  Am I missing some clever way of
doing this?  The function seems to work, but another set of eyes would
be helpful - and it depends on UNIX timestamps, so...

The function is called as:

recurMonthlyByDay(2,4,20030522,23);

Which would return an array listing the 4th Tuesday, starting in May of
2003, for the next 23 months.  If you specify the second argument to be
greater than 5, then the last Tuesday would always be returned.


Thanks guys... feel free to use the function, too (that is, if it works)

H

 &lt;&lt; File: RecurMonthlyByDay.inc &gt;&gt;  &lt;&lt; File: ATT141846.txt &gt;&gt; 

</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="010083.html">[nycphp-talk] Recurring Monthly Calculations
</A></li>
	<LI>Next message: <A HREF="010098.html">[nycphp-talk] php5-rc hosting?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#10082">[ date ]</a>
              <a href="thread.html#10082">[ thread ]</a>
              <a href="subject.html#10082">[ subject ]</a>
              <a href="author.html#10082">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.nyphp.org/mailman/listinfo/talk">More information about the talk
mailing list</a><br>
</body></html>
