<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-51353372-3"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-51353372-3');
</script>
   <TITLE> [nycphp-talk] Best way to accomplish this task
   </TITLE>
   <LINK REL="Index" HREF="http://nyphp.org/pipermail/talk/2010-February/index.html" >
   <LINK REL="made" HREF="mailto:talk%40lists.nyphp.org?Subject=Re:%20Re%3A%20%5Bnyphp-talk%5D%20Best%20way%20to%20accomplish%20this%20task&In-Reply-To=%3C5458518f1002151208n1e3d8808kda3e5583cee4e936%40mail.gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="029801.html">
   <LINK REL="Next"  HREF="029815.html">
 <meta name="description" content="PHP jobs stackware web application support and development forums for Mongo LAMP MySQL SQL Windows IIS Linux." />
<meta name="author" content="Stackware Web Development - http://stackware.com" />
<meta name="verify-v1" content="zWMoPwMn/dolscLkjLXTpRqgr9K8bzlzL1vM9WTjpHc=" />
<meta name="msvalidate.01" content="F85F81C1D0BAB5C349E8395628845E27" />
<meta name="y_key" content="265502be3db4fb6e" />
</HEAD>
         <BODY BGCOLOR="#ffffff">
<h1 style="float: right; margin: 0; padding: 0 0 0 15px;"><a href="https://www.meetup.com/new-york-php/">NYCPHP Meetup</a></h1><h1><a href="http://www.nyphp.org">NYPHP.org</a></h1>
   <H1>[nycphp-talk] Best way to accomplish this task</H1>
    <B>Anthony Papillion</B> 
    <A HREF="mailto:talk%40lists.nyphp.org?Subject=Re:%20Re%3A%20%5Bnyphp-talk%5D%20Best%20way%20to%20accomplish%20this%20task&In-Reply-To=%3C5458518f1002151208n1e3d8808kda3e5583cee4e936%40mail.gmail.com%3E"
       TITLE="[nycphp-talk] Best way to accomplish this task">papillion at gmail.com
       </A><BR>
    <I>Mon Feb 15 15:08:10 EST 2010</I>
    <P><UL>
        <LI>Previous message: <A HREF="029801.html">[nycphp-talk] Best way to accomplish this task
</A></li>
        <LI>Next message: <A HREF="029815.html">[nycphp-talk] Best way to accomplish this task
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#29810">[ date ]</a>
              <a href="thread.html#29810">[ thread ]</a>
              <a href="subject.html#29810">[ subject ]</a>
              <a href="author.html#29810">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Leam,

I spent a good part of last night thinking about this problem and I
came to the exact same conclusion you did: it's a useless charge of
resources. I think I'm going to take your advice and simply archive
the user input into the database but process it immediately when the
user submits it. A lot quicker and a lot leaner solution from a
resource standpoint.

Thanks for the input.

Anthony

On Mon, Feb 15, 2010 at 5:23 AM, Leam Hall &lt;<A HREF="http://lists.nyphp.org/mailman/listinfo/talk">leam at reuel.net</A>&gt; wrote:
&gt;<i>
</I>&gt;<i> Well, from an admin viewpoint, I'd recommend a lot more thinking before doing this. The &quot;script every minute&quot; idea causes all sorts of issues on the server as well as the database. One hokey query, or one large dataset, and you can cause a lot of problems for the entire machine.
</I>&gt;<i>
</I>&gt;<i> What I don't understand is why you need to have a cron job to deal with the user data. Why not have your processing script called when the user submits? This keeps your script from having to go through the entire database to find uncommitted changes. If you're going to have a gazillion row database aren't you going to be spending a lot of time on queries just to find those not committed?
</I>&gt;<i>
</I>&gt;<i> One other possibility would be to have a second, separate database that stores the user input. Have a script that grabs a small number of rows, does it's thing, deletes the rows it just worked on, sleeps for a couple seconds, and then calls itself. That way your primary database isn't getting hit so hard, your secondary database is the one that has to do disaster recovery, you can split the machines up if load gets too much, and your SA team won't stuff you in a trashcan when your query trashes the system.
</I>&gt;<i>
</I>&gt;<i> Leam
</I>&gt;<i>
</I>&gt;<i> Anthony Papillion wrote:
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Hello Everyone,
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> I'm designing a system that will work on a schedule. Users will submit data for processing into the database and then, every minute, a PHP script will pass through the db looking for unprocessed rows (marked pending) and process them.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> The problem is, I may eventually have a few million records to process at a time. Each record could take anywhere from a few seconds to a few minutes to perform the required operations on. My concern is making sure that the script, on the next scheduled pass, doesn't grab the records currently being processed and start processing them again.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Right now, I'm thinking of accomplishing this by updating a 'status' field in the database. So unprocessed records would have a status of 'pending', records being processed would have a status of 'processing' and completly processed record will have a status of 'complete'.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> For some reason, I see this as ugly but that's the only way I can think of making sure that records aren't duplicatly processed. So when I select records to process, I'm ONLY selecting one's with the status of 'pending' which means they are new, unprocessed.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Is there a better, more eleqent way of doing this or is this pretty much it?
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Thanks!
</I>&gt;&gt;<i> Anthony Papillion
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> ------------------------------------------------------------------------
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> _______________________________________________
</I>&gt;&gt;<i> New York PHP Users Group Community Talk Mailing List
</I>&gt;&gt;<i> <A HREF="http://lists.nyphp.org/mailman/listinfo/talk">http://lists.nyphp.org/mailman/listinfo/talk</A>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> <A HREF="http://www.nyphp.org/Show-Participation">http://www.nyphp.org/Show-Participation</A>
</I>&gt;<i>
</I>&gt;<i> _______________________________________________
</I>&gt;<i> New York PHP Users Group Community Talk Mailing List
</I>&gt;<i> <A HREF="http://lists.nyphp.org/mailman/listinfo/talk">http://lists.nyphp.org/mailman/listinfo/talk</A>
</I>&gt;<i>
</I>&gt;<i> <A HREF="http://www.nyphp.org/Show-Participation">http://www.nyphp.org/Show-Participation</A>
</I>
</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="029801.html">[nycphp-talk] Best way to accomplish this task
</A></li>
	<LI>Next message: <A HREF="029815.html">[nycphp-talk] Best way to accomplish this task
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#29810">[ date ]</a>
              <a href="thread.html#29810">[ thread ]</a>
              <a href="subject.html#29810">[ subject ]</a>
              <a href="author.html#29810">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.nyphp.org/mailman/listinfo/talk">More information about the talk
mailing list</a><br>
</body></html>
