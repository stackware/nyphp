<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-51353372-3"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-51353372-3');
</script>
   <TITLE> [nycphp-talk] shell_exec security pitfalls?
   </TITLE>
   <LINK REL="Index" HREF="http://nyphp.org/pipermail/talk/2007-July/index.html" >
   <LINK REL="made" HREF="mailto:talk%40lists.nyphp.org?Subject=Re:%20Re%3A%20%5Bnyphp-talk%5D%20shell_exec%20security%20pitfalls%3F&In-Reply-To=%3C469F0A23.3070203%40omnistep.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="022446.html">
   <LINK REL="Next"  HREF="022452.html">
 <meta name="description" content="PHP jobs stackware web application support and development forums for Mongo LAMP MySQL SQL Windows IIS Linux." />
<meta name="author" content="Stackware Web Development - http://stackware.com" />
<meta name="verify-v1" content="zWMoPwMn/dolscLkjLXTpRqgr9K8bzlzL1vM9WTjpHc=" />
<meta name="msvalidate.01" content="F85F81C1D0BAB5C349E8395628845E27" />
<meta name="y_key" content="265502be3db4fb6e" />
</HEAD>
         <BODY BGCOLOR="#ffffff">
<h1 style="float: right; margin: 0; padding: 0 0 0 15px;"><a href="https://www.meetup.com/new-york-php/">NYCPHP Meetup</a></h1><h1><a href="http://www.nyphp.org">NYPHP.org</a></h1>
   <H1>[nycphp-talk] shell_exec security pitfalls?</H1>
    <B>Rolan Yang</B> 
    <A HREF="mailto:talk%40lists.nyphp.org?Subject=Re:%20Re%3A%20%5Bnyphp-talk%5D%20shell_exec%20security%20pitfalls%3F&In-Reply-To=%3C469F0A23.3070203%40omnistep.com%3E"
       TITLE="[nycphp-talk] shell_exec security pitfalls?">rolan at omnistep.com
       </A><BR>
    <I>Thu Jul 19 02:52:19 EDT 2007</I>
    <P><UL>
        <LI>Previous message: <A HREF="022446.html">[nycphp-talk] shell_exec security pitfalls?
</A></li>
        <LI>Next message: <A HREF="022452.html">[nycphp-talk] shell_exec security pitfalls?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#22447">[ date ]</a>
              <a href="thread.html#22447">[ thread ]</a>
              <a href="subject.html#22447">[ subject ]</a>
              <a href="author.html#22447">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Dell Sala wrote:
&gt;<i> Rolan Yang wrote:
</I>&gt;<i>
</I>&gt;&gt;<i> Whenever I need to store credit card data, I encrypt it with GPG 
</I>&gt;&gt;<i> before storing it in the database. The private key file is not to be 
</I>&gt;&gt;<i> stored on the same machine and should definitely not be accessible by 
</I>&gt;&gt;<i> the web server!
</I>&gt;<i>
</I>&gt;<i> That's always been my understanding. But it occurred to me that the 
</I>&gt;<i> private key is useless without the pass-phrase. What if the secret key 
</I>&gt;<i> is stored on the same machine as the encrypted data, but the 
</I>&gt;<i> pass-phrase isn't?
</I>&gt;<i>
</I>&gt;<i> As long as the pass-phrase is submitted along with every request that 
</I>&gt;<i> shows decrypted data, the pass-phrase never needs to be stored on the 
</I>&gt;<i> server ... unless of course the pass-phrase is somehow accessible by 
</I>&gt;<i> the use of shell_exec.
</I>&gt;<i>
</I>
The strength in public key encryption lies in the fact that the private 
key is not accessible by the &quot;evil&quot; third party. The passphrase is a 
secondary level of defense which protects in the event that the private 
key file is stolen. I don't have numbers off the top of my head, but 
it's far easier to brute force crack the passphrase than to crack a 
message encrypted with the private key.

&gt;<i> Dan Cech wrote:
</I>&gt;<i>
</I>&gt;&gt;<i> A much better approach is to use the proc_open function to execute the
</I>&gt;&gt;<i> process and allow you to provide the passphrase directly to the gpg
</I>&gt;&gt;<i> process on stdin and read the decrypted data from stdout.  This way the
</I>&gt;&gt;<i> passphrase &amp; cleartext are much less vulnerable to simple sniffing by
</I>&gt;&gt;<i> other users of the machine.
</I>&gt;<i>
</I>&gt;<i> This sounds like a good suggestion. It seems to solve the shell_exec 
</I>&gt;<i> problem.
</I>&gt;<i>
</I>&gt;<i> I'd just love to create a simple solution for storing sensitive data 
</I>&gt;<i> without requiring a special decryption setup on the client side. What 
</I>&gt;<i> do you think? Am I playing with fire?
</I>&gt;<i>
</I>To avoid storing or transmitting the private key, you might want to 
consider using... gasp!.. javascript to decrypt the payload on the 
client side. There are probably some javascript gpg examples floating 
around on the net. I remember a company called hushmail which used 
something similar to implement encrypted webmail. Trusting the browser 
for security is a slippery slope though. If you don't control the 
content, a cross site scripting hack could easily steal the private key 
from your cookies or right out of memory. But that is another can of worms..

~Rolan


I believe hushmail used to (and may still do) use an scheme where an 
encrypted message is sent

</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="022446.html">[nycphp-talk] shell_exec security pitfalls?
</A></li>
	<LI>Next message: <A HREF="022452.html">[nycphp-talk] shell_exec security pitfalls?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#22447">[ date ]</a>
              <a href="thread.html#22447">[ thread ]</a>
              <a href="subject.html#22447">[ subject ]</a>
              <a href="author.html#22447">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.nyphp.org/mailman/listinfo/talk">More information about the talk
mailing list</a><br>
</body></html>
