<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-51353372-3"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-51353372-3');
</script>
   <TITLE> [nycphp-talk] MSSQL, PDO &amp; Unicode
   </TITLE>
   <LINK REL="Index" HREF="http://nyphp.org/pipermail/talk/2008-June/index.html" >
   <LINK REL="made" HREF="mailto:talk%40lists.nyphp.org?Subject=Re:%20Re%3A%20%5Bnyphp-talk%5D%20MSSQL%2C%20PDO%20%26%20Unicode&In-Reply-To=%3C5458db3c0806040922w472b5497h924eb122016b5fd7%40mail.gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="025920.html">
   <LINK REL="Next"  HREF="025925.html">
 <meta name="description" content="PHP jobs stackware web application support and development forums for Mongo LAMP MySQL SQL Windows IIS Linux." />
<meta name="author" content="Stackware Web Development - http://stackware.com" />
<meta name="verify-v1" content="zWMoPwMn/dolscLkjLXTpRqgr9K8bzlzL1vM9WTjpHc=" />
<meta name="msvalidate.01" content="F85F81C1D0BAB5C349E8395628845E27" />
<meta name="y_key" content="265502be3db4fb6e" />
</HEAD>
         <BODY BGCOLOR="#ffffff">
<h1 style="float: right; margin: 0; padding: 0 0 0 15px;"><a href="https://www.meetup.com/new-york-php/">NYCPHP Meetup</a></h1><h1><a href="http://www.nyphp.org">NYPHP.org</a></h1>
   <H1>[nycphp-talk] MSSQL, PDO &amp; Unicode</H1>
    <B>Justin Dearing</B> 
    <A HREF="mailto:talk%40lists.nyphp.org?Subject=Re:%20Re%3A%20%5Bnyphp-talk%5D%20MSSQL%2C%20PDO%20%26%20Unicode&In-Reply-To=%3C5458db3c0806040922w472b5497h924eb122016b5fd7%40mail.gmail.com%3E"
       TITLE="[nycphp-talk] MSSQL, PDO &amp; Unicode">zippy1981 at gmail.com
       </A><BR>
    <I>Wed Jun  4 12:22:17 EDT 2008</I>
    <P><UL>
        <LI>Previous message: <A HREF="025920.html">[nycphp-talk] MSSQL, PDO &amp; Unicode
</A></li>
        <LI>Next message: <A HREF="025925.html">[nycphp-talk] MSSQL, PDO &amp; Unicode
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#25921">[ date ]</a>
              <a href="thread.html#25921">[ thread ]</a>
              <a href="subject.html#25921">[ subject ]</a>
              <a href="author.html#25921">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Ben,

Your problems will magically go away if you use php on windows. The
freetds driver that linux uses and I assume your linux odbc driver
either uses or stole code from has issues with certain things like
varchar above 255. Check the freeTDS website for details. The
microsoft odbc driver just works, and it works great.

Also, two columns will increase rowsize. since were talking large
strings and not ints, guids or the like this will be a big issue.


On Wed, Jun 4, 2008 at 11:42 AM, Ben Sgro &lt;<A HREF="http://lists.nyphp.org/mailman/listinfo/talk">ben at projectskyline.com</A>&gt; wrote:
&gt;<i> Hello All,
</I>&gt;<i>
</I>&gt;<i> So, here's the issue I'm stuck against:
</I>&gt;<i>
</I>&gt;<i> We are currently developing on Linux and then deploying to Test, Staging and
</I>&gt;<i> Production on Windows.
</I>&gt;<i>
</I>&gt;<i> We are using the Zend framework, with the PDO driver. (config.ini:
</I>&gt;<i> database.adapter = &quot;pdo_mssql&quot;).
</I>&gt;<i>
</I>&gt;<i> The original issue is that when storing XML fields the pdo driver was
</I>&gt;<i> failing to select the &quot;unicode&quot; data from MSSQL.
</I>&gt;<i> Here's the error:
</I>&gt;<i>
</I>&gt;<i> Warning: PDOStatement::execute()
</I>&gt;<i>      [function.PDOStatement-execute]: message: Unicode data in a
</I>&gt;<i> Unicode-only collation or ntext data
</I>&gt;<i>         cannot be sent to clients using DB-Library (such as ISQL) or ODBC
</I>&gt;<i> version 3.7 or earlier. (severity 16)
</I>&gt;<i>
</I>&gt;<i> To fix this, we store the XML in a MSSQL TEXT field. Well, it turns out, our
</I>&gt;<i> client doesn't like that ... they want the ability
</I>&gt;<i> to xpath the data.
</I>&gt;<i>
</I>&gt;<i> We returned the field to 'XML' and created a 'view' in MSSQL that cast the
</I>&gt;<i> XML to TEXT. So, now my application selects from the Views,
</I>&gt;<i> which works great. However, since the field is now computed (via the cast) I
</I>&gt;<i> am unable to INSERT/UPDATE into it.
</I>&gt;<i>
</I>&gt;<i> I thought, well maybe I can have the selects (fetchAll(), fetchRow()) access
</I>&gt;<i> the VIEW and the Updates/Inserts (insert(), update()) access the base table
</I>&gt;<i> (w/the XML field).
</I>&gt;<i> So, I could provide my own implementation to the Zend DB Table Abstract
</I>&gt;<i> insert() and update() methods. Instead of having, say protected $_name =
</I>&gt;<i> 'whatever', my models could have another variable named $_viewName =
</I>&gt;<i> 'viewWhatever';
</I>&gt;<i>
</I>&gt;<i> However, after looking into that, it doesn't seem too simple. Those methods
</I>&gt;<i> actually pass in a db object, not a table name (like fetchAll() and
</I>&gt;<i> fetchRow()). So programmaticaly, it appears easier to override the
</I>&gt;<i> implementation of fetchAll() and fetchRow().
</I>&gt;<i>
</I>&gt;<i> Lets pretend we can't do that. Another option would be to use Stored
</I>&gt;<i> Procedures. But since my application is already written with ORM/Zend DB
</I>&gt;<i> Table Abstract...that would be a real PITA.
</I>&gt;<i>
</I>&gt;<i> Our client also won't let us provide THEM a view...so keep the fields as
</I>&gt;<i> TEXT for our application and have a VIEW that cast from TEXT to XML (not
</I>&gt;<i> sure if you can even do this) so then they can XPATH to their hearts
</I>&gt;<i> content.
</I>&gt;<i>
</I>&gt;<i> So, I decided that there must be an better driver to use ...  is there?
</I>&gt;<i>
</I>&gt;<i> Does anyone have a solution ?
</I>&gt;<i>
</I>&gt;<i> One of my coworkers just suggested having two fields, TEXT and XML, and
</I>&gt;<i> using a SQLSERVER trigger to keep them up to date.
</I>&gt;<i>
</I>&gt;<i> ..Thanks ya'll!!!!!
</I>&gt;<i>
</I>&gt;<i> - Ben
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> _______________________________________________
</I>&gt;<i> New York PHP Community Talk Mailing List
</I>&gt;<i> <A HREF="http://lists.nyphp.org/mailman/listinfo/talk">http://lists.nyphp.org/mailman/listinfo/talk</A>
</I>&gt;<i>
</I>&gt;<i> NYPHPCon 2006 Presentations Online
</I>&gt;<i> <A HREF="http://www.nyphpcon.com">http://www.nyphpcon.com</A>
</I>&gt;<i>
</I>&gt;<i> Show Your Participation in New York PHP
</I>&gt;<i> <A HREF="http://www.nyphp.org/show_participation.php">http://www.nyphp.org/show_participation.php</A>
</I>&gt;<i>
</I>
</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="025920.html">[nycphp-talk] MSSQL, PDO &amp; Unicode
</A></li>
	<LI>Next message: <A HREF="025925.html">[nycphp-talk] MSSQL, PDO &amp; Unicode
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#25921">[ date ]</a>
              <a href="thread.html#25921">[ thread ]</a>
              <a href="subject.html#25921">[ subject ]</a>
              <a href="author.html#25921">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.nyphp.org/mailman/listinfo/talk">More information about the talk
mailing list</a><br>
</body></html>
