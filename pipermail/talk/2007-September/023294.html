<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-51353372-3"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-51353372-3');
</script>
   <TITLE> [nycphp-talk] Re: talk Digest, Vol 11, Issue 18
   </TITLE>
   <LINK REL="Index" HREF="http://nyphp.org/pipermail/talk/2007-September/index.html" >
   <LINK REL="made" HREF="mailto:talk%40lists.nyphp.org?Subject=Re:%20Re%3A%20%5Bnyphp-talk%5D%20Re%3A%20talk%20Digest%2C%20Vol%2011%2C%20Issue%2018&In-Reply-To=%3CC308DBFC.A14F8%25hart%40saturn.med.nyu.edu%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="023297.html">
   <LINK REL="Next"  HREF="023296.html">
 <meta name="description" content="PHP jobs stackware web application support and development forums for Mongo LAMP MySQL SQL Windows IIS Linux." />
<meta name="author" content="Stackware Web Development - http://stackware.com" />
<meta name="verify-v1" content="zWMoPwMn/dolscLkjLXTpRqgr9K8bzlzL1vM9WTjpHc=" />
<meta name="msvalidate.01" content="F85F81C1D0BAB5C349E8395628845E27" />
<meta name="y_key" content="265502be3db4fb6e" />
</HEAD>
         <BODY BGCOLOR="#ffffff">
<h1 style="float: right; margin: 0; padding: 0 0 0 15px;"><a href="https://www.meetup.com/new-york-php/">NYCPHP Meetup</a></h1><h1><a href="http://www.nyphp.org">NYPHP.org</a></h1>
   <H1>[nycphp-talk] Re: talk Digest, Vol 11, Issue 18</H1>
    <B>Joshua Hart</B> 
    <A HREF="mailto:talk%40lists.nyphp.org?Subject=Re:%20Re%3A%20%5Bnyphp-talk%5D%20Re%3A%20talk%20Digest%2C%20Vol%2011%2C%20Issue%2018&In-Reply-To=%3CC308DBFC.A14F8%25hart%40saturn.med.nyu.edu%3E"
       TITLE="[nycphp-talk] Re: talk Digest, Vol 11, Issue 18">hart at saturn.med.nyu.edu
       </A><BR>
    <I>Sat Sep  8 23:08:44 EDT 2007</I>
    <P><UL>
        <LI>Previous message: <A HREF="023297.html">[nycphp-talk] CouchDB (PHP)
</A></li>
        <LI>Next message: <A HREF="023296.html">[nycphp-talk] Re: talk Digest, Vol 11, Issue 18
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#23294">[ date ]</a>
              <a href="thread.html#23294">[ thread ]</a>
              <a href="subject.html#23294">[ subject ]</a>
              <a href="author.html#23294">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>


On 9/8/07 10:45 PM, &quot;<A HREF="http://lists.nyphp.org/mailman/listinfo/talk">talk-request at lists.nyphp.org</A>&quot;
&lt;<A HREF="http://lists.nyphp.org/mailman/listinfo/talk">talk-request at lists.nyphp.org</A>&gt; wrote:

&gt;<i> 
</I>&gt;&gt;<i> Oracle is instantclient ia64-10.2.0.3-20061230
</I>&gt;&gt;<i> 
</I>&gt;&gt;<i> oci8 version 1.2.3  revision 1.269.2.16.2.37
</I>&gt;&gt;<i> 
</I>&gt;&gt;<i> Here's my configure command for PHP:
</I>&gt;&gt;<i> 
</I>&gt;&gt;<i> './configure' '--with-zlib' '--with-gd' '--with-jpeg' '--with-png'
</I>&gt;&gt;<i> '--with-libxml2=/usr/bin' '--with-mysql=/usr/local/mysql5120'
</I>&gt;&gt;<i> '--with-apxs2=/usr/local/apache2/bin/apxs' '--enable-ftp'
</I>&gt;&gt;<i> '--with-imap-ssl=/usr/include/ssl'
</I>&gt;&gt;<i> '--with-imap=/space/custom_builds/imap-stuff/' '--with-openssl'
</I>&gt;&gt;<i> '--with-pam' '--with-dom' '--with-iconv' '--with-mbstring=all'
</I>&gt;&gt;<i> '--with-mbregex' '--with-domsxlt' '--with-mcrypt' '--with-xml'
</I>&gt;&gt;<i> '--with-mime-magic' '--enable-exif' '--enable-uploadprogress'
</I>&gt;&gt;<i> '--with-xmlrpc' '--with-gettext' '--with-pgsql'
</I>&gt;&gt;<i> '--with-oci8=instantclient,/usr/local/oracle'
</I>&gt;<i> 
</I>&gt;<i> Hmm... since this is ia64, there is no lib64 anywhere right?  Make sure PHP
</I>&gt;<i> is linking against the right libs.  Sometimes lib64'ness isn't always
</I>&gt;<i> obvious.  Try adding --with-libdir=lib64 to the PHP ./configure, but I'm not
</I>&gt;<i> sure on this.
</I>
Ldd on the cli for php gives:
ssaturn /usr/local# ldd /space/custom_builds/php-5.2.4/sapi/cli/php
        linux-gate.so.1 =&gt;  (0xa000000000000000)
        libcrypt.so.1 =&gt; /lib/libcrypt.so.1 (0x2000000000064000)
        libc-client.so =&gt;
/space/custom_builds/imap-stuff//lib/libc-client.so (0x20000000000b4000)
        libpq.so.5 =&gt; /usr/local/pgsql/lib/libpq.so.5 (0x2000000000288000)
        librt.so.1 =&gt; /lib/librt.so.1 (0x20000000002dc000)
        libmysqlclient.so.15 =&gt;
/usr/local/mysql5120/lib/libmysqlclient.so.15 (0x20000000002fc000)
        libmcrypt.so.4 =&gt; /usr/lib/libmcrypt.so.4 (0x2000000000528000)
        libltdl.so.3 =&gt; /usr/lib/libltdl.so.3 (0x2000000000588000)
        libdl.so.2 =&gt; /lib/libdl.so.2 (0x20000000005a8000)
        libpam.so.0 =&gt; /lib/libpam.so.0 (0x20000000005c0000)
        libpng.so.3 =&gt; /usr/lib/libpng.so.3 (0x20000000005e8000)
        libresolv.so.2 =&gt; /lib/libresolv.so.2 (0x200000000066c000)
        libm.so.6.1 =&gt; /lib/libm.so.6.1 (0x20000000006a0000)
        libnsl.so.1 =&gt; /lib/libnsl.so.1 (0x2000000000770000)
        libssl.so.0.9.8 =&gt; /usr/lib/libssl.so.0.9.8 (0x20000000007ac000)
        libcrypto.so.0.9.8 =&gt; /usr/lib/libcrypto.so.0.9.8
(0x200000000083c000)
        libclntsh.so.10.1 =&gt; /usr/local/oracle/libclntsh.so.10.1
(0x2000000000aa8000)
        libxml2.so.2 =&gt; /usr/lib/libxml2.so.2 (0x2000000002c90000)
        libc.so.6.1 =&gt; /lib/libc.so.6.1 (0x2000000002f40000)
        libimf.so.6 =&gt; /opt/intel/cc/9.1.037/lib/libimf.so.6
(0x2000000003190000)
        libirc.so =&gt; /opt/intel/cc/9.1.037/lib/libirc.so
(0x2000000003440000)
        libipr.so.6 =&gt; /usr/local/oracle/libipr.so.6 (0x2000000003470000)
        libgcc_s.so.1 =&gt; /lib/libgcc_s.so.1 (0x2000000003484000)
        libpthread.so.0 =&gt; /lib/libpthread.so.0 (0x20000000034a4000)
        /lib/ld-linux-ia64.so.2 (0x2000000000000000)
        libz.so.1 =&gt; /lib/libz.so.1 (0x20000000034dc000)
        libnnz10.so =&gt; /usr/local/oracle/libnnz10.so (0x2000000003510000)
        libunwind.so.7 =&gt; /lib/libunwind.so.7 (0x2000000003898000)




&gt;<i> Another option would be to strip down the ./configure and add --disable-all.
</I>&gt;<i> Perhaps there are some conflicts with Oracle, lib64, etc.  Then start to add
</I>&gt;<i> extensions to see if you can isolate the problem.
</I>&gt;<i> 
</I>&gt;&gt;<i> Again, I can successfully login to the oracle database, and the
</I>&gt;&gt;<i> simplest of queries works. Anything &quot;complicated&quot; crashes the program.
</I>&gt;<i> 
</I>&gt;<i> If I understand correctly - if you login via the Oracle client directly (so
</I>&gt;<i> no PHP involved), it'll still segfault when there's a complicated query?
</I>
No.. What I was trying to say is that I can login to oracle via a PHP
script.  I can even do my query if I limit the data which is returned by
oracle to less than 5 rows. As soon as I ask it to return 5 or more rows I
get a segfault.

In order to test the instantclient installatiton I installed the sqlplus
&quot;add on&quot; for instantclient and it is able to connect to oracle and return
all requested rows.

When I use gdb to run the cli for php I get:

gdb /space/custom_builds/php-5.2.4/sapi/cli/php
GNU gdb 6.4
Copyright 2005 Free Software Foundation, Inc.
GDB is free software, covered by the GNU General Public License, and you are
welcome to change it and/or distribute copies of it under certain
conditions.
Type &quot;show copying&quot; to see the conditions.
There is absolutely no warranty for GDB.  Type &quot;show warranty&quot; for details.
This GDB was configured as &quot;ia64-suse-linux&quot;...Using host libthread_db
library &quot;/lib/libthread_db.so.1&quot;.

(gdb) run /www/htdocs/nonsecure/con.html
Starting program: /space/custom_builds/php-5.2.4/sapi/cli/php
/www/htdocs/nonsecure/con.html
[Thread debugging using libthread_db enabled]
[New Thread 2305843009273028592 (LWP 27213)]

Program received signal SIGSEGV, Segmentation fault.
[Switching to Thread 2305843009273028592 (LWP 27213)]
0x40000000005f6ba0 in _zval_ptr_dtor (zval_ptr=0x607ffffffebdb7f0) at
/space/custom_builds/php-5.2.4/Zend/zend_execute_API.c:413
413             (*zval_ptr)-&gt;refcount--;
(gdb) where
#0  0x40000000005f6ba0 in _zval_ptr_dtor (zval_ptr=0x607ffffffebdb7f0) at
/space/custom_builds/php-5.2.4/Zend/zend_execute_API.c:413
#1  0x400000000068d700 in zend_do_fcall_common_helper_SPEC
(execute_data=0x607ffffffebdc370)
    at /space/custom_builds/php-5.2.4/Zend/zend_execute.h:155
#2  0x4000000000666a00 in execute (op_array=0x20000000039d4e40) at
/space/custom_builds/php-5.2.4/Zend/zend_vm_execute.h:92
#3  0x40000000006188e0 in zend_execute_scripts (type=8, retval=0x0,
file_count=3) at /space/custom_builds/php-5.2.4/Zend/zend.c:1134
#4  0x4000000000577bb0 in php_execute_script (primary_file=Cannot access
memory at address 0x10
) at /space/custom_builds/php-5.2.4/main/main.c:1982
#5  0x400000000076fa30 in main (argc=Cannot access memory at address 0x0
) at /space/custom_builds/php-5.2.4/sapi/cli/php_cli.c:1140
(gdb) 

&gt;<i>From the stacktrace above looks like something is overflowing its bounds...
</I>
I will try your suggested alternative option next and just build php with
oracle only to see if I get the same problem.

I also have started to download the full client from Oracle instead of the
instantclient to see if it makes any sort of difference.

Thanks,

Joshua



</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="023297.html">[nycphp-talk] CouchDB (PHP)
</A></li>
	<LI>Next message: <A HREF="023296.html">[nycphp-talk] Re: talk Digest, Vol 11, Issue 18
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#23294">[ date ]</a>
              <a href="thread.html#23294">[ thread ]</a>
              <a href="subject.html#23294">[ subject ]</a>
              <a href="author.html#23294">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.nyphp.org/mailman/listinfo/talk">More information about the talk
mailing list</a><br>
</body></html>
