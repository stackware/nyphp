<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-51353372-3"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-51353372-3');
</script>
   <TITLE> What Does ORM Mean? Re: [nycphp-talk] ORM vs SQL: the ultimate showdown
   </TITLE>
   <LINK REL="Index" HREF="http://nyphp.org/pipermail/talk/2007-September/index.html" >
   <LINK REL="made" HREF="mailto:talk%40lists.nyphp.org?Subject=Re:%20Re%3A%20What%20Does%20ORM%20Mean%3F%20Re%3A%20%5Bnyphp-talk%5D%20ORM%20vs%20SQL%3A%20the%20ultimate%20showdown&In-Reply-To=%3C46EC10E0.3020204%40secdat.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="023352.html">
   <LINK REL="Next"  HREF="023353.html">
 <meta name="description" content="PHP jobs stackware web application support and development forums for Mongo LAMP MySQL SQL Windows IIS Linux." />
<meta name="author" content="Stackware Web Development - http://stackware.com" />
<meta name="verify-v1" content="zWMoPwMn/dolscLkjLXTpRqgr9K8bzlzL1vM9WTjpHc=" />
<meta name="msvalidate.01" content="F85F81C1D0BAB5C349E8395628845E27" />
<meta name="y_key" content="265502be3db4fb6e" />
</HEAD>
         <BODY BGCOLOR="#ffffff">
<h1 style="float: right; margin: 0; padding: 0 0 0 15px;"><a href="https://www.meetup.com/new-york-php/">NYCPHP Meetup</a></h1><h1><a href="http://www.nyphp.org">NYPHP.org</a></h1>
   <H1>What Does ORM Mean? Re: [nycphp-talk] ORM vs SQL: the ultimate showdown</H1>
    <B>Kenneth Downs</B> 
    <A HREF="mailto:talk%40lists.nyphp.org?Subject=Re:%20Re%3A%20What%20Does%20ORM%20Mean%3F%20Re%3A%20%5Bnyphp-talk%5D%20ORM%20vs%20SQL%3A%20the%20ultimate%20showdown&In-Reply-To=%3C46EC10E0.3020204%40secdat.com%3E"
       TITLE="What Does ORM Mean? Re: [nycphp-talk] ORM vs SQL: the ultimate showdown">ken at secdat.com
       </A><BR>
    <I>Sat Sep 15 13:05:36 EDT 2007</I>
    <P><UL>
        <LI>Previous message: <A HREF="023352.html">[nycphp-talk] ORM vs SQL: the ultimate showdown
</A></li>
        <LI>Next message: <A HREF="023353.html">[nycphp-talk] ORM vs SQL: the ultimate showdown
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#23355">[ date ]</a>
              <a href="thread.html#23355">[ thread ]</a>
              <a href="subject.html#23355">[ subject ]</a>
              <a href="author.html#23355">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>ORM is normally meant to mean a comprehensive strategy for treating 
tables as objects, and to recast relational concepts in object oriented 
terms.

The examples in the past few posts just ain't ORM, there is no 
showdown.  The examples are necessary, clever, and intelligent examples 
of simple abstractions of the interface of PHP to a  SQL database.

They don't display ORM, so they can't be a showdown between ORM and SQL.

A better title might be &quot;Manual coding vs library routines.&quot;

Ben Sgro (ProjectSkyLine) wrote:
&gt;<i> Hello,
</I>&gt;<i>
</I>&gt;<i>    INSERT INTO users
</I>&gt;<i>       (first_name,last_name,organization,address1, ... 20 more fields
</I>&gt;<i> ..., birthday, favorite_color)
</I>&gt;<i>    VALUES
</I>&gt;<i>       (?,?,?,?,... 20 more question marks ...,?,?)
</I>&gt;<i> &quot;,array($first_name,$last_name,$organization,$address1,... 20 more
</I>&gt;<i> fields...,$favorite_color,$birthday);
</I>&gt;<i>
</I>&gt;<i> Why not just do:
</I>&gt;<i>
</I>&gt;<i> SET ...
</I>&gt;<i> first_name = $firstname,
</I>&gt;<i> last_name = $lastname, ...
</I>&gt;<i>
</I>&gt;<i> Which is *basically* the same as what your saying ORM is useful for in 
</I>&gt;<i> this case...
</I>&gt;<i>
</I>&gt;<i> - Ben
</I>&gt;<i>
</I>&gt;<i> ----- Original Message ----- From: &quot;Paul Houle&quot; &lt;<A HREF="http://lists.nyphp.org/mailman/listinfo/talk">paul at devonianfarm.com</A>&gt;
</I>&gt;<i> To: &quot;NYPHP Talk&quot; &lt;<A HREF="http://lists.nyphp.org/mailman/listinfo/talk">talk at lists.nyphp.org</A>&gt;
</I>&gt;<i> Sent: Saturday, September 15, 2007 12:50 PM
</I>&gt;<i> Subject: [nycphp-talk] ORM vs SQL: the ultimate showdown
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;&gt;<i>    I think of ORM as a partial solution to the problems of building 
</I>&gt;&gt;<i> database-backed web apps.  People call database applications &quot;CRUD&quot; 
</I>&gt;&gt;<i> apps, short for
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Create
</I>&gt;&gt;<i> Recall
</I>&gt;&gt;<i> Update
</I>&gt;&gt;<i> Delete
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>    ORM is good for Create,  and for many cases of Update and Delete.  
</I>&gt;&gt;<i> It can be used to do Recall,  but can be disastrously slow for 
</I>&gt;&gt;<i> generating many kinds of reports.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>    Just the other day I was working with a Java Servlet-based 
</I>&gt;&gt;<i> webapp.  I entered a text string with a single quote,  which caused 
</I>&gt;&gt;<i> an error.  The cause was code that would have looked like this in PHP:
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> $conn-&gt;Execute(&quot;INSERT INTO users (first_name,last_name,organization) 
</I>&gt;&gt;<i> VALUES ('$first_name','$last_name','$organization'&quot;);
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>    This would have been OK if they'd written something like
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> $first_name=addslashes($_POST[&quot;first_name&quot;]);
</I>&gt;&gt;<i> $last_name=addslashes($_POST[&quot;last_name&quot;]);
</I>&gt;&gt;<i> $organization=addslashes($_POST[&quot;organization&quot;]);
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>    But they didn't.  Neither do most developers.  Now,  there are 
</I>&gt;&gt;<i> tools that help with this:  for instance,  some database API's will 
</I>&gt;&gt;<i> automatically quote things if you use placeholders.  This style of 
</I>&gt;&gt;<i> doing things has it's own problems:  let's say the user table has a 
</I>&gt;&gt;<i> lot of fields...
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> $conn-&gt;Execute(&quot;
</I>&gt;&gt;<i>    INSERT INTO users
</I>&gt;&gt;<i>       (first_name,last_name,organization,address1, ... 20 more fields 
</I>&gt;&gt;<i> ..., birthday, favorite_color)
</I>&gt;&gt;<i>    VALUES
</I>&gt;&gt;<i>       (?,?,?,?,... 20 more question marks ...,?,?)
</I>&gt;&gt;<i> &quot;,array($first_name,$last_name,$organization,$address1,... 20 more 
</I>&gt;&gt;<i> fields...,$favorite_color,$birthday);
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>    Notice the error?  I didn't get the order of the fields quite 
</I>&gt;&gt;<i> right , so the 'birthday' and 'favorite color' fields will get 
</I>&gt;&gt;<i> scrambled.  Imagine how hard it would have been to have noticed the 
</I>&gt;&gt;<i> error in the middle of the field list!  I recently caught this one in 
</I>&gt;&gt;<i> a Cold Fusion application --  this kind of code gets hard to maintain.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>    Enter ORM.  Syntax varies,  but this kind of insert is simple and 
</I>&gt;&gt;<i> maintainable with an ORM system:
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> $t=$db-&gt;users;
</I>&gt;&gt;<i> $r=$t-&gt;new_record();
</I>&gt;&gt;<i> $r-&gt;first_name=$_POST[&quot;first_name&quot;];
</I>&gt;&gt;<i> $r-&gt;last_name=$_POST[&quot;last_name&quot;];
</I>&gt;&gt;<i> $r-&gt;organization=$_POST[&quot;organization&quot;];
</I>&gt;&gt;<i> ...
</I>&gt;&gt;<i> $r-&gt;insert();
</I>&gt;&gt;<i> $user_id=$r-&gt;user_id;
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>    The ORM system takes care of quotes and bad data for you.  You're 
</I>&gt;&gt;<i> not likely to introduce bugs when you add and remove fields,  and 
</I>&gt;&gt;<i> they'll be transparent if you do.  If you want to make life really 
</I>&gt;&gt;<i> easy,  you might write a subroutine that uses the ORM's introspection 
</I>&gt;&gt;<i> capability,  so you can just write
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> populate_from_post($r,$_POST);
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>    that scans through the database fields,  and automatically assigns 
</I>&gt;&gt;<i> post variables down to fields.  Talk about zero maintainance!
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> -------
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>    ORM and other SQL-phobic approaches can also get you into big 
</I>&gt;&gt;<i> trouble. I once inherited a PHP app,  using MS SQL server as the back 
</I>&gt;&gt;<i> end that had an administrative interface that listed all of the users 
</I>&gt;&gt;<i> in the system. It worked just fine in testing,  but got REALLY slow 
</I>&gt;&gt;<i> when a few hundred users joined the system...  It could take more 
</I>&gt;&gt;<i> than 100 seconds to produce the screen!
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>    The problem was that the system did between 10 and 20 queries to 
</I>&gt;&gt;<i> produce each output row.  It first did a query that retrieved a few 
</I>&gt;&gt;<i> hundred rows,  and then it did more queries to get all the details.  
</I>&gt;&gt;<i> Doing 5000 queries took a really long time.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>    We changed the application to use prepared statements and found 
</I>&gt;&gt;<i> that the query took 10 seconds.  This was acceptable,  but still 
</I>&gt;&gt;<i> pretty bad.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>    Although this system didn't use an ORM,  the general approach was 
</I>&gt;&gt;<i> that encouraged by most ORM systems -- I don't think any ORM system 
</I>&gt;&gt;<i> would have been smart enough to consolidate the multiple queries into 
</I>&gt;&gt;<i> a smaller number,  because the individual-row queries were 
</I>&gt;&gt;<i> implementing quite complicated business rules that involved counting 
</I>&gt;&gt;<i> rows with certain attributes,  preparing thresholds,  etc.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>    An ORM system might or might not be smart enough to generate 
</I>&gt;&gt;<i> prepared statements.  The difference between a 'smart' and 'dumb' ORM 
</I>&gt;&gt;<i> would be a factor of 10 in performance in this case.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>    Later on I wrote a 'pure SQL' query that calculated everything in 
</I>&gt;&gt;<i> one complex query.  It used a number of subselects...  I thought it 
</I>&gt;&gt;<i> was pretty straightforward,  but many people aren't comfortable with 
</I>&gt;&gt;<i> queries that are this complex.  It did the job in 0.1 seconds!!  
</I>&gt;&gt;<i> That's a factor of 100x better than I got from running separate 
</I>&gt;&gt;<i> statements.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> -----------------------
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>    Similar issues turn up with UPDATEs and DELETEs.  ORM is quite 
</I>&gt;&gt;<i> efficient if you only want to update one or two records at a time,  
</I>&gt;&gt;<i> but imagine you want to update 100,000 rows.  (Turning off service 
</I>&gt;&gt;<i> for people who didn't pay their bills,  reset scores in an online 
</I>&gt;&gt;<i> game to zero, ...) It can be thousands of times faster to do 
</I>&gt;&gt;<i> something like:
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> UPDATE user SET score=0;
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> than to write some loop that runs hundreds of thousands of queries.  
</I>&gt;&gt;<i> Once you add in the issues of concurrency and transactions,  the 
</I>&gt;&gt;<i> 'pure SQL' solution looks a lot better -- it's automatically 
</I>&gt;&gt;<i> protected by the transactional integrity of the database.  Probably 
</I>&gt;&gt;<i> 80% of people working with an ORM system will forget to put the whole 
</I>&gt;&gt;<i> thing in a transaction: so it won't be reliable.  The 20% of the 
</I>&gt;&gt;<i> people who do put it in a transaction will hold locks on the database 
</I>&gt;&gt;<i> for hundreds or thousands of times longer than they need to...  Which 
</I>&gt;&gt;<i> slows down the site for everybody else.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> --------------------------
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>    The gold standard is use an ORM system that's tightly integrated 
</I>&gt;&gt;<i> with your framework when it's appropriate:  when you're manipulating 
</I>&gt;&gt;<i> a few rows at a time.  You'll get big gains in maintainability.  When 
</I>&gt;&gt;<i> you're updating 1000+ rows or generating complex reports,  you need 
</I>&gt;&gt;<i> different tools.  I've built a few systems that integrate data grid 
</I>&gt;&gt;<i> display on the client with a prebuilt set of data fields that can be 
</I>&gt;&gt;<i> incorporated into the query, using subselects to 'join' data from 
</I>&gt;&gt;<i> other tables -- this gets the silver...  The gold medal would go to a 
</I>&gt;&gt;<i> system that uses the database metadata from an ORM system to help you 
</I>&gt;&gt;<i> build queries.  Hook this up to an AJAX data grid,  say the one from 
</I>&gt;&gt;<i> ext,  and you've got a rails killer...
</I>&gt;&gt;<i> _______________________________________________
</I>&gt;&gt;<i> New York PHP Community Talk Mailing List
</I>&gt;&gt;<i> <A HREF="http://lists.nyphp.org/mailman/listinfo/talk">http://lists.nyphp.org/mailman/listinfo/talk</A>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> NYPHPCon 2006 Presentations Online
</I>&gt;&gt;<i> <A HREF="http://www.nyphpcon.com">http://www.nyphpcon.com</A>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Show Your Participation in New York PHP
</I>&gt;&gt;<i> <A HREF="http://www.nyphp.org/show_participation.php">http://www.nyphp.org/show_participation.php</A> 
</I>&gt;<i>
</I>&gt;<i> _______________________________________________
</I>&gt;<i> New York PHP Community Talk Mailing List
</I>&gt;<i> <A HREF="http://lists.nyphp.org/mailman/listinfo/talk">http://lists.nyphp.org/mailman/listinfo/talk</A>
</I>&gt;<i>
</I>&gt;<i> NYPHPCon 2006 Presentations Online
</I>&gt;<i> <A HREF="http://www.nyphpcon.com">http://www.nyphpcon.com</A>
</I>&gt;<i>
</I>&gt;<i> Show Your Participation in New York PHP
</I>&gt;<i> <A HREF="http://www.nyphp.org/show_participation.php">http://www.nyphp.org/show_participation.php</A>
</I>

-- 
Kenneth Downs
Secure Data Software, Inc.
www.secdat.com    www.andromeda-project.org
631-689-7200   Fax: 631-689-0527
cell: 631-379-0010


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="023352.html">[nycphp-talk] ORM vs SQL: the ultimate showdown
</A></li>
	<LI>Next message: <A HREF="023353.html">[nycphp-talk] ORM vs SQL: the ultimate showdown
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#23355">[ date ]</a>
              <a href="thread.html#23355">[ thread ]</a>
              <a href="subject.html#23355">[ subject ]</a>
              <a href="author.html#23355">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.nyphp.org/mailman/listinfo/talk">More information about the talk
mailing list</a><br>
</body></html>
