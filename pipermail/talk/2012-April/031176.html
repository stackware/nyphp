<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-51353372-3"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-51353372-3');
</script>
   <TITLE> [nycphp-talk] I've been hit with an	eval(base64_decode(&quot;....&quot;))	injection attack
   </TITLE>
   <LINK REL="Index" HREF="http://nyphp.org/pipermail/talk/2012-April/index.html" >
   <LINK REL="made" HREF="mailto:talk%40lists.nyphp.org?Subject=Re:%20Re%3A%20%5Bnyphp-talk%5D%20I%27ve%20been%20hit%20with%20an%0A%09eval%28base64_decode%28%22....%22%29%29%09injection%20attack&In-Reply-To=%3C010201cd10e7%2488338520%24989a8f60%24%40gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="031177.html">
   <LINK REL="Next"  HREF="031178.html">
 <meta name="description" content="PHP jobs stackware web application support and development forums for Mongo LAMP MySQL SQL Windows IIS Linux." />
<meta name="author" content="Stackware Web Development - http://stackware.com" />
<meta name="verify-v1" content="zWMoPwMn/dolscLkjLXTpRqgr9K8bzlzL1vM9WTjpHc=" />
<meta name="msvalidate.01" content="F85F81C1D0BAB5C349E8395628845E27" />
<meta name="y_key" content="265502be3db4fb6e" />
</HEAD>
         <BODY BGCOLOR="#ffffff">
<h1 style="float: right; margin: 0; padding: 0 0 0 15px;"><a href="https://www.meetup.com/new-york-php/">NYCPHP Meetup</a></h1><h1><a href="http://www.nyphp.org">NYPHP.org</a></h1>
   <H1>[nycphp-talk] I've been hit with an	eval(base64_decode(&quot;....&quot;))	injection attack</H1>
    <B>Sasa Rakic - Gmail</B> 
    <A HREF="mailto:talk%40lists.nyphp.org?Subject=Re:%20Re%3A%20%5Bnyphp-talk%5D%20I%27ve%20been%20hit%20with%20an%0A%09eval%28base64_decode%28%22....%22%29%29%09injection%20attack&In-Reply-To=%3C010201cd10e7%2488338520%24989a8f60%24%40gmail.com%3E"
       TITLE="[nycphp-talk] I've been hit with an	eval(base64_decode(&quot;....&quot;))	injection attack">rakics at gmail.com
       </A><BR>
    <I>Mon Apr  2 11:44:45 EDT 2012</I>
    <P><UL>
        <LI>Previous message: <A HREF="031177.html">[nycphp-talk] I've been hit with an eval(base64_decode(&quot;....&quot;))	injection attack
</A></li>
        <LI>Next message: <A HREF="031178.html">[nycphp-talk] PHP function to execute HTML tags
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#31176">[ date ]</a>
              <a href="thread.html#31176">[ thread ]</a>
              <a href="subject.html#31176">[ subject ]</a>
              <a href="author.html#31176">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi Rob,

 

There can be several solutions to stop this injection:

-          In file upload form field, on submit should be checked is
uploaded file extension is .jpg,.gif,.bmp or .png with JavaScript

-          When file is uploaded it should be checked with GD graphics
library is it image

 

                                $path_info =
pathinfo($item-&gt;getValue(&quot;photo_filename&quot;));

                                $extension = $path_info[&quot;extension&quot;];

                                $fileName = $path_info[&quot;basename&quot;];

 

<A HREF="http://php.net/manual/en/function.imagecreatefrompng.php">http://php.net/manual/en/function.imagecreatefrompng.php</A>

 

$tempImage = imagecreatefrompng(&quot;/./upload.png&quot;);

  /* See if it failed */

  If ($tempImage)

  {

 

-          File also can be checked with tool for extract meta data from
file

<A HREF="http://getid3.sourceforge.net/">http://getid3.sourceforge.net/</A>

 

-          Add .htaccess file with rules to not be able to execute files,
only read/write

Protecting Images using PHP and htaccess

<A HREF="http://michael.theirwinfamily.net/articles/csshtml/protecting-images-using-p">http://michael.theirwinfamily.net/articles/csshtml/protecting-images-using-p</A>
hp-and-htaccess

 

Best regards,

Sasa

 

From: <A HREF="http://lists.nyphp.org/mailman/listinfo/talk">talk-bounces at lists.nyphp.org</A> [mailto:<A HREF="http://lists.nyphp.org/mailman/listinfo/talk">talk-bounces at lists.nyphp.org</A>] On
Behalf Of Rob Marscher
Sent: Friday, February 24, 2012 8:09 PM
To: NYPHP Talk
Subject: Re: [nycphp-talk] I've been hit with an eval(base64_decode(&quot;....&quot;))
injection attack

 

On Feb 24, 2012, at 1:07 PM, David Mintz wrote:

Unfortunately I do not know how this happened; don't know if there is a huge
vulnerability in one of the apps up there that was exploited, or if it was
an inside job, or what.

 

Our company wordpress blog was compromised a few months ago due to a
vulnerability in the &quot;timthumb.php&quot; image resizing script in one of the
themes.
<A HREF="http://www.terranetwork.net/blog/2011/08/new-vulnerability-in-many-wordpress">http://www.terranetwork.net/blog/2011/08/new-vulnerability-in-many-wordpress</A>
-themes/

 

The hackers uploaded a couple files that trick the server by starting with a
gif signature but then have php code in them.  Those files than open a
backdoor that allows for additional scripts to be uploaded that essentially
give shell access to the compromised machine.  In our case, the rest of the
machine was locked down enough that no harm was done.

 

Anyway, that might be something to look for.  Good luck.

-Rob

-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.nyphp.org/pipermail/talk/attachments/20120402/098b585d/attachment.html">http://lists.nyphp.org/pipermail/talk/attachments/20120402/098b585d/attachment.html</A>&gt;
</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="031177.html">[nycphp-talk] I've been hit with an eval(base64_decode(&quot;....&quot;))	injection attack
</A></li>
	<LI>Next message: <A HREF="031178.html">[nycphp-talk] PHP function to execute HTML tags
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#31176">[ date ]</a>
              <a href="thread.html#31176">[ thread ]</a>
              <a href="subject.html#31176">[ subject ]</a>
              <a href="author.html#31176">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.nyphp.org/mailman/listinfo/talk">More information about the talk
mailing list</a><br>
</body></html>
