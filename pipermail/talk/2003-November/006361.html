<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-51353372-3"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-51353372-3');
</script>
   <TITLE> [nycphp-talk] apocryphal safe mode bug and SANS' alert	CAN-2003-0863
   </TITLE>
   <LINK REL="Index" HREF="http://nyphp.org/pipermail/talk/2003-November/index.html" >
   <LINK REL="made" HREF="mailto:talk%40lists.nyphp.org?Subject=Re:%20Re%3A%20%5Bnyphp-talk%5D%20apocryphal%20safe%20mode%20bug%20and%20SANS%27%20alert%0A%09CAN-2003-0863&In-Reply-To=%3C20031115213506.49265.qmail%40web14302.mail.yahoo.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="006360.html">
   <LINK REL="Next"  HREF="006362.html">
 <meta name="description" content="PHP jobs stackware web application support and development forums for Mongo LAMP MySQL SQL Windows IIS Linux." />
<meta name="author" content="Stackware Web Development - http://stackware.com" />
<meta name="verify-v1" content="zWMoPwMn/dolscLkjLXTpRqgr9K8bzlzL1vM9WTjpHc=" />
<meta name="msvalidate.01" content="F85F81C1D0BAB5C349E8395628845E27" />
<meta name="y_key" content="265502be3db4fb6e" />
</HEAD>
         <BODY BGCOLOR="#ffffff">
<h1 style="float: right; margin: 0; padding: 0 0 0 15px;"><a href="https://www.meetup.com/new-york-php/">NYCPHP Meetup</a></h1><h1><a href="http://www.nyphp.org">NYPHP.org</a></h1>
   <H1>[nycphp-talk] apocryphal safe mode bug and SANS' alert	CAN-2003-0863</H1>
    <B>Chris Shiflett</B> 
    <A HREF="mailto:talk%40lists.nyphp.org?Subject=Re:%20Re%3A%20%5Bnyphp-talk%5D%20apocryphal%20safe%20mode%20bug%20and%20SANS%27%20alert%0A%09CAN-2003-0863&In-Reply-To=%3C20031115213506.49265.qmail%40web14302.mail.yahoo.com%3E"
       TITLE="[nycphp-talk] apocryphal safe mode bug and SANS' alert	CAN-2003-0863">shiflett at php.net
       </A><BR>
    <I>Sat Nov 15 16:35:06 EST 2003</I>
    <P><UL>
        <LI>Previous message: <A HREF="006360.html">[nycphp-talk] apocryphal safe mode bug and SANS' alert	CAN-2003-0863
</A></li>
        <LI>Next message: <A HREF="006362.html">[nycphp-talk] apocryphal safe mode bug and SANS' alert	CAN-2003-0863
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#6361">[ date ]</a>
              <a href="thread.html#6361">[ thread ]</a>
              <a href="subject.html#6361">[ subject ]</a>
              <a href="author.html#6361">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>--- Tim Gales &lt;<A HREF="http://lists.nyphp.org/mailman/listinfo/talk">tgales at tgaconnect.com</A>&gt; wrote:
&gt;<i> <A HREF="http://marc.theaimsgroup.com/?l=bugtraq&amp;m=105839111204227">http://marc.theaimsgroup.com/?l=bugtraq&amp;m=105839111204227</A>
</I>
OK, I read this email. I think I misunderstood before.

This guy seems to be claiming that having safe_mode enabled but ommitting
safe_mode_include_dir in your configuration basically disables the check
when you go to include something.

He also cites some code in fopen_wrappers.c.

Well, it seems to me that he is just wrong. From the code:

PHPAPI int php_check_safe_mode_include_dir(char *path TSRMLS_DC)
{
     if (PG(safe_mode)) {
          if (PG(safe_mode_include_dir) &amp;&amp; *PG(safe_mode_include_dir)) {
               [snip]
          }
          return -1;
     }
     return 0;
}

The part I snipped out is where the checks are made, and that part is
irrelevant for this argument. As you can see, the default return (since
any previous return would end the function) for the case where safe_mode
is enabled is -1. This is a safe approach. Unless safe_mode_include_dir is
specified and the permissions checks succeed, permission is not granted.

The default return for when safe_mode is not enabled is 0, which makes
sense.

This guy's argument is that the code returns 0 when safe_mode_include_dir
is not set, which is untrue. Doing a cvs annotate on this code shows this
for that particular line:

1.141     (jflemer  01-Feb-02):     return -1;

So, that line has not changed since Feb 2002. His email is from Jul 2003.
This leads me to believe that his argument is completely invalid, even at
the time that he wrote that email.

Chris

=====
Chris Shiflett - <A HREF="http://shiflett.org/">http://shiflett.org/</A>

PHP Security Handbook
     Coming mid-2004
HTTP Developer's Handbook
     <A HREF="http://httphandbook.org/">http://httphandbook.org/</A>
RAMP Training Courses
     <A HREF="http://www.nyphp.org/ramp">http://www.nyphp.org/ramp</A>

</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="006360.html">[nycphp-talk] apocryphal safe mode bug and SANS' alert	CAN-2003-0863
</A></li>
	<LI>Next message: <A HREF="006362.html">[nycphp-talk] apocryphal safe mode bug and SANS' alert	CAN-2003-0863
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#6361">[ date ]</a>
              <a href="thread.html#6361">[ thread ]</a>
              <a href="subject.html#6361">[ subject ]</a>
              <a href="author.html#6361">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.nyphp.org/mailman/listinfo/talk">More information about the talk
mailing list</a><br>
</body></html>
