<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-51353372-3"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-51353372-3');
</script>
   <TITLE> [nycphp-talk] Creating file for download on the fly?
   </TITLE>
   <LINK REL="Index" HREF="http://nyphp.org/pipermail/talk/2002-July/index.html" >
   <LINK REL="made" HREF="mailto:talk%40lists.nyphp.org?Subject=Re:%20Re%3A%20%5Bnyphp-talk%5D%20Creating%20file%20for%20download%20on%20the%20fly%3F&In-Reply-To=%3C1027709166.11074.4.camel%40hydrogen%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="000711.html">
   <LINK REL="Next"  HREF="000713.html">
 <meta name="description" content="PHP jobs stackware web application support and development forums for Mongo LAMP MySQL SQL Windows IIS Linux." />
<meta name="author" content="Stackware Web Development - http://stackware.com" />
<meta name="verify-v1" content="zWMoPwMn/dolscLkjLXTpRqgr9K8bzlzL1vM9WTjpHc=" />
<meta name="msvalidate.01" content="F85F81C1D0BAB5C349E8395628845E27" />
<meta name="y_key" content="265502be3db4fb6e" />
</HEAD>
         <BODY BGCOLOR="#ffffff">
<h1 style="float: right; margin: 0; padding: 0 0 0 15px;"><a href="https://www.meetup.com/new-york-php/">NYCPHP Meetup</a></h1><h1><a href="http://www.nyphp.org">NYPHP.org</a></h1>
   <H1>[nycphp-talk] Creating file for download on the fly?</H1>
    <B>Jeremy Hise</B> 
    <A HREF="mailto:talk%40lists.nyphp.org?Subject=Re:%20Re%3A%20%5Bnyphp-talk%5D%20Creating%20file%20for%20download%20on%20the%20fly%3F&In-Reply-To=%3C1027709166.11074.4.camel%40hydrogen%3E"
       TITLE="[nycphp-talk] Creating file for download on the fly?">jhise at linuxforbusiness.org
       </A><BR>
    <I>Fri Jul 26 14:46:04 EDT 2002</I>
    <P><UL>
        <LI>Previous message: <A HREF="000711.html">[nycphp-talk] Creating file for download on the fly?
</A></li>
        <LI>Next message: <A HREF="000713.html">[nycphp-talk] Creating file for download on the fly?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#712">[ date ]</a>
              <a href="thread.html#712">[ thread ]</a>
              <a href="subject.html#712">[ subject ]</a>
              <a href="author.html#712">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>One thing that I have done is create an HTML table as usual, no graphics
or anything like that. But at the top of the page before you output
anything to the browser, you can do:

header(&quot;Content-Type: application/excel&quot;);

If you are on a windows machine and have excel installed and are using
IE, excel will open up and convert the thing to a basic spreadsheet.
Then the user could save this file if they want.

The only problem I've had in the past is the user trying to save the
file on the server when they have the excel open in front of them.

You may want to check that &quot;application/excel&quot; part. I may be wrong.
Could be &quot;...ms-excel&quot; or something. Shouldn't be tough to look up on
the web though.

Hope this is helpful,

hise


On Fri, 2002-07-26 at 13:22, Edgar Reyes wrote:
&gt;<i> Hello,
</I>&gt;<i> 
</I>&gt;<i> Well I don't know if you are running on Windows or on Unix server but I if
</I>&gt;<i> you are running an a windows platform,  you can change the MIME type on the
</I>&gt;<i> results page and have it come up on an excel sheet and if they want to save
</I>&gt;<i> it they can just go to file save as and save the results on their computer.
</I>&gt;<i> 
</I>&gt;<i> Hope this helps.
</I>&gt;<i> ----- Original Message -----
</I>&gt;<i> From: &quot;Freedman, Tom S.&quot; &lt;<A HREF="http://lists.nyphp.org/mailman/listinfo/talk">tfreedma at ubspw.com</A>&gt;
</I>&gt;<i> To: &quot;NYPHP Talk&quot; &lt;<A HREF="http://lists.nyphp.org/mailman/listinfo/talk">talk at nyphp.org</A>&gt;
</I>&gt;<i> Sent: Friday, July 26, 2002 10:15 AM
</I>&gt;<i> Subject: [nycphp-talk] Creating file for download on the fly?
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> &gt; Hi all, I've been a lurker for a couple months as I've been learning PHP,
</I>&gt;<i> &gt; and many of your suggestions have been really helpful.  I was hoping
</I>&gt;<i> someone
</I>&gt;<i> &gt; might have an idea on how to tackle an issue I haven't been able to find
</I>&gt;<i> any
</I>&gt;<i> &gt; info on.
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; I'm currently working on a new version of a departmental intranet website.
</I>&gt;<i> &gt; I have a database, and offer the users a search page that lets them query
</I>&gt;<i> it
</I>&gt;<i> &gt; in a variety of ways.  The new results page is not laid out in a grid, as
</I>&gt;<i> &gt; the old one was (we've added a lot of new fields, and the grid would be
</I>&gt;<i> too
</I>&gt;<i> &gt; packed).  Some users have requested the ability to download the data for
</I>&gt;<i> &gt; import into Excel (they used to just copy and paste the table in).  I've
</I>&gt;<i> &gt; figured out how to create a .csv file, and I could, theoretically, create
</I>&gt;<i> &gt; one every time someone runs a query, save it in a temp directory, and
</I>&gt;<i> &gt; include a link to it on the webpage.  We'd have to run a cleanup routine
</I>&gt;<i> &gt; every night, though, to delete all these .csv's on the server.  It seems
</I>&gt;<i> &gt; really clumsy to me.  What I'd like to do is put a link on the result page
</I>&gt;<i> &gt; that, when clicked on, builds the .csv right then and offers it to the
</I>&gt;<i> user
</I>&gt;<i> &gt; for download.  Is this feasible, or should I just go with the temp
</I>&gt;<i> directory
</I>&gt;<i> &gt; full of reports?
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; Thanks in advance,
</I>&gt;<i> &gt; Tom
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> 
</I>



</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="000711.html">[nycphp-talk] Creating file for download on the fly?
</A></li>
	<LI>Next message: <A HREF="000713.html">[nycphp-talk] Creating file for download on the fly?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#712">[ date ]</a>
              <a href="thread.html#712">[ thread ]</a>
              <a href="subject.html#712">[ subject ]</a>
              <a href="author.html#712">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.nyphp.org/mailman/listinfo/talk">More information about the talk
mailing list</a><br>
</body></html>
