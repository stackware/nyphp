<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-51353372-3"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-51353372-3');
</script>
   <TITLE> [nycphp-talk] Search of directories and files on my web server
   </TITLE>
   <LINK REL="Index" HREF="http://nyphp.org/pipermail/talk/2007-August/index.html" >
   <LINK REL="made" HREF="mailto:talk%40lists.nyphp.org?Subject=Re:%20Re%3A%20%5Bnyphp-talk%5D%20Search%20of%20directories%20and%20files%20on%20my%20web%20server&In-Reply-To=%3CE38C4247-721C-4260-8424-56A16CE0DBEF%40email.smith.edu%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="022908.html">
   <LINK REL="Next"  HREF="022882.html">
 <meta name="description" content="PHP jobs stackware web application support and development forums for Mongo LAMP MySQL SQL Windows IIS Linux." />
<meta name="author" content="Stackware Web Development - http://stackware.com" />
<meta name="verify-v1" content="zWMoPwMn/dolscLkjLXTpRqgr9K8bzlzL1vM9WTjpHc=" />
<meta name="msvalidate.01" content="F85F81C1D0BAB5C349E8395628845E27" />
<meta name="y_key" content="265502be3db4fb6e" />
</HEAD>
         <BODY BGCOLOR="#ffffff">
<h1 style="float: right; margin: 0; padding: 0 0 0 15px;"><a href="https://www.meetup.com/new-york-php/">NYCPHP Meetup</a></h1><h1><a href="http://www.nyphp.org">NYPHP.org</a></h1>
   <H1>[nycphp-talk] Search of directories and files on my web server</H1>
    <B>Aaron Fischer</B> 
    <A HREF="mailto:talk%40lists.nyphp.org?Subject=Re:%20Re%3A%20%5Bnyphp-talk%5D%20Search%20of%20directories%20and%20files%20on%20my%20web%20server&In-Reply-To=%3CE38C4247-721C-4260-8424-56A16CE0DBEF%40email.smith.edu%3E"
       TITLE="[nycphp-talk] Search of directories and files on my web server">agfische at email.smith.edu
       </A><BR>
    <I>Thu Aug 16 10:17:10 EDT 2007</I>
    <P><UL>
        <LI>Previous message: <A HREF="022908.html">[nycphp-talk] Eliminating namespace conflicts between scripts?
</A></li>
        <LI>Next message: <A HREF="022882.html">[nycphp-talk] Search of directories and files on my web server
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#22878">[ date ]</a>
              <a href="thread.html#22878">[ thread ]</a>
              <a href="subject.html#22878">[ subject ]</a>
              <a href="author.html#22878">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Greetings,

I am working on a little script that will start at a specified  
directory on my web server and then proceed to look through all files  
and sub-folders for an instance of text located in a file.  (This is  
a follow-up of sorts to a previous post of mine from a week or two ago.)

I got the code to work fine for searching through one directory.   
However, my thought was that in order to drill down through an  
undefined number of sub-folders I would need to implement a recursive  
function.  The recursive &quot;depth first&quot; search function I made is not  
working as expected and so far I haven't been able to figure out what  
or how I need to tweak it.

I'm completely squeezed for time at work so I'll continue to bang  
away at it but I thought I would post it here in the hopes that some  
of our rockets scientists can show me the error of my ways.  I'm  
guessing this will be a rather simple problem for some folks on the  
list.

So here goes.  Listed below are my algorithm and code.  I'm looking  
forward to finding out where I'm going wrong.  =)

My algorithm:
1) Set the directory that the script will start in.
2) Open that directory and read all files and folders in that directory.
3) While each item is being read, check it.  If the item is a  
directory, call the recursive search in order to drill down further.   
If the item is a file, open the file and search for the text string  
that I am trying to locate.

My code (with comments):

&lt;?php
$path='/home/usr/account';
search($path);
	
function search($path)
{
	$dir=opendir($path);
	// browse all files and folders in the current directory
	while (false !== ($item=readdir($dir))) {
		// if the item is a directory, drill down using a recursive call to  
the search function
		if (is_dir($item) &amp;&amp; $item !='.' &amp;&amp; $item!='..') {
			search($path . '/' . $item);
		}
		if (is_file($item)) {
			$file=file($item);
			$lines=count($file);
			for ($i=0; $i&lt;$lines; $i++) {
				if (strstr(($file[$i]), 'text to search for')) {
					echo 'Search string found on line ' . $i . ' in file ' . $path .  
'/' . $item . '&lt;br /&gt;';
				}
			}
		}
	}
	closedir($dir);
}
?&gt;

Cheers,

-Aaron

</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="022908.html">[nycphp-talk] Eliminating namespace conflicts between scripts?
</A></li>
	<LI>Next message: <A HREF="022882.html">[nycphp-talk] Search of directories and files on my web server
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#22878">[ date ]</a>
              <a href="thread.html#22878">[ thread ]</a>
              <a href="subject.html#22878">[ subject ]</a>
              <a href="author.html#22878">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.nyphp.org/mailman/listinfo/talk">More information about the talk
mailing list</a><br>
</body></html>
