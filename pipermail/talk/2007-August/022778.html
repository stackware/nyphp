<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-51353372-3"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-51353372-3');
</script>
   <TITLE> [nycphp-talk] Encoding text/html for mailto:
   </TITLE>
   <LINK REL="Index" HREF="http://nyphp.org/pipermail/talk/2007-August/index.html" >
   <LINK REL="made" HREF="mailto:talk%40lists.nyphp.org?Subject=Re:%20Re%3A%20%5Bnyphp-talk%5D%20Encoding%20text/html%20for%20mailto%3A&In-Reply-To=%3C46BC73BA.5060809%40phpwerx.net%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="022776.html">
   <LINK REL="Next"  HREF="022779.html">
 <meta name="description" content="PHP jobs stackware web application support and development forums for Mongo LAMP MySQL SQL Windows IIS Linux." />
<meta name="author" content="Stackware Web Development - http://stackware.com" />
<meta name="verify-v1" content="zWMoPwMn/dolscLkjLXTpRqgr9K8bzlzL1vM9WTjpHc=" />
<meta name="msvalidate.01" content="F85F81C1D0BAB5C349E8395628845E27" />
<meta name="y_key" content="265502be3db4fb6e" />
</HEAD>
         <BODY BGCOLOR="#ffffff">
<h1 style="float: right; margin: 0; padding: 0 0 0 15px;"><a href="https://www.meetup.com/new-york-php/">NYCPHP Meetup</a></h1><h1><a href="http://www.nyphp.org">NYPHP.org</a></h1>
   <H1>[nycphp-talk] Encoding text/html for mailto:</H1>
    <B>Dan Cech</B> 
    <A HREF="mailto:talk%40lists.nyphp.org?Subject=Re:%20Re%3A%20%5Bnyphp-talk%5D%20Encoding%20text/html%20for%20mailto%3A&In-Reply-To=%3C46BC73BA.5060809%40phpwerx.net%3E"
       TITLE="[nycphp-talk] Encoding text/html for mailto:">dcech at phpwerx.net
       </A><BR>
    <I>Fri Aug 10 10:18:34 EDT 2007</I>
    <P><UL>
        <LI>Previous message: <A HREF="022776.html">[nycphp-talk] Encoding text/html for mailto:
</A></li>
        <LI>Next message: <A HREF="022779.html">[nycphp-talk] Encoding text/html for mailto:
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#22778">[ date ]</a>
              <a href="thread.html#22778">[ thread ]</a>
              <a href="subject.html#22778">[ subject ]</a>
              <a href="author.html#22778">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Ben Sgro (ProjectSkyLine) wrote:
&gt;<i> Hello All, 
</I>&gt;<i> 
</I>&gt;<i> I've created a &quot;Mail this section&quot; option for a FAQ/Information Center type page I'm working on.
</I>&gt;<i> 
</I>&gt;<i> It enables visitors to email themselves the contents of a particular section. But I'm running into trouble
</I>&gt;<i> when foreign/non a-zA-Z0-9 characters are present in the code (which is being pulled from the database).
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> Heres' a code snippet:
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i>             $body .= &quot;&lt;a href=\&quot;mailto:?Subject=Information Center&amp;body=&quot;
</I>&gt;<i>                   . html_entity_decode(strip_tags(
</I>&gt;<i>                     str_replace(array(&quot;&amp;&quot;, '&quot;', &quot;\\&quot;), &quot;&quot;, $dbObject-&gt;result['body']))) . &quot;\&quot;&quot;
</I>&gt;<i>                   . &quot; class=\&quot;email\&quot;&gt;Email this section&lt;/a&gt;&quot;;
</I>&gt;<i> 
</I>&gt;<i> Let me reformat that, heh:
</I>&gt;<i> $body = &quot;&lt;a href=\&quot;mailto:?Subject=Information Center&amp;body=&quot;. $dbObject-&gt;result['body'] . &quot;\&quot;&gt;Email me&lt;/a&gt;&quot;;
</I>&gt;<i> 
</I>&gt;<i> So, what can I use on $dbObject-&gt;result['body'] to clean/strip away the text? You can see I was messing
</I>&gt;<i> with a few different options..I know &amp; will break it, as well as &quot; ... but lets just clear out everything (HTML, and all other characters EXCEPT aA-zZ 0-9 and maybe .,-
</I>&gt;<i> 
</I>&gt;<i> Any help, greatly appreaciated!
</I>
Personally, I think you're probably approaching this the wrong way.

Not only are you going to be generating huge links (which will cause all
kinds of grief), but your email will be horribly formatted and the user
still has to email it to themselves manually from their own mail
client...very confusing.

Why not have the link trigger a server-side process to send the mail?

You may need an input for the user to enter their email address, but
then you can format the mail in any way you like, using whatever
character set is appropriate for the content.

For bonus marks, attach it as a nicely formatted pdf!

As an aside, when creating any kind of url, there are 2 forms of
formatting you need to consider.

1. urlencode any query strings

2. html encode the entire url to make it html-safe

for example:

echo '&lt;a href=&quot;'. htmlspecialchars('test.php?arg1='. urlencode('val1')
.'&amp;arg2='. urlencode('value 2 with some odd characters &amp; +')) .'&quot;&gt;link&lt;/a&gt;';

I define functions h() and u() as shortcuts for htmlspecialchars and
urlencode respectively, as I use them everywhere.

If you did want to make your current approach work, you would want to do
something like:

$body = '&lt;a href=&quot;'. h('mailto:?Subject='. u('Information Center')
.'&amp;body='. u($dbObject-&gt;result['body'])) .'&quot;&gt;Email me&lt;/a&gt;';

HTH,

Dan

</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="022776.html">[nycphp-talk] Encoding text/html for mailto:
</A></li>
	<LI>Next message: <A HREF="022779.html">[nycphp-talk] Encoding text/html for mailto:
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#22778">[ date ]</a>
              <a href="thread.html#22778">[ thread ]</a>
              <a href="subject.html#22778">[ subject ]</a>
              <a href="author.html#22778">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.nyphp.org/mailman/listinfo/talk">More information about the talk
mailing list</a><br>
</body></html>
