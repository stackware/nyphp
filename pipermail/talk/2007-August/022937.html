<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-51353372-3"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-51353372-3');
</script>
   <TITLE> [nycphp-talk] MCrypt problems decrypting data
   </TITLE>
   <LINK REL="Index" HREF="http://nyphp.org/pipermail/talk/2007-August/index.html" >
   <LINK REL="made" HREF="mailto:talk%40lists.nyphp.org?Subject=Re:%20Re%3A%20%5Bnyphp-talk%5D%20MCrypt%20problems%20decrypting%20data&In-Reply-To=%3Cb76252690708180612t77798800sdcb78ff0c016dd06%40mail.gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="022933.html">
   <LINK REL="Next"  HREF="022938.html">
 <meta name="description" content="PHP jobs stackware web application support and development forums for Mongo LAMP MySQL SQL Windows IIS Linux." />
<meta name="author" content="Stackware Web Development - http://stackware.com" />
<meta name="verify-v1" content="zWMoPwMn/dolscLkjLXTpRqgr9K8bzlzL1vM9WTjpHc=" />
<meta name="msvalidate.01" content="F85F81C1D0BAB5C349E8395628845E27" />
<meta name="y_key" content="265502be3db4fb6e" />
</HEAD>
         <BODY BGCOLOR="#ffffff">
<h1 style="float: right; margin: 0; padding: 0 0 0 15px;"><a href="https://www.meetup.com/new-york-php/">NYCPHP Meetup</a></h1><h1><a href="http://www.nyphp.org">NYPHP.org</a></h1>
   <H1>[nycphp-talk] MCrypt problems decrypting data</H1>
    <B>csnyder</B> 
    <A HREF="mailto:talk%40lists.nyphp.org?Subject=Re:%20Re%3A%20%5Bnyphp-talk%5D%20MCrypt%20problems%20decrypting%20data&In-Reply-To=%3Cb76252690708180612t77798800sdcb78ff0c016dd06%40mail.gmail.com%3E"
       TITLE="[nycphp-talk] MCrypt problems decrypting data">chsnyder at gmail.com
       </A><BR>
    <I>Sat Aug 18 09:12:37 EDT 2007</I>
    <P><UL>
        <LI>Previous message: <A HREF="022933.html">[nycphp-talk] MCrypt problems decrypting data
</A></li>
        <LI>Next message: <A HREF="022938.html">[nycphp-talk] MCrypt problems decrypting data
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#22937">[ date ]</a>
              <a href="thread.html#22937">[ thread ]</a>
              <a href="subject.html#22937">[ subject ]</a>
              <a href="author.html#22937">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On 8/17/07, Sean &lt;<A HREF="http://lists.nyphp.org/mailman/listinfo/talk">sean712 at gmail.com</A>&gt; wrote:
&gt;<i> I am having issues with encryption/decryption.
</I>&gt;<i>
</I>&gt;<i> I am attempting to encrypt an integer (61663)
</I>&gt;<i>
</I>&gt;<i> when i decrypt it I get the following appended to my decrypted value.
</I>&gt;<i>
</I>&gt;<i> 61663\357\277\275\357\277\275\357\277\275
</I>&gt;<i>
</I>&gt;<i> $td = mcrypt_module_open('blowfish', '', 'cbc, '');
</I>&gt;<i>  $iv = mcrypt_create_iv (mcrypt_enc_get_iv_size($td), MCRYPT_RAND);
</I>&gt;<i>     mcrypt_generic_init($td, $key, $iv);
</I>&gt;<i>     $decrypted_data = mdecrypt_generic($td, base64_decode($input));
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> BTW I base 64 encode the encypted integer(61663) and store it in a cookie
</I>&gt;<i>
</I>&gt;<i> Any Help would be greatly appreciated
</I>&gt;<i>
</I>&gt;<i> Thanks,
</I>&gt;<i>
</I>&gt;<i> Sean
</I>&gt;<i>
</I>

I can see two potential problems:

You need to use the same initialization vector (IV) to decrypt as you
did to encrypt. Typically, after encryption, you prepend the iv to the
ciphertext value and store the whole thing (iv+encrypted). When you're
ready to decrypt, you chop the iv off the front and use it to decrypt
the ciphertext.

Second, how are you generating the key? Is it a multiple of 32 characters long?

-- 
Chris Snyder
<A HREF="http://chxo.com/">http://chxo.com/</A>

</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="022933.html">[nycphp-talk] MCrypt problems decrypting data
</A></li>
	<LI>Next message: <A HREF="022938.html">[nycphp-talk] MCrypt problems decrypting data
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#22937">[ date ]</a>
              <a href="thread.html#22937">[ thread ]</a>
              <a href="subject.html#22937">[ subject ]</a>
              <a href="author.html#22937">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.nyphp.org/mailman/listinfo/talk">More information about the talk
mailing list</a><br>
</body></html>
