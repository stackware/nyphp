<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-51353372-3"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-51353372-3');
</script>
   <TITLE> [nycphp-talk] prevention of csrf attack
   </TITLE>
   <LINK REL="Index" HREF="http://nyphp.org/pipermail/talk/2003-December/index.html" >
   <LINK REL="made" HREF="mailto:talk%40lists.nyphp.org?Subject=Re:%20Re%3A%20%5Bnyphp-talk%5D%20prevention%20of%20csrf%20attack&In-Reply-To=%3C20031222015702.5c791d72.felix%40students.poly.edu%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="006823.html">
   <LINK REL="Next"  HREF="006867.html">
 <meta name="description" content="PHP jobs stackware web application support and development forums for Mongo LAMP MySQL SQL Windows IIS Linux." />
<meta name="author" content="Stackware Web Development - http://stackware.com" />
<meta name="verify-v1" content="zWMoPwMn/dolscLkjLXTpRqgr9K8bzlzL1vM9WTjpHc=" />
<meta name="msvalidate.01" content="F85F81C1D0BAB5C349E8395628845E27" />
<meta name="y_key" content="265502be3db4fb6e" />
</HEAD>
         <BODY BGCOLOR="#ffffff">
<h1 style="float: right; margin: 0; padding: 0 0 0 15px;"><a href="https://www.meetup.com/new-york-php/">NYCPHP Meetup</a></h1><h1><a href="http://www.nyphp.org">NYPHP.org</a></h1>
   <H1>[nycphp-talk] prevention of csrf attack</H1>
    <B>felix zaslavskiy</B> 
    <A HREF="mailto:talk%40lists.nyphp.org?Subject=Re:%20Re%3A%20%5Bnyphp-talk%5D%20prevention%20of%20csrf%20attack&In-Reply-To=%3C20031222015702.5c791d72.felix%40students.poly.edu%3E"
       TITLE="[nycphp-talk] prevention of csrf attack">felix at students.poly.edu
       </A><BR>
    <I>Mon Dec 22 01:57:02 EST 2003</I>
    <P><UL>
        <LI>Previous message: <A HREF="006823.html">[nycphp-talk] prevention of csrf attack
</A></li>
        <LI>Next message: <A HREF="006867.html">[nycphp-talk] prevention of csrf attack
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#6824">[ date ]</a>
              <a href="thread.html#6824">[ thread ]</a>
              <a href="subject.html#6824">[ subject ]</a>
              <a href="author.html#6824">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>
&gt;<i> 
</I>&gt;<i> At any rate, this particular weakness is easily resolved by making the
</I>&gt;<i> token only shared between the server and the legitimate user (rather than
</I>&gt;<i> just keeping a pool of valid tokens). By storing this value in the user's
</I>&gt;<i> session, it requires that the attacker guess that user's specific token.
</I>
That only complicates things a little because now the attacker has to retrive the secret token using the session id of the user. So the first fake request has to be to request the form page grabe the token and then resubmit second fake request with the token.

So I come to the conclusion that my method can work if its make generic and that EVERY request in the session needs to have the second token with the session id. This way the attacker would not get a change to perform the first fake request in order to grab a token at no time.  I think i am going to write an implementation of this.

</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="006823.html">[nycphp-talk] prevention of csrf attack
</A></li>
	<LI>Next message: <A HREF="006867.html">[nycphp-talk] prevention of csrf attack
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#6824">[ date ]</a>
              <a href="thread.html#6824">[ thread ]</a>
              <a href="subject.html#6824">[ subject ]</a>
              <a href="author.html#6824">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.nyphp.org/mailman/listinfo/talk">More information about the talk
mailing list</a><br>
</body></html>
