<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-51353372-3"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-51353372-3');
</script>
   <TITLE> [nycphp-talk] prevention of csrf attack
   </TITLE>
   <LINK REL="Index" HREF="http://nyphp.org/pipermail/talk/2003-December/index.html" >
   <LINK REL="made" HREF="mailto:talk%40lists.nyphp.org?Subject=Re:%20Re%3A%20%5Bnyphp-talk%5D%20prevention%20of%20csrf%20attack&In-Reply-To=%3C20031223191654.39439.qmail%40web14309.mail.yahoo.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="006824.html">
   <LINK REL="Next"  HREF="006822.html">
 <meta name="description" content="PHP jobs stackware web application support and development forums for Mongo LAMP MySQL SQL Windows IIS Linux." />
<meta name="author" content="Stackware Web Development - http://stackware.com" />
<meta name="verify-v1" content="zWMoPwMn/dolscLkjLXTpRqgr9K8bzlzL1vM9WTjpHc=" />
<meta name="msvalidate.01" content="F85F81C1D0BAB5C349E8395628845E27" />
<meta name="y_key" content="265502be3db4fb6e" />
</HEAD>
         <BODY BGCOLOR="#ffffff">
<h1 style="float: right; margin: 0; padding: 0 0 0 15px;"><a href="https://www.meetup.com/new-york-php/">NYCPHP Meetup</a></h1><h1><a href="http://www.nyphp.org">NYPHP.org</a></h1>
   <H1>[nycphp-talk] prevention of csrf attack</H1>
    <B>Chris Shiflett</B> 
    <A HREF="mailto:talk%40lists.nyphp.org?Subject=Re:%20Re%3A%20%5Bnyphp-talk%5D%20prevention%20of%20csrf%20attack&In-Reply-To=%3C20031223191654.39439.qmail%40web14309.mail.yahoo.com%3E"
       TITLE="[nycphp-talk] prevention of csrf attack">shiflett at php.net
       </A><BR>
    <I>Tue Dec 23 14:16:54 EST 2003</I>
    <P><UL>
        <LI>Previous message: <A HREF="006824.html">[nycphp-talk] prevention of csrf attack
</A></li>
        <LI>Next message: <A HREF="006822.html">[nycphp-talk] php5 classes &amp; financial aid
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#6867">[ date ]</a>
              <a href="thread.html#6867">[ thread ]</a>
              <a href="subject.html#6867">[ subject ]</a>
              <a href="author.html#6867">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>--- felix zaslavskiy &lt;<A HREF="http://lists.nyphp.org/mailman/listinfo/talk">felix at students.poly.edu</A>&gt; wrote:
&gt;<i>
</I>&gt;<i> &gt; At any rate, this particular weakness is easily resolved by making
</I>&gt;<i> &gt; the token only shared between the server and the legitimate user
</I>&gt;<i> &gt; (rather than just keeping a pool of valid tokens). By storing this
</I>&gt;<i> &gt; value in the user's session, it requires that the attacker guess
</I>&gt;<i> &gt; that user's specific token.
</I>&gt;<i> 
</I>&gt;<i> That only complicates things a little because now the attacker has to
</I>&gt;<i> retrive the secret token using the session id of the user. So the
</I>&gt;<i> first fake request has to be to request the form page grabe the token
</I>&gt;<i> and then resubmit second fake request with the token.
</I>
Well, now you're combining attacks and making a very big assumption: that
the session management mechanism is weak. If someone can impersonate the
legitimate user, a CSRF attack is not even necessary, so no intelligent
attacker is going to bother trying after that point. CSRF attacks are
generally only useful when impersonation is more difficult.

To clarify this, recall that CSRF attacks are basically a way to trick the
legitimate user into sending a request of your choosing. If you can make
the application believe that you are the legitimate user, there is no
longer any need for CSRF, because you can now do whatever you want, and
the application will mistake your identity.

I recently wrote an article about session security in PHP Magazine that
you can download for free from <A HREF="http://www.phpmag.net/ssl/phppdf/.">http://www.phpmag.net/ssl/phppdf/.</A>

Hope that helps.

Chris

=====
Chris Shiflett - <A HREF="http://shiflett.org/">http://shiflett.org/</A>

PHP Security Handbook
     Coming mid-2004
HTTP Developer's Handbook
     <A HREF="http://httphandbook.org/">http://httphandbook.org/</A>

</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="006824.html">[nycphp-talk] prevention of csrf attack
</A></li>
	<LI>Next message: <A HREF="006822.html">[nycphp-talk] php5 classes &amp; financial aid
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#6867">[ date ]</a>
              <a href="thread.html#6867">[ thread ]</a>
              <a href="subject.html#6867">[ subject ]</a>
              <a href="author.html#6867">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.nyphp.org/mailman/listinfo/talk">More information about the talk
mailing list</a><br>
</body></html>
