<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-51353372-3"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-51353372-3');
</script>
   <TITLE> [nycphp-talk] Single-Logon User Authentication,	PHP and viewing non-ASCII
   </TITLE>
   <LINK REL="Index" HREF="http://nyphp.org/pipermail/talk/2003-August/index.html" >
   <LINK REL="made" HREF="mailto:talk%40lists.nyphp.org?Subject=Re:%20Re%3A%20%5Bnyphp-talk%5D%20Single-Logon%20User%20Authentication%2C%0A%09PHP%20and%20viewing%20non-ASCII&In-Reply-To=%3CE19orNm-0007u0-0K%40rslrs1-server.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="004759.html">
   <LINK REL="Next"  HREF="004735.html">
 <meta name="description" content="PHP jobs stackware web application support and development forums for Mongo LAMP MySQL SQL Windows IIS Linux." />
<meta name="author" content="Stackware Web Development - http://stackware.com" />
<meta name="verify-v1" content="zWMoPwMn/dolscLkjLXTpRqgr9K8bzlzL1vM9WTjpHc=" />
<meta name="msvalidate.01" content="F85F81C1D0BAB5C349E8395628845E27" />
<meta name="y_key" content="265502be3db4fb6e" />
</HEAD>
         <BODY BGCOLOR="#ffffff">
<h1 style="float: right; margin: 0; padding: 0 0 0 15px;"><a href="https://www.meetup.com/new-york-php/">NYCPHP Meetup</a></h1><h1><a href="http://www.nyphp.org">NYPHP.org</a></h1>
   <H1>[nycphp-talk] Single-Logon User Authentication,	PHP and viewing non-ASCII</H1>
    <B>Brian Pang</B> 
    <A HREF="mailto:talk%40lists.nyphp.org?Subject=Re:%20Re%3A%20%5Bnyphp-talk%5D%20Single-Logon%20User%20Authentication%2C%0A%09PHP%20and%20viewing%20non-ASCII&In-Reply-To=%3CE19orNm-0007u0-0K%40rslrs1-server.com%3E"
       TITLE="[nycphp-talk] Single-Logon User Authentication,	PHP and viewing non-ASCII">bpang at bpang.com
       </A><BR>
    <I>Mon Aug 18 17:17:42 EDT 2003</I>
    <P><UL>
        <LI>Previous message: <A HREF="004759.html">[nycphp-talk] dsl line speeds today?
</A></li>
        <LI>Next message: <A HREF="004735.html">[nycphp-talk] Single-Logon User Authentication,	PHP and viewingnon-ASCII
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#4734">[ date ]</a>
              <a href="thread.html#4734">[ thread ]</a>
              <a href="subject.html#4734">[ subject ]</a>
              <a href="author.html#4734">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>try using readdir() after making the same authentication checks

note: you would probably want to have the files and directory outside of
the httpd directories so that noone would be able to access them by
directly inputting the path and filename.

and, when returning the results of readdir(), exclude the parent dir
(..) so people won't have a way to work their way up the tree, etc...
(unless you want them to)



&gt;<i> I looked up fpassthru online and how to set the headers.  Your solution
</I>&gt;<i> sounds fine for hopefully viewing a single file, but how about producing a
</I>&gt;<i> list of files for display?
</I>&gt;<i> 
</I>&gt;<i> Thanx
</I>&gt;<i> Phil
</I>&gt;<i> 
</I>&gt;<i> ----- Original Message ----- 
</I>&gt;<i> From: &quot;Brian Pang&quot; &lt;<A HREF="http://lists.nyphp.org/mailman/listinfo/talk">bpang at bpang.com</A>&gt;
</I>&gt;<i> To: &quot;NYPHP Talk&quot; &lt;<A HREF="http://lists.nyphp.org/mailman/listinfo/talk">talk at lists.nyphp.org</A>&gt;
</I>&gt;<i> Sent: Monday, August 18, 2003 3:26 PM
</I>&gt;<i> Subject: Re: [nycphp-talk] Single-Logon User Authentication,PHP and viewing
</I>&gt;<i> non-ASCII
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> &gt; I use a function which invokes fpassthru
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; first I check to make sure the user has the right priviledges, if so,
</I>&gt;<i> &gt; then pass the file thru...
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; the link to the file might end up being something like
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; fileGetter.php?filename=word.doc
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; just remember to properly set the headers
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; &gt; This is a multi-part message in MIME format.
</I>&gt;<i> &gt; &gt;
</I>&gt;<i> &gt; &gt;
</I>&gt;<i> &gt; &gt; This challenge is beyond me, as it seems to be the case.
</I>&gt;<i> &gt; &gt;
</I>&gt;<i> &gt; &gt; I am having to set up a user-authentication script that is basic
</I>&gt;<i> &gt; logon/registration process.  mySQL db captures username, password, and
</I>&gt;<i> &gt; other important fields such as their payment category and isAdmin (if
</I>&gt;<i> &gt; they are an admin on the site).  Once stored they will be able to login
</I>&gt;<i> &gt; once payment category is '4' (which means 'PAID').
</I>&gt;<i> &gt; &gt;
</I>&gt;<i> &gt; &gt; Upon being able to login, one of the features any user, admin or not,
</I>&gt;<i> &gt; can do is to view restricted files in the /web/contents folder.  They
</I>&gt;<i> &gt; can view the list or click onto a link and view the file itself
</I>&gt;<i> &gt; (assuming it's a url-friendly file like .txt or .doc or .pdf or
</I>&gt;<i> something).
</I>&gt;<i> &gt; &gt;
</I>&gt;<i> &gt; &gt; Here's where I am totally stuck.
</I>&gt;<i> &gt; &gt;
</I>&gt;<i> &gt; &gt; The /web/contents folder must be locked down so that the outside world
</I>&gt;<i> &gt; cannot view it; only authenticated users must view it.  Problem is, by
</I>&gt;<i> &gt; doing that I force a double-login since that would involve using
</I>&gt;<i> &gt; .htaccess on the folder.  (Note, I was told mySQL has a means of
</I>&gt;<i> &gt; interfacing with .htacesss, however, that too would fail because the
</I>&gt;<i> &gt; requirements for login involve username, password, isAdmin and
</I>&gt;<i> &gt; payment_category all being set to certain values).
</I>&gt;<i> &gt; &gt;
</I>&gt;<i> &gt; &gt; I thought of locking down the folder to 700 and each script uploaded
</I>&gt;<i> &gt; to 600 (using TCL CGI instead of PHP to do the actual uploading),
</I>&gt;<i> &gt; however, how would I be able to allow for users to VIEW non-ASCII files
</I>&gt;<i> &gt; (like .doc or .pdf)?
</I>&gt;<i> &gt; &gt;
</I>&gt;<i> &gt; &gt; Has anyone faced anything like that, if so, please let me know.
</I>&gt;<i> &gt; &gt;
</I>&gt;<i> &gt; &gt; Thanx
</I>&gt;<i> &gt; &gt; Phil
</I>&gt;<i> &gt; &gt;
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; _______________________________________________
</I>&gt;<i> &gt; talk mailing list
</I>&gt;<i> &gt; <A HREF="http://lists.nyphp.org/mailman/listinfo/talk">talk at lists.nyphp.org</A>
</I>&gt;<i> &gt; <A HREF="http://lists.nyphp.org/mailman/listinfo/talk">http://lists.nyphp.org/mailman/listinfo/talk</A>
</I>&gt;<i> 
</I>&gt;<i> _______________________________________________
</I>&gt;<i> talk mailing list
</I>&gt;<i> <A HREF="http://lists.nyphp.org/mailman/listinfo/talk">talk at lists.nyphp.org</A>
</I>&gt;<i> <A HREF="http://lists.nyphp.org/mailman/listinfo/talk">http://lists.nyphp.org/mailman/listinfo/talk</A>
</I>&gt;<i> 
</I>&gt;<i> 
</I>



</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="004759.html">[nycphp-talk] dsl line speeds today?
</A></li>
	<LI>Next message: <A HREF="004735.html">[nycphp-talk] Single-Logon User Authentication,	PHP and viewingnon-ASCII
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#4734">[ date ]</a>
              <a href="thread.html#4734">[ thread ]</a>
              <a href="subject.html#4734">[ subject ]</a>
              <a href="author.html#4734">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.nyphp.org/mailman/listinfo/talk">More information about the talk
mailing list</a><br>
</body></html>
