<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-51353372-3"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-51353372-3');
</script>
   <TITLE> [nycphp-talk] Google App Engine best practices links?
   </TITLE>
   <LINK REL="Index" HREF="http://nyphp.org/pipermail/talk/2013-December/index.html" >
   <LINK REL="made" HREF="mailto:talk%40lists.nyphp.org?Subject=Re:%20Re%3A%20%5Bnyphp-talk%5D%20Google%20App%20Engine%20best%20practices%20links%3F&In-Reply-To=%3C52A12916.4010906%40gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="031875.html">
   <LINK REL="Next"  HREF="031876.html">
 <meta name="description" content="PHP jobs stackware web application support and development forums for Mongo LAMP MySQL SQL Windows IIS Linux." />
<meta name="author" content="Stackware Web Development - http://stackware.com" />
<meta name="verify-v1" content="zWMoPwMn/dolscLkjLXTpRqgr9K8bzlzL1vM9WTjpHc=" />
<meta name="msvalidate.01" content="F85F81C1D0BAB5C349E8395628845E27" />
<meta name="y_key" content="265502be3db4fb6e" />
</HEAD>
         <BODY BGCOLOR="#ffffff">
<h1 style="float: right; margin: 0; padding: 0 0 0 15px;"><a href="https://www.meetup.com/new-york-php/">NYCPHP Meetup</a></h1><h1><a href="http://www.nyphp.org">NYPHP.org</a></h1>
   <H1>[nycphp-talk] Google App Engine best practices links?</H1>
    <B>Gary A. Mort</B> 
    <A HREF="mailto:talk%40lists.nyphp.org?Subject=Re:%20Re%3A%20%5Bnyphp-talk%5D%20Google%20App%20Engine%20best%20practices%20links%3F&In-Reply-To=%3C52A12916.4010906%40gmail.com%3E"
       TITLE="[nycphp-talk] Google App Engine best practices links?">garyamort at gmail.com
       </A><BR>
    <I>Thu Dec  5 20:32:06 EST 2013</I>
    <P><UL>
        <LI>Previous message: <A HREF="031875.html">[nycphp-talk] Why do unit tests not inherit?
</A></li>
        <LI>Next message: <A HREF="031876.html">[nycphp-talk] Prevalence of bcmath (new look)
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#31874">[ date ]</a>
              <a href="thread.html#31874">[ thread ]</a>
              <a href="subject.html#31874">[ subject ]</a>
              <a href="author.html#31874">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>I was wondering if there are any best practice web sites on using PHP on 
Google App Engine.

While working through installing the Joomla! CMS on GAE I've run into 
some weird oddities and initially have taken a rather brute force 
approach to work through them.

Being unhappy with the brute force method[which requires modifying core 
files in the open source code in order to accommodate GAE] I have 
continued to cycle on it in the back burner and am trying an alternate 
approach right now.

Specifically, in Joomla there are 3 main entree points to an application:
<A HREF="http://mydomain.com/index.php">http://mydomain.com/index.php</A>
<A HREF="http://mydomain.com/administrator/index.php">http://mydomain.com/administrator/index.php</A>
<A HREF="http://mydomain.com/installation/index.php">http://mydomain.com/installation/index.php</A>


So far I've run into 2 issues:
1) Joomla uses XML files in order to define html form's.  PHP is used to 
parse those files and then build the forms.  GAE disables the ability to 
load /remote/ XML files in PHP by default.  It is possible to allow this 
by add libxml_disable_entity_loader to the list of enabled functions and 
then to call libxml_disable_entity_loader(false); at some point in the 
code.  For some reason, despite the fact that these are LOCAL xml files 
Jooma attempts to read, I still need to use this fix to allow Joomla to 
read the local files.

2) Joomla defaults to saving sessions in files, GAE defaults to saving 
sessions in memcache.  Attempt to save session files using the default 
save_path does not work since the path does not exist.  Making a small 
hack to make memcache the default does not work because Joomla checks 
for the existence of the Memcache extension[via extension_loaded()] 
which does not exist in GAE.   A slightly more involved solution 
required me adding a new GaeMemcache class to override that check, and 
modifying a core class to force it to enable GaeMemcache.

None of this is bad...it's just inelegant and messy.

It strikes me that this was the wrong way to go about it.  Because of 
the way GAE is configured through app.yaml to match URI patterns to 
individual php files - instead of changing the core code, I can instead 
provide a pre-loader to process the file.

So my new file structure will be as follows:
/gae/joomla-site.php
/gae/joomla-install.php
/gae/joomla-admin.php
/gae/lib/gaememcache.php
/gae/appl.yaml
/joomla-cms : submodule git repository pointer for the Joomla-CMS repository


With this layout, I can now define my 3 entree points so that instead of 
loading the various index.php files directly, I can proxy the call first 
by the /gae/joomla* php file.  That gives me the ability to make any 
Google App Engine modifications needed[defining a special memcache 
handler for GAE, making my libxml_disable_entity_loader function call - 
etc.  No core hacks needed - now I can just setup a special 
pre-processors to handle everything.

The configuration ability of GAE is extremely fascinating..  In many 
ways it is overly cumbersome for simply usage due to the options 
available - but the options also allow for neat little workarounds[I 
also realized that instead of hacking the core file, I could have made a 
copy of the core file under my gae directory and used the upload path 
overrides to overwrite the core files only when uploaded/deployed to GAE]

What I am somewhat curious about is if there are any best practices 
tutorials out there since this sort of situation seems like it should be 
common, and the various answers are intuitive once you start groking the 
GAE deployment system.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.nyphp.org/pipermail/talk/attachments/20131205/1960d161/attachment.html">http://lists.nyphp.org/pipermail/talk/attachments/20131205/1960d161/attachment.html</A>&gt;
</PRE>



<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="031875.html">[nycphp-talk] Why do unit tests not inherit?
</A></li>
	<LI>Next message: <A HREF="031876.html">[nycphp-talk] Prevalence of bcmath (new look)
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#31874">[ date ]</a>
              <a href="thread.html#31874">[ thread ]</a>
              <a href="subject.html#31874">[ subject ]</a>
              <a href="author.html#31874">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.nyphp.org/mailman/listinfo/talk">More information about the talk
mailing list</a><br>
</body></html>
