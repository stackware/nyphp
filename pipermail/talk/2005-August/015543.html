<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-51353372-3"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-51353372-3');
</script>
   <TITLE> [nycphp-talk] Chris Shiftlett's Session Example
   </TITLE>
   <LINK REL="Index" HREF="http://nyphp.org/pipermail/talk/2005-August/index.html" >
   <LINK REL="made" HREF="mailto:talk%40lists.nyphp.org?Subject=Re:%20Re%3A%20%5Bnyphp-talk%5D%20Chris%20Shiftlett%27s%20Session%20Example&In-Reply-To=%3C42F52843.3020804%40php.net%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="015478.html">
   <LINK REL="Next"  HREF="015477.html">
 <meta name="description" content="PHP jobs stackware web application support and development forums for Mongo LAMP MySQL SQL Windows IIS Linux." />
<meta name="author" content="Stackware Web Development - http://stackware.com" />
<meta name="verify-v1" content="zWMoPwMn/dolscLkjLXTpRqgr9K8bzlzL1vM9WTjpHc=" />
<meta name="msvalidate.01" content="F85F81C1D0BAB5C349E8395628845E27" />
<meta name="y_key" content="265502be3db4fb6e" />
</HEAD>
         <BODY BGCOLOR="#ffffff">
<h1 style="float: right; margin: 0; padding: 0 0 0 15px;"><a href="https://www.meetup.com/new-york-php/">NYCPHP Meetup</a></h1><h1><a href="http://www.nyphp.org">NYPHP.org</a></h1>
   <H1>[nycphp-talk] Chris Shiftlett's Session Example</H1>
    <B>Chris Shiflett</B> 
    <A HREF="mailto:talk%40lists.nyphp.org?Subject=Re:%20Re%3A%20%5Bnyphp-talk%5D%20Chris%20Shiftlett%27s%20Session%20Example&In-Reply-To=%3C42F52843.3020804%40php.net%3E"
       TITLE="[nycphp-talk] Chris Shiftlett's Session Example">shiflett at php.net
       </A><BR>
    <I>Sat Aug  6 17:14:43 EDT 2005</I>
    <P><UL>
        <LI>Previous message: <A HREF="015478.html">[nycphp-talk] Chris Shiftlett's Session Example
</A></li>
        <LI>Next message: <A HREF="015477.html">[nycphp-talk] http analyzer
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#15543">[ date ]</a>
              <a href="thread.html#15543">[ thread ]</a>
              <a href="subject.html#15543">[ subject ]</a>
              <a href="author.html#15543">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Joseph Crawford wrote:
&gt;<i> # Make sure the user agent is correct
</I>&gt;<i> $ua_should_be = urldecode ( $parsed_cookie [ 'ua' ]);
</I>&gt;<i> if ( $_SERVER [ 'HTTP_USER_AGENT' ] != $ua_should_be )
</I>&gt;<i> {
</I>&gt;<i>     $identity_validated = false ;
</I>&gt;<i> }
</I>&gt;<i> 
</I>&gt;<i> does that seem redundant to anyone else?
</I>
It's not a particularly good example, since an attacker can pretty 
easily determine the format of the cookie string and spoof it.

However, it's meant to illustrate the basic idea of consistency 
checking. Inconsistencies in a client's request are reason for 
suspicion, although legitimate users may send slightly inconsistent 
requests due to HTTP proxies and weird browser behavior (IE sends a 
different Accept header when you reload a page) on occasion. So, make 
sure your &quot;punishment&quot; is mild. :-)

Hope that helps.

Chris

-- 
Chris Shiflett
Brain Bulb, The PHP Consultancy
<A HREF="http://brainbulb.com/">http://brainbulb.com/</A>

</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="015478.html">[nycphp-talk] Chris Shiftlett's Session Example
</A></li>
	<LI>Next message: <A HREF="015477.html">[nycphp-talk] http analyzer
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#15543">[ date ]</a>
              <a href="thread.html#15543">[ thread ]</a>
              <a href="subject.html#15543">[ subject ]</a>
              <a href="author.html#15543">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.nyphp.org/mailman/listinfo/talk">More information about the talk
mailing list</a><br>
</body></html>
