<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-51353372-3"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-51353372-3');
</script>
   <TITLE> [nycphp-talk] Experts help needed (Sessions)
   </TITLE>
   <LINK REL="Index" HREF="http://nyphp.org/pipermail/talk/2005-August/index.html" >
   <LINK REL="made" HREF="mailto:talk%40lists.nyphp.org?Subject=Re:%20Re%3A%20%5Bnyphp-talk%5D%20Experts%20help%20needed%20%28Sessions%29&In-Reply-To=%3C42F21AD5.4030002%40phpwerx.net%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="015482.html">
   <LINK REL="Next"  HREF="015484.html">
 <meta name="description" content="PHP jobs stackware web application support and development forums for Mongo LAMP MySQL SQL Windows IIS Linux." />
<meta name="author" content="Stackware Web Development - http://stackware.com" />
<meta name="verify-v1" content="zWMoPwMn/dolscLkjLXTpRqgr9K8bzlzL1vM9WTjpHc=" />
<meta name="msvalidate.01" content="F85F81C1D0BAB5C349E8395628845E27" />
<meta name="y_key" content="265502be3db4fb6e" />
</HEAD>
         <BODY BGCOLOR="#ffffff">
<h1 style="float: right; margin: 0; padding: 0 0 0 15px;"><a href="https://www.meetup.com/new-york-php/">NYCPHP Meetup</a></h1><h1><a href="http://www.nyphp.org">NYPHP.org</a></h1>
   <H1>[nycphp-talk] Experts help needed (Sessions)</H1>
    <B>Dan Cech</B> 
    <A HREF="mailto:talk%40lists.nyphp.org?Subject=Re:%20Re%3A%20%5Bnyphp-talk%5D%20Experts%20help%20needed%20%28Sessions%29&In-Reply-To=%3C42F21AD5.4030002%40phpwerx.net%3E"
       TITLE="[nycphp-talk] Experts help needed (Sessions)">dcech at phpwerx.net
       </A><BR>
    <I>Thu Aug  4 09:40:37 EDT 2005</I>
    <P><UL>
        <LI>Previous message: <A HREF="015482.html">[nycphp-talk] Experts help needed (Sessions)
</A></li>
        <LI>Next message: <A HREF="015484.html">[nycphp-talk] Experts help needed (Sessions)
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#15483">[ date ]</a>
              <a href="thread.html#15483">[ thread ]</a>
              <a href="subject.html#15483">[ subject ]</a>
              <a href="author.html#15483">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Joseph,

Your function would work the same way if it was:

$this-&gt;_key = $_SERVER['HTTP_USER_AGENT'];

If the attacker spoofs the client's HTTP_USER_AGENT string as well as 
the session id they will pass the test.

Thus it doesn't actually provide any real added protection against 
session hijacking, because any attacker who can get hold of the session 
id will also be able to determine and spoof the user agent string.

I wish I had a 'silver bullet' solution to the problem that I could 
recommend to you, but I don't.

Dan

Joseph Crawford wrote:
&gt;<i> guys is this a bit better way to check session validity?
</I>&gt;<i> 
</I>&gt;<i> define('SES_KEY', 
</I>&gt;<i> md5('custom_string'.$_ENV['PROCESSOR_REVISION'].$_ENV['PROCESSOR_ARCHITECTURE'].$_ENV['PROCESSOR_LEVEL'].'custon_string'));
</I>&gt;<i> 
</I>&gt;<i> $this-&gt;_key = md5($_SERVER['HTTP_USER_AGENT'].SES_KEY.$ses_id);
</I>&gt;<i> 
</I>&gt;<i> that value is created and stored in the db on session start, then in my 
</I>&gt;<i> CheckSession function i am doing this
</I>&gt;<i> 
</I>&gt;<i> if( $key !== $data['identifier'] )
</I>&gt;<i> 
</I>&gt;<i> this ends up creating an identifier similar to this
</I>&gt;<i> 
</I>&gt;<i> 733f97f78f00cd6d2f0d7955698ebac4a2aad2e4fb76d0a5862838e087a20251
</I>&gt;<i> 
</I>&gt;<i> this is based on the users agent, the initial session key, and some server 
</I>&gt;<i> stuff with some custom strings that i put in there.
</I>&gt;<i> 
</I>&gt;<i> This works just fine i just wanted to know if it would be easy for someone 
</I>&gt;<i> to hijack a session with this added security. I am also wondering if i 
</I>&gt;<i> should set a cookie, i am not yet sure that i want the user to be able to 
</I>&gt;<i> log back in after they close thier browser, i mean atleast not without going 
</I>&gt;<i> through the login form
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> ------------------------------------------------------------------------
</I>&gt;<i> 
</I>&gt;<i> _______________________________________________
</I>&gt;<i> New York PHP Talk Mailing List
</I>&gt;<i> AMP Technology
</I>&gt;<i> Supporting Apache, MySQL and PHP
</I>&gt;<i> <A HREF="http://lists.nyphp.org/mailman/listinfo/talk">http://lists.nyphp.org/mailman/listinfo/talk</A>
</I>&gt;<i> <A HREF="http://www.nyphp.org">http://www.nyphp.org</A>
</I>

</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="015482.html">[nycphp-talk] Experts help needed (Sessions)
</A></li>
	<LI>Next message: <A HREF="015484.html">[nycphp-talk] Experts help needed (Sessions)
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#15483">[ date ]</a>
              <a href="thread.html#15483">[ thread ]</a>
              <a href="subject.html#15483">[ subject ]</a>
              <a href="author.html#15483">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.nyphp.org/mailman/listinfo/talk">More information about the talk
mailing list</a><br>
</body></html>
