<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-51353372-3"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-51353372-3');
</script>
   <TITLE> [nycphp-talk] making a manual http POST using a PHP client (USPS	webservices)
   </TITLE>
   <LINK REL="Index" HREF="http://nyphp.org/pipermail/talk/2004-July/index.html" >
   <LINK REL="made" HREF="mailto:talk%40lists.nyphp.org?Subject=Re:%20Re%3A%20%5Bnyphp-talk%5D%20making%20a%20manual%20http%20POST%20using%20a%20PHP%20client%20%28USPS%0A%09webservices%29&In-Reply-To=%3CPine.LNX.4.58.0407121239540.28991%40miranda.org%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="010429.html">
   <LINK REL="Next"  HREF="010431.html">
 <meta name="description" content="PHP jobs stackware web application support and development forums for Mongo LAMP MySQL SQL Windows IIS Linux." />
<meta name="author" content="Stackware Web Development - http://stackware.com" />
<meta name="verify-v1" content="zWMoPwMn/dolscLkjLXTpRqgr9K8bzlzL1vM9WTjpHc=" />
<meta name="msvalidate.01" content="F85F81C1D0BAB5C349E8395628845E27" />
<meta name="y_key" content="265502be3db4fb6e" />
</HEAD>
         <BODY BGCOLOR="#ffffff">
<h1 style="float: right; margin: 0; padding: 0 0 0 15px;"><a href="https://www.meetup.com/new-york-php/">NYCPHP Meetup</a></h1><h1><a href="http://www.nyphp.org">NYPHP.org</a></h1>
   <H1>[nycphp-talk] making a manual http POST using a PHP client (USPS	webservices)</H1>
    <B>Adam Maccabee Trachtenberg</B> 
    <A HREF="mailto:talk%40lists.nyphp.org?Subject=Re:%20Re%3A%20%5Bnyphp-talk%5D%20making%20a%20manual%20http%20POST%20using%20a%20PHP%20client%20%28USPS%0A%09webservices%29&In-Reply-To=%3CPine.LNX.4.58.0407121239540.28991%40miranda.org%3E"
       TITLE="[nycphp-talk] making a manual http POST using a PHP client (USPS	webservices)">adam at trachtenberg.com
       </A><BR>
    <I>Mon Jul 12 12:48:31 EDT 2004</I>
    <P><UL>
        <LI>Previous message: <A HREF="010429.html">[nycphp-talk] making a manual http POST using a PHP client (USPS web	services)
</A></li>
        <LI>Next message: <A HREF="010431.html">[nycphp-talk] DB resultset
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#10430">[ date ]</a>
              <a href="thread.html#10430">[ thread ]</a>
              <a href="subject.html#10430">[ subject ]</a>
              <a href="author.html#10430">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On Mon, 12 Jul 2004, Hans Zaunere wrote:

&gt;<i> Pseudo code (meaning it probably won't work exactly, but it's a start);
</I>&gt;<i>
</I>&gt;<i> $fp = fsockopen('webserver.usps.com',80);
</I>&gt;<i>
</I>&gt;<i> $buffer = &quot;POST /ShippingAPI.dll\r\n&quot;
</I>&gt;<i>        .= &quot;Content-Type: application/x-www-form-urlencoded\r\n&quot;
</I>&gt;<i>        .= &quot;X-Other-Headers:  blah blah\r\n\r\n&quot;
</I>&gt;<i>        .= &quot;API=Rate&amp;XML=somethingelse\r\n&quot;;
</I>&gt;<i>
</I>&gt;<i> fwrite($fp,$buffer);
</I>
Barf.

&gt;<i> Aside from CURL, as previously mentioned, there are no native functions
</I>&gt;<i> to do this.  Then again, in Perl, there aren't either (it's CPAN).
</I>
Actually, this is false. Check out my last message about streams. You
need to use a stream context to override the default method from GET
to POST and to set the body, but it'll work.

It's just not well documented. Here's a code snippet from &quot;Upgrading
to PHP 5&quot;

&gt;<i> $post_variables = array('API' =&gt; Rate', 'XML' =&gt; 'somethingelse');
</I>&gt;<i> $content = http_build_query($post_variables);
</I>&gt;<i> $options = array(
</I>&gt;<i>     'http'=&gt;array(
</I>&gt;<i>         'method' =&gt; 'POST',
</I>&gt;<i>         'header' =&gt; &quot;Content-type: application/x-www-form-urlencoded\r\n&quot; .
</I>                      'content' =&gt; $content
&gt;<i>          )
</I>&gt;<i> );
</I>&gt;<i> $context = stream_context_create($options);
</I>&gt;<i> $index = file_get_contents('<A HREF="http://www.example.com/index.php">http://www.example.com/index.php</A>',
</I>&gt;<i>                             false, $context);
</I>
This should make a POST request for you and it's a little nicer than
having to do all that fsockopen stuff because you don't need to handle
all the details of negotiating the connection. It'll also work with
https requests if you're installed OpenSSL.

-adam

-- 
<A HREF="http://lists.nyphp.org/mailman/listinfo/talk">adam at trachtenberg.com</A>
author of o'reilly's &quot;upgrading to php 5&quot; and &quot;php cookbook&quot;
avoid the holiday rush, buy your copies today!

&gt;<i>From hans not <A HREF="http://lists.nyphp.org/mailman/listinfo/talk">junk at nyphp.com</A>  Mon Jul 12 13:54:47 2004
</I>Return-Path: &lt;hans not <A HREF="http://lists.nyphp.org/mailman/listinfo/talk">junk at nyphp.com</A>&gt;
Received: from smtp11.intermedia.net (smtp11.intermedia.net [64.78.21.10])
	by virtu.nyphp.org (Postfix) with ESMTP id D9BA8A85EA
	for &lt;<A HREF="http://lists.nyphp.org/mailman/listinfo/talk">talk at lists.nyphp.org</A>&gt;; Mon, 12 Jul 2004 13:54:46 -0400 (EDT)
Received: from ehost011-1.exch011.intermedia.net ([64.78.21.3]) by
	smtp11.intermedia.net with Microsoft SMTPSVC(6.0.3790.0); 
	Mon, 12 Jul 2004 10:46:11 -0700
X-MimeOLE: Produced By Microsoft Exchange V6.5.7226.0
Content-class: urn:content-classes:message
MIME-Version: 1.0
Content-Type: text/plain;
	charset=&quot;us-ascii&quot;
Content-Transfer-Encoding: quoted-printable
Subject: RE: [nycphp-talk] DB resultset
Date: Mon, 12 Jul 2004 10:54:42 -0700
Message-ID: &lt;<A HREF="http://lists.nyphp.org/mailman/listinfo/talk">41EE526EC2D3C74286415780D3BA9F870306C673 at ehost011-1.exch011.intermedia.net</A>&gt;
X-MS-Has-Attach: 
X-MS-TNEF-Correlator: 
Thread-Topic: [nycphp-talk] DB resultset
Thread-Index: AcRoLRfXnk3SOrGZSVSHfC0fOZ6cjQACwAEg
From: &quot;Hans Zaunere&quot; &lt;hans not <A HREF="http://lists.nyphp.org/mailman/listinfo/talk">junk at nyphp.com</A>&gt;
To: &quot;NYPHP Talk&quot; &lt;<A HREF="http://lists.nyphp.org/mailman/listinfo/talk">talk at lists.nyphp.org</A>&gt;
X-OriginalArrivalTime: 12 Jul 2004 17:46:11.0118 (UTC)
	FILETIME=[1E6DB4E0:01C46838]
X-BeenThere: <A HREF="http://lists.nyphp.org/mailman/listinfo/talk">talk at lists.nyphp.org</A>
X-Mailman-Version: 2.1.4
Precedence: list
Reply-To: NYPHP Talk &lt;<A HREF="http://lists.nyphp.org/mailman/listinfo/talk">talk at lists.nyphp.org</A>&gt;
List-Id: NYPHP Talk &lt;talk.lists.nyphp.org&gt;
List-Unsubscribe: &lt;<A HREF="http://lists.nyphp.org/mailman/listinfo/talk">http://lists.nyphp.org/mailman/listinfo/talk</A>&gt;,
	&lt;mailto:<A HREF="http://lists.nyphp.org/mailman/listinfo/talk">talk-request at lists.nyphp.org</A>?subject=unsubscribe&gt;
List-Archive: &lt;<A HREF="http://lists.nyphp.org/pipermail/talk">http://lists.nyphp.org/pipermail/talk</A>&gt;
List-Post: &lt;mailto:<A HREF="http://lists.nyphp.org/mailman/listinfo/talk">talk at lists.nyphp.org</A>&gt;
List-Help: &lt;mailto:<A HREF="http://lists.nyphp.org/mailman/listinfo/talk">talk-request at lists.nyphp.org</A>?subject=help&gt;
List-Subscribe: &lt;<A HREF="http://lists.nyphp.org/mailman/listinfo/talk">http://lists.nyphp.org/mailman/listinfo/talk</A>&gt;,
	&lt;mailto:<A HREF="http://lists.nyphp.org/mailman/listinfo/talk">talk-request at lists.nyphp.org</A>?subject=subscribe&gt;
X-List-Received-Date: Mon, 12 Jul 2004 17:54:47 -0000


&gt;<i> &gt; There lies the issue - the resultset isn't stored by
</I>&gt;<i> &gt; the database.  What
</I>&gt;<i> &gt; you really want is a cursor.  However, I assume
</I>&gt;<i> &gt; we're talking about
</I>&gt;<i> &gt; MySQL, in which case there are no cursors (they're
</I>&gt;<i> &gt; coming in MySQL 5.0).
</I>&gt;<i>=20
</I>&gt;<i> But what's wrong with using &quot;mysql_data_seek()&quot;
</I>
Nothing, but it isn't a true cursor.

A database cursor (at least in common terms) is where the result set is
stored on the server and client side API calls can operate on it
completely - generally known as scrollable cursors.  mysql_data_seek()
works on the results after they've been stored on the client side as a
result of using mysql_query().

mysql_unbuffered_query() approaches cursors, but isn't really a cursor,
and doesn't provide much of the niceness of cursors (scrolling, multiple
results, lower network usage, etc).  Thus, in the documentation, it says
mysql_data_seek(), among other functions, can't be used after an
unbuffered query (because nothing is stored on the client side
initially).

H


&gt;<i>From hans not <A HREF="http://lists.nyphp.org/mailman/listinfo/talk">junk at nyphp.com</A>  Mon Jul 12 14:09:36 2004
</I>Return-Path: &lt;hans not <A HREF="http://lists.nyphp.org/mailman/listinfo/talk">junk at nyphp.com</A>&gt;
Received: from smtp11.intermedia.net (smtp11.intermedia.net [64.78.21.10])
	by virtu.nyphp.org (Postfix) with ESMTP id 593D4A85EA
	for &lt;<A HREF="http://lists.nyphp.org/mailman/listinfo/talk">talk at lists.nyphp.org</A>&gt;; Mon, 12 Jul 2004 14:09:36 -0400 (EDT)
Received: from ehost011-1.exch011.intermedia.net ([64.78.21.3]) by
	smtp11.intermedia.net with Microsoft SMTPSVC(6.0.3790.0); 
	Mon, 12 Jul 2004 11:01:01 -0700
X-MimeOLE: Produced By Microsoft Exchange V6.5.7226.0
Content-class: urn:content-classes:message
MIME-Version: 1.0
Content-Type: text/plain;
	charset=&quot;us-ascii&quot;
Content-Transfer-Encoding: quoted-printable
Subject: RE: [nycphp-talk] making a manual http POST using a PHP client
	(USPSwebservices)
Date: Mon, 12 Jul 2004 11:09:35 -0700
Message-ID: &lt;<A HREF="http://lists.nyphp.org/mailman/listinfo/talk">41EE526EC2D3C74286415780D3BA9F870306C69C at ehost011-1.exch011.intermedia.net</A>&gt;
X-MS-Has-Attach: 
X-MS-TNEF-Correlator: 
Thread-Topic: [nycphp-talk] making a manual http POST using a PHP client
	(USPSwebservices)
Thread-Index: AcRoMBQi1I9f25R1SpiLGTAsFLJvQAACTycg
From: &quot;Hans Zaunere&quot; &lt;hans not <A HREF="http://lists.nyphp.org/mailman/listinfo/talk">junk at nyphp.com</A>&gt;
To: &quot;NYPHP Talk&quot; &lt;<A HREF="http://lists.nyphp.org/mailman/listinfo/talk">talk at lists.nyphp.org</A>&gt;
X-OriginalArrivalTime: 12 Jul 2004 18:01:01.0759 (UTC)
	FILETIME=[314ABCF0:01C4683A]
X-BeenThere: <A HREF="http://lists.nyphp.org/mailman/listinfo/talk">talk at lists.nyphp.org</A>
X-Mailman-Version: 2.1.4
Precedence: list
Reply-To: NYPHP Talk &lt;<A HREF="http://lists.nyphp.org/mailman/listinfo/talk">talk at lists.nyphp.org</A>&gt;
List-Id: NYPHP Talk &lt;talk.lists.nyphp.org&gt;
List-Unsubscribe: &lt;<A HREF="http://lists.nyphp.org/mailman/listinfo/talk">http://lists.nyphp.org/mailman/listinfo/talk</A>&gt;,
	&lt;mailto:<A HREF="http://lists.nyphp.org/mailman/listinfo/talk">talk-request at lists.nyphp.org</A>?subject=unsubscribe&gt;
List-Archive: &lt;<A HREF="http://lists.nyphp.org/pipermail/talk">http://lists.nyphp.org/pipermail/talk</A>&gt;
List-Post: &lt;mailto:<A HREF="http://lists.nyphp.org/mailman/listinfo/talk">talk at lists.nyphp.org</A>&gt;
List-Help: &lt;mailto:<A HREF="http://lists.nyphp.org/mailman/listinfo/talk">talk-request at lists.nyphp.org</A>?subject=help&gt;
List-Subscribe: &lt;<A HREF="http://lists.nyphp.org/mailman/listinfo/talk">http://lists.nyphp.org/mailman/listinfo/talk</A>&gt;,
	&lt;mailto:<A HREF="http://lists.nyphp.org/mailman/listinfo/talk">talk-request at lists.nyphp.org</A>?subject=subscribe&gt;
X-List-Received-Date: Mon, 12 Jul 2004 18:09:36 -0000


&gt;<i> &gt; Pseudo code (meaning it probably won't work exactly, but it's a
</I>start);
&gt;<i> &gt;
</I>&gt;<i> &gt; $fp =3D fsockopen('webserver.usps.com',80);
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; $buffer =3D &quot;POST /ShippingAPI.dll\r\n&quot;
</I>&gt;<i> &gt;        .=3D &quot;Content-Type: application/x-www-form-urlencoded\r\n&quot;
</I>&gt;<i> &gt;        .=3D &quot;X-Other-Headers:  blah blah\r\n\r\n&quot;
</I>&gt;<i> &gt;        .=3D &quot;API=3DRate&amp;XML=3Dsomethingelse\r\n&quot;;
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; fwrite($fp,$buffer);
</I>&gt;<i>=20
</I>&gt;<i> Barf.
</I>
I know, I know...

&gt;<i> &gt; Aside from CURL, as previously mentioned, there are no native
</I>functions
&gt;<i> &gt; to do this.  Then again, in Perl, there aren't either (it's CPAN).
</I>&gt;<i>=20
</I>&gt;<i> Actually, this is false. Check out my last message about streams. You
</I>&gt;<i> need to use a stream context to override the default method from GET
</I>&gt;<i> to POST and to set the body, but it'll work.
</I>
Depends on what version of PHP... in PHP 4, which is the version I'm
sure he's using, it's correct.

&gt;<i> It's just not well documented. Here's a code snippet from &quot;Upgrading
</I>&gt;<i> to PHP 5&quot;
</I>&gt;<i>=20
</I>&gt;<i> &gt; $post_variables =3D array('API' =3D&gt; Rate', 'XML' =3D&gt; =
</I>'somethingelse');
&gt;<i> &gt; $content =3D http_build_query($post_variables);
</I>&gt;<i> &gt; $options =3D array(
</I>&gt;<i> &gt;     'http'=3D&gt;array(
</I>&gt;<i> &gt;         'method' =3D&gt; 'POST',
</I>&gt;<i> &gt;         'header' =3D&gt; &quot;Content-type:
</I>application/x-www-form-urlencoded\r\n&quot; .
&gt;<i>                       'content' =3D&gt; $content
</I>&gt;<i> &gt;          )
</I>&gt;<i> &gt; );
</I>&gt;<i> &gt; $context =3D stream_context_create($options);
</I>&gt;<i> &gt; $index =3D file_get_contents('<A HREF="http://www.example.com/index.php">http://www.example.com/index.php</A>',
</I>&gt;<i> &gt;                             false, $context);
</I>&gt;<i>=20
</I>&gt;<i> This should make a POST request for you and it's a little nicer than
</I>&gt;<i> having to do all that fsockopen stuff because you don't need to handle
</I>&gt;<i> all the details of negotiating the connection. It'll also work with
</I>&gt;<i> https requests if you're installed OpenSSL.
</I>
Yeah, but sockets are cool.  And yes, streams are very cool, but unless
I'm writing in PHP 5, I wouldn't make extensive use of them in my code.
Especially since file_get_contents() doesn't support contexts until 5,
per the above example.

H


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="010429.html">[nycphp-talk] making a manual http POST using a PHP client (USPS web	services)
</A></li>
	<LI>Next message: <A HREF="010431.html">[nycphp-talk] DB resultset
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#10430">[ date ]</a>
              <a href="thread.html#10430">[ thread ]</a>
              <a href="subject.html#10430">[ subject ]</a>
              <a href="author.html#10430">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.nyphp.org/mailman/listinfo/talk">More information about the talk
mailing list</a><br>
</body></html>
