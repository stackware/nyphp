<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-51353372-3"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-51353372-3');
</script>
   <TITLE> [nycphp-talk] slow php
   </TITLE>
   <LINK REL="Index" HREF="http://nyphp.org/pipermail/talk/2009-February/index.html" >
   <LINK REL="made" HREF="mailto:talk%40lists.nyphp.org?Subject=Re:%20Re%3A%20%5Bnyphp-talk%5D%20slow%20php&In-Reply-To=%3C01ed01c98e1c%241a14a980%244e3dfc80%24%40com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="027478.html">
   <LINK REL="Next"  HREF="027475.html">
 <meta name="description" content="PHP jobs stackware web application support and development forums for Mongo LAMP MySQL SQL Windows IIS Linux." />
<meta name="author" content="Stackware Web Development - http://stackware.com" />
<meta name="verify-v1" content="zWMoPwMn/dolscLkjLXTpRqgr9K8bzlzL1vM9WTjpHc=" />
<meta name="msvalidate.01" content="F85F81C1D0BAB5C349E8395628845E27" />
<meta name="y_key" content="265502be3db4fb6e" />
</HEAD>
         <BODY BGCOLOR="#ffffff">
<h1 style="float: right; margin: 0; padding: 0 0 0 15px;"><a href="https://www.meetup.com/new-york-php/">NYCPHP Meetup</a></h1><h1><a href="http://www.nyphp.org">NYPHP.org</a></h1>
   <H1>[nycphp-talk] slow php</H1>
    <B>Hans Zaunere</B> 
    <A HREF="mailto:talk%40lists.nyphp.org?Subject=Re:%20Re%3A%20%5Bnyphp-talk%5D%20slow%20php&In-Reply-To=%3C01ed01c98e1c%241a14a980%244e3dfc80%24%40com%3E"
       TITLE="[nycphp-talk] slow php">lists at zaunere.com
       </A><BR>
    <I>Fri Feb 13 15:46:10 EST 2009</I>
    <P><UL>
        <LI>Previous message: <A HREF="027478.html">[nycphp-talk] slow php (slow database)
</A></li>
        <LI>Next message: <A HREF="027475.html">[nycphp-talk] slow php
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#27474">[ date ]</a>
              <a href="thread.html#27474">[ thread ]</a>
              <a href="subject.html#27474">[ subject ]</a>
              <a href="author.html#27474">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>&gt;<i> I have a php 'cron job' script which is inserting some records.  It
</I>&gt;<i> uses arrays to store 12 field records along with several nested loops
</I>&gt;<i> in which it tests various currency values from a separate 4 field table
</I>&gt;<i> and sorts them to get the lowest one for insert into a new 4 field
</I>&gt;<i> table record.  It has about 640,000 Product records per 4 Customers or
</I>&gt;<i> apporx. 2.4 million records to insert.  It takes several hours+ to
</I>&gt;<i> complete and I am hoping there is a way to speed it up.
</I>&gt;<i> 
</I>&gt;<i> So far, I've tried updating instead of inserting records and changing a
</I>&gt;<i> few functions but nothing seems to make much difference.  Am I being
</I>&gt;<i> unreasonable for the size of the files here?  I'm considering using a
</I>&gt;<i> Derived Table in mySQL and will also consider another language such as
</I>&gt;<i> python.  Please let me know if you have any suggestions.  Thanks.
</I>
Why would this be considered a result of PHP being slow?  You're doing many
millions of database queries (both INSERT and SELECT from what you
describe), which is the real culprit.

Some things to consider:

-- minimize lookup queries by caching, or loading your lookup tables into
PHP arrays, thus avoiding database queries

-- make sure that any lookup queries you do perform are against a well
indexed table - similarly, consider key buffer sizes, buffer pool sizes, and
all that good stuff

-- attempt to batch inserts (see <A HREF="http://dev.mysql.com/insert">http://dev.mysql.com/insert</A> for various
techniques)

-- look at dev.mysql.com and google for mysql bulk insert and mysql bulk
insert configuration - there are a lot of tunables pertaining to these types
of operations, including temp. turning off indexes, etc.

The only PHP specific item I'd consider at this point is to explicitly free
memory and resources to keep the memory footprint as small as possible.
PHP's garbage collection cannot always be, well, perfect, for long running
processes.

H



</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="027478.html">[nycphp-talk] slow php (slow database)
</A></li>
	<LI>Next message: <A HREF="027475.html">[nycphp-talk] slow php
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#27474">[ date ]</a>
              <a href="thread.html#27474">[ thread ]</a>
              <a href="subject.html#27474">[ subject ]</a>
              <a href="author.html#27474">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.nyphp.org/mailman/listinfo/talk">More information about the talk
mailing list</a><br>
</body></html>
