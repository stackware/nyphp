<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-51353372-3"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-51353372-3');
</script>
   <TITLE> [nycphp-talk] php script
   </TITLE>
   <LINK REL="Index" HREF="http://nyphp.org/pipermail/talk/2008-February/index.html" >
   <LINK REL="made" HREF="mailto:talk%40lists.nyphp.org?Subject=Re:%20Re%3A%20%5Bnyphp-talk%5D%20php%20script&In-Reply-To=%3Cbcb7aa500802220619g10103dq56c30e8b7a4cb23e%40mail.gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="024915.html">
   <LINK REL="Next"  HREF="024919.html">
 <meta name="description" content="PHP jobs stackware web application support and development forums for Mongo LAMP MySQL SQL Windows IIS Linux." />
<meta name="author" content="Stackware Web Development - http://stackware.com" />
<meta name="verify-v1" content="zWMoPwMn/dolscLkjLXTpRqgr9K8bzlzL1vM9WTjpHc=" />
<meta name="msvalidate.01" content="F85F81C1D0BAB5C349E8395628845E27" />
<meta name="y_key" content="265502be3db4fb6e" />
</HEAD>
         <BODY BGCOLOR="#ffffff">
<h1 style="float: right; margin: 0; padding: 0 0 0 15px;"><a href="https://www.meetup.com/new-york-php/">NYCPHP Meetup</a></h1><h1><a href="http://www.nyphp.org">NYPHP.org</a></h1>
   <H1>[nycphp-talk] php script</H1>
    <B>Guilherme Blanco</B> 
    <A HREF="mailto:talk%40lists.nyphp.org?Subject=Re:%20Re%3A%20%5Bnyphp-talk%5D%20php%20script&In-Reply-To=%3Cbcb7aa500802220619g10103dq56c30e8b7a4cb23e%40mail.gmail.com%3E"
       TITLE="[nycphp-talk] php script">guilhermeblanco at gmail.com
       </A><BR>
    <I>Fri Feb 22 09:19:54 EST 2008</I>
    <P><UL>
        <LI>Previous message: <A HREF="024915.html">[nycphp-talk] php script
</A></li>
        <LI>Next message: <A HREF="024919.html">[nycphp-talk] php script
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#24916">[ date ]</a>
              <a href="thread.html#24916">[ thread ]</a>
              <a href="subject.html#24916">[ subject ]</a>
              <a href="author.html#24916">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>HI,


Th right way to store IPs is by converting them to long using ip2long.
By doing it, you can check if it is valid (returns false on failure)
and also enable you a by region search.

There are services like geocode, ip2country, geoip, etc that gives you
a database of countries with their ip2long ranges.
All you have to do then is to get the column and search in this
country db. You are able to do joins (and use a single query) instead
of retrieve, convert, another query.

Also, I use this code to retrieve the IP address of visitor (please
notice that this may not work 100% of times, but it's better than a
single REMOTE_ADDR):


function _getIp()
{
	// This function get the IP of an user, even when he's behind a simple proxy
	// List of possible ip sources, in order of priority
	$ip_sources = array(
		&quot;HTTP_X_FORWARDED_FOR&quot;,
		&quot;HTTP_X_FORWARDED&quot;,
		&quot;HTTP_FORWARDED_FOR&quot;,
		&quot;HTTP_FORWARDED&quot;,
		&quot;HTTP_X_COMING_FROM&quot;,
		&quot;HTTP_COMING_FROM&quot;,
		&quot;REMOTE_ADDR&quot;,
	);

	foreach ( $ip_sources as $ip_source ) {
		if ( isset( $_SERVER[$ip_source] ) ) {
			$proxy_ip = $_SERVER[$ip_source];
			break;
		}
	}

	// If the ip is still not found, try the getenv() function without
	// error reporting. This will automatically provide a FALSE result
	// on failure
	$proxy_ip = ( isset( $proxy_ip ) ) ? $proxy_ip : @getenv(&quot;REMOTE_ADDR&quot;);

	// Return the IP found
	return $proxy_ip;
}



I hope my $0.02 helped you a bit.


Regards,

On Fri, Feb 22, 2008 at 11:06 AM, Allen Shaw &lt;<A HREF="http://lists.nyphp.org/mailman/listinfo/talk">ashaw at polymerdb.org</A>&gt; wrote:
&gt;<i> Radu Cirimpei wrote:
</I>&gt;<i>  &gt; If I use 'getenv(&quot;REMOTE_ADDR&quot;) ' for return the IP
</I>&gt;<i>  &gt; address of the
</I>&gt;<i>  &gt; person visiting my site, what is the best to do?
</I>&gt;<i>  Hi Radu,
</I>&gt;<i>
</I>&gt;<i>  You can give us a little more detail, right?  Tell us, what are you
</I>&gt;<i>  trying to accomplish -- that is, /why/ do you need the remote address,
</I>&gt;<i>  and what are you going to use it for?
</I>&gt;<i>
</I>&gt;<i>  - Allen
</I>&gt;<i>
</I>&gt;<i>  --
</I>&gt;<i>  Allen Shaw
</I>&gt;<i>  slidePresenter (<A HREF="http://slides.sourceforge.net">http://slides.sourceforge.net</A>)
</I>&gt;<i>
</I>&gt;<i>  _______________________________________________
</I>&gt;<i>  New York PHP Community Talk Mailing List
</I>&gt;<i>  <A HREF="http://lists.nyphp.org/mailman/listinfo/talk">http://lists.nyphp.org/mailman/listinfo/talk</A>
</I>&gt;<i>
</I>&gt;<i>  NYPHPCon 2006 Presentations Online
</I>&gt;<i>  <A HREF="http://www.nyphpcon.com">http://www.nyphpcon.com</A>
</I>&gt;<i>
</I>&gt;<i>  Show Your Participation in New York PHP
</I>&gt;<i>  <A HREF="http://www.nyphp.org/show_participation.php">http://www.nyphp.org/show_participation.php</A>
</I>&gt;<i>
</I>


-- 
Guilherme Blanco - Web Developer
CBC - Certified Bindows Consultant
Cell Phone: +55 (16) 9166-6902
MSN: <A HREF="http://lists.nyphp.org/mailman/listinfo/talk">guilhermeblanco at hotmail.com</A>
URL: <A HREF="http://blog.bisna.com">http://blog.bisna.com</A>
S&#227;o Carlos - SP/Brazil
</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="024915.html">[nycphp-talk] php script
</A></li>
	<LI>Next message: <A HREF="024919.html">[nycphp-talk] php script
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#24916">[ date ]</a>
              <a href="thread.html#24916">[ thread ]</a>
              <a href="subject.html#24916">[ subject ]</a>
              <a href="author.html#24916">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.nyphp.org/mailman/listinfo/talk">More information about the talk
mailing list</a><br>
</body></html>
