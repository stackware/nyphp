<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-51353372-3"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-51353372-3');
</script>
   <TITLE> [nycphp-talk] arg_separator
   </TITLE>
   <LINK REL="Index" HREF="http://nyphp.org/pipermail/talk/2005-December/index.html" >
   <LINK REL="made" HREF="mailto:talk%40lists.nyphp.org?Subject=Re:%20Re%3A%20%5Bnyphp-talk%5D%20arg_separator&In-Reply-To=%3C43A76035.1080804%40phpwerx.net%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="017050.html">
   <LINK REL="Next"  HREF="017054.html">
 <meta name="description" content="PHP jobs stackware web application support and development forums for Mongo LAMP MySQL SQL Windows IIS Linux." />
<meta name="author" content="Stackware Web Development - http://stackware.com" />
<meta name="verify-v1" content="zWMoPwMn/dolscLkjLXTpRqgr9K8bzlzL1vM9WTjpHc=" />
<meta name="msvalidate.01" content="F85F81C1D0BAB5C349E8395628845E27" />
<meta name="y_key" content="265502be3db4fb6e" />
</HEAD>
         <BODY BGCOLOR="#ffffff">
<h1 style="float: right; margin: 0; padding: 0 0 0 15px;"><a href="https://www.meetup.com/new-york-php/">NYCPHP Meetup</a></h1><h1><a href="http://www.nyphp.org">NYPHP.org</a></h1>
   <H1>[nycphp-talk] arg_separator</H1>
    <B>Dan Cech</B> 
    <A HREF="mailto:talk%40lists.nyphp.org?Subject=Re:%20Re%3A%20%5Bnyphp-talk%5D%20arg_separator&In-Reply-To=%3C43A76035.1080804%40phpwerx.net%3E"
       TITLE="[nycphp-talk] arg_separator">dcech at phpwerx.net
       </A><BR>
    <I>Mon Dec 19 20:36:53 EST 2005</I>
    <P><UL>
        <LI>Previous message: <A HREF="017050.html">[nycphp-talk] arg_separator
</A></li>
        <LI>Next message: <A HREF="017054.html">[nycphp-talk] arg_separator
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#17051">[ date ]</a>
              <a href="thread.html#17051">[ thread ]</a>
              <a href="subject.html#17051">[ subject ]</a>
              <a href="author.html#17051">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Ok,

1. proper url encoding

Say you have 2 items to go into the url:

$item1 = 'this &amp; that';
$item2 = '<A HREF="http://lists.nyphp.org/mailman/listinfo/talk">example at example.org</A>';

Now, in order to get them into a url string, you want to urlencode (or 
rawurlencode) the values, so it will look like:

$urlstring = 'whatever.php?item1='. urlencode($item1) .'&amp;item2='. 
urlencode($item2);

so urlstring now contains:

whatever.php?item1=this+%26+that&amp;item2=example%40example.org

or, if you used rawurlencode:

whatever.php?item1=this%20%26%20that&amp;item2=example%40example.org

This is now fine to enter into the location bar of your browser, but 
that &amp; in the middle will wreak havoc on your html.  One answer is to 
replace it with ; and change the arg_separator, but an easier solution 
is to do that same to it as you would for any other piece of data you're 
going to insert into your html page, run it through htmlentities

echo '&lt;a href=&quot;'. htmlentities($urlstring) .'&quot;&gt;a link&lt;/a&gt;';

will result in:

&lt;a 
href=&quot;whatever.php?item1=this+%26+that&amp;amp;item2=example%40example.org&quot;&gt;a 
link&lt;/a&gt;

As you can see that pesky &amp; is converted to a nice &amp;amp; and your url 
will work 100% plus help you protect against XSS attacks, regardless of 
the arg separator you're using.

Here is a handy little function to take an array and turn it into a 
query string, ready to go into a header or curl call, or through 
htmlentities and into html:

function query_string($vars)
{
     $arg_sep = ini_get('arg_separator.output');
     if (empty($arg_sep)) {
         $arg_sep = '&amp;';
     }

     foreach ($vars as $key =&gt; $val) {
         $vars[$key] = urlencode($key) .'='. urlencode($val);
     }

     return implode($arg_sep,$vars);
}

2. If you do want to set the arg_separator.input and/or .output to 
something else, use the php_value (not php_admin_value) and throw the 
directive into the .htaccess file at the root of your php scripts

Dan

michael wrote:
&gt;<i> net-www/apache-2.0.55
</I>&gt;<i> dev-lang/php-5.0.5-r1
</I>&gt;<i> 
</I>&gt;<i> I have a developemnt box running several sites.  I'm having difficulty
</I>&gt;<i> with one of them.  Some of the GET variables have legit ampersands in
</I>&gt;<i> them. I tried escaping them then rescaping them but got unexpected
</I>&gt;<i> results.  I changed all the separators in the urls to be &amp;amp;, but
</I>&gt;<i> that didn't seem to work for me either.
</I>&gt;<i> 
</I>&gt;<i> As per the PHP docs, the W3C recommends arg_separator to be &quot;;&quot; instead
</I>&gt;<i> of &quot;&amp;&quot;.  Ah, I thought, there is my answer.
</I>&gt;<i> 
</I>&gt;<i> I did some poking around and found arg_separator *should* be able to be
</I>&gt;<i> set on a per directory basis.  I didn't want to do it site wide because
</I>&gt;<i> that would entail changing every site I have on my development box AND
</I>&gt;<i> all the production servers upstream.  I just wanted to do it for this
</I>&gt;<i> one site (for now) So, I left the default in the php.ini and in the
</I>&gt;<i> apache vhost conf &lt;Directory&gt; I added 
</I>&gt;<i> 
</I>&gt;<i> php_admin_value arg_separator.input ;
</I>&gt;<i> 
</I>&gt;<i> But it does not seem to be picking that up.  I must be missing
</I>&gt;<i> something.. any ideas?
</I>&gt;<i> 
</I>&gt;<i> 
</I>

</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="017050.html">[nycphp-talk] arg_separator
</A></li>
	<LI>Next message: <A HREF="017054.html">[nycphp-talk] arg_separator
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#17051">[ date ]</a>
              <a href="thread.html#17051">[ thread ]</a>
              <a href="subject.html#17051">[ subject ]</a>
              <a href="author.html#17051">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.nyphp.org/mailman/listinfo/talk">More information about the talk
mailing list</a><br>
</body></html>
