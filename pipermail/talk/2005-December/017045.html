<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-51353372-3"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-51353372-3');
</script>
   <TITLE> [nycphp-talk] problems loading a custom, shared extension
   </TITLE>
   <LINK REL="Index" HREF="http://nyphp.org/pipermail/talk/2005-December/index.html" >
   <LINK REL="made" HREF="mailto:talk%40lists.nyphp.org?Subject=Re:%20Re%3A%20%5Bnyphp-talk%5D%20problems%20loading%20a%20custom%2C%20shared%20extension&In-Reply-To=%3C002201c60440%24b8865ff0%246501a8c0%40MZ%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="016977.html">
   <LINK REL="Next"  HREF="016953.html">
 <meta name="description" content="PHP jobs stackware web application support and development forums for Mongo LAMP MySQL SQL Windows IIS Linux." />
<meta name="author" content="Stackware Web Development - http://stackware.com" />
<meta name="verify-v1" content="zWMoPwMn/dolscLkjLXTpRqgr9K8bzlzL1vM9WTjpHc=" />
<meta name="msvalidate.01" content="F85F81C1D0BAB5C349E8395628845E27" />
<meta name="y_key" content="265502be3db4fb6e" />
</HEAD>
         <BODY BGCOLOR="#ffffff">
<h1 style="float: right; margin: 0; padding: 0 0 0 15px;"><a href="https://www.meetup.com/new-york-php/">NYCPHP Meetup</a></h1><h1><a href="http://www.nyphp.org">NYPHP.org</a></h1>
   <H1>[nycphp-talk] problems loading a custom, shared extension</H1>
    <B>Hans Zaunere</B> 
    <A HREF="mailto:talk%40lists.nyphp.org?Subject=Re:%20Re%3A%20%5Bnyphp-talk%5D%20problems%20loading%20a%20custom%2C%20shared%20extension&In-Reply-To=%3C002201c60440%24b8865ff0%246501a8c0%40MZ%3E"
       TITLE="[nycphp-talk] problems loading a custom, shared extension">lists at zaunere.com
       </A><BR>
    <I>Sun Dec 18 21:05:43 EST 2005</I>
    <P><UL>
        <LI>Previous message: <A HREF="016977.html">[nycphp-talk] problems loading a custom, shared extension
</A></li>
        <LI>Next message: <A HREF="016953.html">[nycphp-talk] PHP Coding Standards
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#17045">[ date ]</a>
              <a href="thread.html#17045">[ thread ]</a>
              <a href="subject.html#17045">[ subject ]</a>
              <a href="author.html#17045">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>

Jonathan wrote on Thursday, December 08, 2005 12:28 AM:
&gt;<i> I need help figuring out an error when writing/loading a custom, shared
</I>&gt;<i> extension (.so) for PHP. 
</I>&gt;<i> Could anyone help or recommend good links, books, or other mailing lists
</I>&gt;<i> for developing in C to extend PHP? 
</I>&gt;<i> 
</I>&gt;<i> I have &quot;Building Custom PHP Extensions&quot; by Blake Schwendiman and
</I>&gt;<i> &quot;Advanced PHP Programming&quot; by George Schlossnagle (9432 times mentioned
</I>&gt;<i> on this list). Both excellent books which got me started, but looking for
</I>&gt;<i> more information.  I've been around the Zend Dev site and
</I>&gt;<i> <A HREF="http://talks.php.net/">http://talks.php.net/</A>  (<A HREF="http://www.zend.com/apidoc/">http://www.zend.com/apidoc/</A> as well) but I am
</I>&gt;<i> stuck.     
</I>&gt;<i> 
</I>&gt;<i> Thank you.
</I>&gt;<i> 
</I>&gt;<i> Background:
</I>&gt;<i> -------------
</I>&gt;<i> I am writing a script in C that uses shared memory and/or memory-mapped
</I>&gt;<i> files to (attempt to) speed up some frequently used PHP functionality. 
</I>&gt;<i> I need to test the speed of the extension (using some apache &quot;ab&quot;
</I>&gt;<i> scripts)  in environments where the extension will be loaded via the ini
</I>&gt;<i> rather than being compiled into php.  
</I>&gt;<i> 
</I>&gt;<i> Summary of Problem:
</I>&gt;<i> ----------
</I>&gt;<i> The extension will compile into PHP 4.4.1 and runs without issue as a
</I>&gt;<i> compiled-in extension. 
</I>&gt;<i> I can build it into a shared object using phpize for both 4.4.1 source
</I>&gt;<i> and the 4.3.11 binaries. 
</I>&gt;<i> I get no errors running phpize.
</I>&gt;<i> In both the PHP.INI context and dl() context the only error message is  (
</I>&gt;<i> it can, at least, find the .so): &quot;PHP Warning:  Unknown(): Invalid
</I>&gt;<i> library (maybe not a PHP library) 'my_ext.so'  in Unknown on line 0&quot; 
</I>&gt;<i> 
</I>&gt;<i> Details:
</I>&gt;<i> -----------
</I>&gt;<i> Linux, Fedora Core 4. GCC 4.0.x
</I>&gt;<i> 
</I>&gt;<i> dl()  fails to load the .so in CLI with php of the same version (perhaps
</I>&gt;<i> it fails because it is already an internal extension?) 
</I>&gt;<i> dl() AND loading through the INI fail in a server (Apache 2.0.x) with a
</I>&gt;<i> different version of php (4.3.11)  . php.ini. (I run phpize that is
</I>&gt;<i> included with the precompiled 4.3.11 and added the 3 headers it needs. ) 
</I>&gt;<i> Only error message is at load time ( it can, at least, find the .so):
</I>&gt;<i> 
</I>&gt;<i> &quot;PHP Warning:  Unknown(): Invalid library (maybe not a PHP library)
</I>&gt;<i> 'my_ext.so'  in Unknown on line 0&quot;
</I>
This would involve some more debugging, but perhaps here are some things to
keep in mind:

-- you might get symbol conflicts if the extension is compiled in and also
loaded with dl();  do one or the other

-- I've noticed that PHP extensions are quite sensitive to the PHP and Zend
Engine versions.  Be sure you're using the same versions of phpize and the
running PHP.  Pay attention to the top section of phpinfo()'s outout (fields
like PHP API, PHP Extension, Zend Extension).

Best,


---
Hans Zaunere / President / New York PHP
   www.nyphp.org  /  www.nyphp.com





</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="016977.html">[nycphp-talk] problems loading a custom, shared extension
</A></li>
	<LI>Next message: <A HREF="016953.html">[nycphp-talk] PHP Coding Standards
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#17045">[ date ]</a>
              <a href="thread.html#17045">[ thread ]</a>
              <a href="subject.html#17045">[ subject ]</a>
              <a href="author.html#17045">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.nyphp.org/mailman/listinfo/talk">More information about the talk
mailing list</a><br>
</body></html>
