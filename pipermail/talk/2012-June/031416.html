<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-51353372-3"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-51353372-3');
</script>
   <TITLE> [nycphp-talk] Can't do PHP 'exec' for an rsync command via web	server
   </TITLE>
   <LINK REL="Index" HREF="http://nyphp.org/pipermail/talk/2012-June/index.html" >
   <LINK REL="made" HREF="mailto:talk%40lists.nyphp.org?Subject=Re:%20Re%3A%20%5Bnyphp-talk%5D%20Can%27t%20do%20PHP%20%27exec%27%20for%20an%20rsync%20command%20via%20web%0A%09server&In-Reply-To=%3CCAN7%3DVv-W3-L6s4Szai6_E8MC%3D2SasQy98pG%3DqoKp2Gj8Sy1Fhw%40mail.gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="031415.html">
   <LINK REL="Next"  HREF="031408.html">
 <meta name="description" content="PHP jobs stackware web application support and development forums for Mongo LAMP MySQL SQL Windows IIS Linux." />
<meta name="author" content="Stackware Web Development - http://stackware.com" />
<meta name="verify-v1" content="zWMoPwMn/dolscLkjLXTpRqgr9K8bzlzL1vM9WTjpHc=" />
<meta name="msvalidate.01" content="F85F81C1D0BAB5C349E8395628845E27" />
<meta name="y_key" content="265502be3db4fb6e" />
</HEAD>
         <BODY BGCOLOR="#ffffff">
<h1 style="float: right; margin: 0; padding: 0 0 0 15px;"><a href="https://www.meetup.com/new-york-php/">NYCPHP Meetup</a></h1><h1><a href="http://www.nyphp.org">NYPHP.org</a></h1>
   <H1>[nycphp-talk] Can't do PHP 'exec' for an rsync command via web	server</H1>
    <B>David Roth</B> 
    <A HREF="mailto:talk%40lists.nyphp.org?Subject=Re:%20Re%3A%20%5Bnyphp-talk%5D%20Can%27t%20do%20PHP%20%27exec%27%20for%20an%20rsync%20command%20via%20web%0A%09server&In-Reply-To=%3CCAN7%3DVv-W3-L6s4Szai6_E8MC%3D2SasQy98pG%3DqoKp2Gj8Sy1Fhw%40mail.gmail.com%3E"
       TITLE="[nycphp-talk] Can't do PHP 'exec' for an rsync command via web	server">davidalanroth at gmail.com
       </A><BR>
    <I>Tue Jun 26 02:19:01 EDT 2012</I>
    <P><UL>
        <LI>Previous message: <A HREF="031415.html">[nycphp-talk] Can't do PHP 'exec' for an rsync command via web	server
</A></li>
        <LI>Next message: <A HREF="031408.html">[nycphp-talk] Can't do PHP 'exec' for an rsync command via web server
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#31416">[ date ]</a>
              <a href="thread.html#31416">[ thread ]</a>
              <a href="subject.html#31416">[ subject ]</a>
              <a href="author.html#31416">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>That a good tutorial. I've been using rsync with ssh successfully for a
numbers of years in shell scripts and cron jobs, but not through exec or
system in PHP until now. Which is why it was so frustrating that it wasn't
working with PHP, when I never had problems with rsync/ssh before.

Greg also brings up a good point about security. For me, this is an
in-house server behind a firewall and while I expected to put it in the
DMZ, I've found that's a bad idea, because one afternoon after placing it
in the DMZ I saw in the logs a few of bots trying to break in and do nasty
stuff. So if someone needs access to anything, I put it on an external
hosting service where they are better equipped to handle bot attacks. I
came to this conclusion after a Linux Admin told me he spends time each day
checking for attempted break-ins and blacklisting bots.

Am I asking for trouble by creating ssh keys for apache user under
these circumstances, I certainly hope not, but I've not found an acceptable
work-around. It was mentioned to me that I could also do something with
iptables, but I've not had the time to check it out.

David Roth

On Mon, Jun 25, 2012 at 2:51 PM, Greg Rundlett (freephile) &lt;
<A HREF="http://lists.nyphp.org/mailman/listinfo/talk">greg at freephile.com</A>&gt; wrote:

&gt;<i> Although it's a bit confusing, the man page for rsync describes how to
</I>&gt;<i> invoke SSH to as your remote shell, and the manpage for SSH describes how
</I>&gt;<i> to do key-based authentication.  Taken together, these methods can help
</I>&gt;<i> when a normal user environment is not present (e.g. in a web script, or
</I>&gt;<i> from cron).  This webpage offers a good explanation of HOWTO
</I>&gt;<i> <A HREF="http://troy.jdmz.net/rsync/index.html">http://troy.jdmz.net/rsync/index.html</A>
</I>&gt;<i>
</I>&gt;<i> Greg Rundlett
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> On Mon, Jun 25, 2012 at 1:14 PM, Daniel Convissor &lt;
</I>&gt;<i> <A HREF="http://lists.nyphp.org/mailman/listinfo/talk">danielc at analysisandsolutions.com</A>&gt; wrote:
</I>&gt;<i>
</I>&gt;&gt;<i> Hi David:
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> &gt; It was very wise of Hans to also recommend to create
</I>&gt;&gt;<i> &gt; /home/apache instead of using the default /var/www because a nasty user
</I>&gt;&gt;<i> &gt; could have easily accessed the .ssh directory there and gotten the
</I>&gt;&gt;<i> &gt; public/private keys, and the known hosts.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Well, they still do.  Though the attacker would have to be able to
</I>&gt;&gt;<i> add/edit a script on your server, putting in code that reads the
</I>&gt;&gt;<i> files from the /home/apache dir.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> --Dan
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> --
</I>&gt;&gt;<i>  T H E   A N A L Y S I S   A N D   S O L U T I O N S   C O M P A N Y
</I>&gt;&gt;<i>            data intensive web and database programming
</I>&gt;&gt;<i>                <A HREF="http://www.AnalysisAndSolutions.com/">http://www.AnalysisAndSolutions.com/</A>
</I>&gt;&gt;<i>        4015 7th Ave #4, Brooklyn NY 11232  v: 718-854-0335
</I>&gt;&gt;<i> _______________________________________________
</I>&gt;&gt;<i>
</I>&gt;<i>
</I>-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.nyphp.org/pipermail/talk/attachments/20120626/2a3361a4/attachment.html">http://lists.nyphp.org/pipermail/talk/attachments/20120626/2a3361a4/attachment.html</A>&gt;
</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="031415.html">[nycphp-talk] Can't do PHP 'exec' for an rsync command via web	server
</A></li>
	<LI>Next message: <A HREF="031408.html">[nycphp-talk] Can't do PHP 'exec' for an rsync command via web server
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#31416">[ date ]</a>
              <a href="thread.html#31416">[ thread ]</a>
              <a href="subject.html#31416">[ subject ]</a>
              <a href="author.html#31416">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.nyphp.org/mailman/listinfo/talk">More information about the talk
mailing list</a><br>
</body></html>
