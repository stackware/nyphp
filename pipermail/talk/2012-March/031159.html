<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-51353372-3"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-51353372-3');
</script>
   <TITLE> [nycphp-talk] I've been hit with an eval(base64_decode(&quot;....&quot;)) injection attack
   </TITLE>
   <LINK REL="Index" HREF="http://nyphp.org/pipermail/talk/2012-March/index.html" >
   <LINK REL="made" HREF="mailto:talk%40lists.nyphp.org?Subject=Re:%20Re%3A%20%5Bnyphp-talk%5D%20I%27ve%20been%20hit%20with%20an%20eval%28base64_decode%28%22....%22%29%29%0A%20injection%20attack&In-Reply-To=%3C20120325200755.GA12577%40panix.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="031158.html">
   <LINK REL="Next"  HREF="031160.html">
 <meta name="description" content="PHP jobs stackware web application support and development forums for Mongo LAMP MySQL SQL Windows IIS Linux." />
<meta name="author" content="Stackware Web Development - http://stackware.com" />
<meta name="verify-v1" content="zWMoPwMn/dolscLkjLXTpRqgr9K8bzlzL1vM9WTjpHc=" />
<meta name="msvalidate.01" content="F85F81C1D0BAB5C349E8395628845E27" />
<meta name="y_key" content="265502be3db4fb6e" />
</HEAD>
         <BODY BGCOLOR="#ffffff">
<h1 style="float: right; margin: 0; padding: 0 0 0 15px;"><a href="https://www.meetup.com/new-york-php/">NYCPHP Meetup</a></h1><h1><a href="http://www.nyphp.org">NYPHP.org</a></h1>
   <H1>[nycphp-talk] I've been hit with an eval(base64_decode(&quot;....&quot;)) injection attack</H1>
    <B>Daniel Convissor</B> 
    <A HREF="mailto:talk%40lists.nyphp.org?Subject=Re:%20Re%3A%20%5Bnyphp-talk%5D%20I%27ve%20been%20hit%20with%20an%20eval%28base64_decode%28%22....%22%29%29%0A%20injection%20attack&In-Reply-To=%3C20120325200755.GA12577%40panix.com%3E"
       TITLE="[nycphp-talk] I've been hit with an eval(base64_decode(&quot;....&quot;)) injection attack">danielc at analysisandsolutions.com
       </A><BR>
    <I>Sun Mar 25 16:07:55 EDT 2012</I>
    <P><UL>
        <LI>Previous message: <A HREF="031158.html">[nycphp-talk] Are Singletons Really Evil?
</A></li>
        <LI>Next message: <A HREF="031160.html">[nycphp-talk] I've been hit with an eval(base64_decode(&quot;....&quot;)) injection attack
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#31159">[ date ]</a>
              <a href="thread.html#31159">[ thread ]</a>
              <a href="subject.html#31159">[ subject ]</a>
              <a href="author.html#31159">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi David:

&gt;<i> My Dreamhost shared hosting account just had its *.php injected with some
</I>&gt;<i> garbage.
</I>
Sorry.  Alas, injecting code into legitimate sites is the #1 source
these days of infecting end user computers.  So securing our rinky-dink
personal websites has become quite important.

I recently picked WordPress for a site and then looked for security
plugins for it.  The eventually lead me to write my own plugin, which
somehow wound up taking about six weeks of intense work.  I've passed it
around for testing and code review.  I'd love to hear the thoughts of
the people here on it from a code level and user interface level.

<A HREF="http://wordpress.org/extend/plugins/login-security-solution/">http://wordpress.org/extend/plugins/login-security-solution/</A>


&gt;<i>        egrep -lr '&lt;\?php.+eval\(base64_decode\(&quot;[^&quot;]+&quot;\)\);\?&gt;'  *| xargs
</I>
I'd have just grep'ed for &quot;eval&quot;, since that should never be in any code
I want to use.  Your regex would miss code that doesn't have double
quotes, doesn't use base64_decode, has spacing in it, etc.

Oh, and lock down your file permissions.  The web server shouldn't be
allowed to write to any files or directories.

Thanks,

--Dan

-- 
 T H E   A N A L Y S I S   A N D   S O L U T I O N S   C O M P A N Y
            data intensive web and database programming
                <A HREF="http://www.AnalysisAndSolutions.com/">http://www.AnalysisAndSolutions.com/</A>
 4015 7th Ave #4, Brooklyn NY 11232  v: 718-854-0335 f: 718-854-0409

</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="031158.html">[nycphp-talk] Are Singletons Really Evil?
</A></li>
	<LI>Next message: <A HREF="031160.html">[nycphp-talk] I've been hit with an eval(base64_decode(&quot;....&quot;)) injection attack
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#31159">[ date ]</a>
              <a href="thread.html#31159">[ thread ]</a>
              <a href="subject.html#31159">[ subject ]</a>
              <a href="author.html#31159">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.nyphp.org/mailman/listinfo/talk">More information about the talk
mailing list</a><br>
</body></html>
