<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-51353372-3"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-51353372-3');
</script>
   <TITLE> [nycphp-talk] Virtualbox as a dev environment
   </TITLE>
   <LINK REL="Index" HREF="http://nyphp.org/pipermail/talk/2011-September/index.html" >
   <LINK REL="made" HREF="mailto:talk%40lists.nyphp.org?Subject=Re:%20Re%3A%20%5Bnyphp-talk%5D%20Virtualbox%20as%20a%20dev%20environment&In-Reply-To=%3CCAE1ELn%2BqiJ8FK8kMYTkJCZHVCdCoaJ1XbXhmoQpsf2ijjkDzdg%40mail.gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="030808.html">
   <LINK REL="Next"  HREF="030810.html">
 <meta name="description" content="PHP jobs stackware web application support and development forums for Mongo LAMP MySQL SQL Windows IIS Linux." />
<meta name="author" content="Stackware Web Development - http://stackware.com" />
<meta name="verify-v1" content="zWMoPwMn/dolscLkjLXTpRqgr9K8bzlzL1vM9WTjpHc=" />
<meta name="msvalidate.01" content="F85F81C1D0BAB5C349E8395628845E27" />
<meta name="y_key" content="265502be3db4fb6e" />
</HEAD>
         <BODY BGCOLOR="#ffffff">
<h1 style="float: right; margin: 0; padding: 0 0 0 15px;"><a href="https://www.meetup.com/new-york-php/">NYCPHP Meetup</a></h1><h1><a href="http://www.nyphp.org">NYPHP.org</a></h1>
   <H1>[nycphp-talk] Virtualbox as a dev environment</H1>
    <B>Federico Ulfo</B> 
    <A HREF="mailto:talk%40lists.nyphp.org?Subject=Re:%20Re%3A%20%5Bnyphp-talk%5D%20Virtualbox%20as%20a%20dev%20environment&In-Reply-To=%3CCAE1ELn%2BqiJ8FK8kMYTkJCZHVCdCoaJ1XbXhmoQpsf2ijjkDzdg%40mail.gmail.com%3E"
       TITLE="[nycphp-talk] Virtualbox as a dev environment">rainelemental at gmail.com
       </A><BR>
    <I>Fri Sep  2 12:23:24 EDT 2011</I>
    <P><UL>
        <LI>Previous message: <A HREF="030808.html">[nycphp-talk] Virtualbox as a dev environment
</A></li>
        <LI>Next message: <A HREF="030810.html">[nycphp-talk] Virtualbox as a dev environment
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#30809">[ date ]</a>
              <a href="thread.html#30809">[ thread ]</a>
              <a href="subject.html#30809">[ subject ]</a>
              <a href="author.html#30809">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Interesting, what about performances? I guess is useful only for testing
right?
 --
Federico Ulfo &#187; &lt;<A HREF="http://www.federicoulfo.it/">http://www.federicoulfo.it/</A>&gt;
Certified Developer Google &amp; PHP
  &lt;<A HREF="http://www.federicoulfo.it/">http://www.federicoulfo.it/</A>&gt;



On Fri, Sep 2, 2011 at 12:19 PM, Gary Mort &lt;<A HREF="http://lists.nyphp.org/mailman/listinfo/talk">garyamort at gmail.com</A>&gt; wrote:

&gt;<i> I've been driven a little crazy lately with trying to develop for Joomla
</I>&gt;<i> with the following limitations:
</I>&gt;<i>
</I>&gt;<i> 1) Half the sites use PHP 5.2 and half of them use PHP 5.3
</I>&gt;<i> 2) Sometimes I'm online and sometimes I'm offline
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> I kept coming back to &quot;if only I was using linux, I could set things up
</I>&gt;<i> more easily&quot;....  Then it struck me that my desktop is a beefy system
</I>&gt;<i> memorywise[this solution is gonna take a lot of memory] - so I gave
</I>&gt;<i> VirtualBox a try.
</I>&gt;<i> <A HREF="http://www.virtualbox.org/">http://www.virtualbox.org/</A>
</I>&gt;<i>
</I>&gt;<i> VirtualBox basically allows you to run different operating systems in a
</I>&gt;<i> virtual environment.
</I>&gt;<i>
</I>&gt;<i> For my current setup, I started with Ubuntu Server:
</I>&gt;<i> <A HREF="http://www.ubuntu.com/**download/server/download&lt;http://www.ubuntu.com/download/server/download">http://www.ubuntu.com/**download/server/download&lt;http://www.ubuntu.com/download/server/download</A>&gt;
</I>&gt;<i>
</I>&gt;<i> For the VirtualBox settings, choose fixed disk size - not dynamic.  I use
</I>&gt;<i> 10GB, it eats up the full space but improves performance.  My system has 8GB
</I>&gt;<i> of memory, so I give the system 2GB of ram, I'd suggest nothing under 1GB.
</I>&gt;<i>
</I>&gt;<i> in the network settings for the virtual machine, I setup TWO network
</I>&gt;<i> adapters.  Adapter 1 is set to &quot;bridged adapter&quot;, the name is selected from
</I>&gt;<i> my active adapter.   This allows the system to connect through yours to the
</I>&gt;<i> internet.   Adapter 2 is a &quot;Host Only Adapter&quot;  - basically it's a &quot;fake&quot;
</I>&gt;<i> network adapter that allows your pc communicate with the VM and the VM
</I>&gt;<i> communicate with you.  So if your doing this on a laptop, you can still work
</I>&gt;<i> even while offline.
</I>&gt;<i>
</I>&gt;<i> ****For the application settings[File--&gt;Preferences] - go to the network
</I>&gt;<i> settings and configure the virtual network adapter settings.  The important
</I>&gt;<i> bit here is to disable the dhcp server.
</I>&gt;<i>
</I>&gt;<i> When installing Ubuntu, setup adapter 1 for DHCP and adapter 2 as a static
</I>&gt;<i> IP address in a different network[most home networks are 192.168.1.0 or
</I>&gt;<i> 192.168.2.0 - so I give my internal only network the address 192.168.129.1,
</I>&gt;<i> netmask 255.255.255.0 - no default gateway!]
</I>&gt;<i>
</I>&gt;<i> Openssh is important to install for decent CLI access.
</I>&gt;<i> Samba should be installed to make it easy to access the files on the
</I>&gt;<i> server[just share out your web directory and then you can map the drive and
</I>&gt;<i> access it from your favorite web editor].
</I>&gt;<i> Git, subversion, and mercurial should be installed since you need it at
</I>&gt;<i> some point
</I>&gt;<i> I always make sure to install wget
</I>&gt;<i> Now, the piece of magic that makes this all work, DNSMasq:
</I>&gt;<i> <A HREF="http://thekelleys.org.uk/**dnsmasq/doc.html&lt;http://thekelleys.org.uk/dnsmasq/doc.html">http://thekelleys.org.uk/**dnsmasq/doc.html&lt;http://thekelleys.org.uk/dnsmasq/doc.html</A>&gt;
</I>&gt;<i>
</I>&gt;<i> DNSMasq allows you to run a DHCP server and  DNS cache on the virtual
</I>&gt;<i> machine.  So you setup the DHCP server to give out an IP address to your
</I>&gt;<i> system, and have it pass itself along as the DNS server[make VERY sure to
</I>&gt;<i> also specify a blank gateway/router so all your internet traffic goes to the
</I>&gt;<i> right place].
</I>&gt;<i> The importan bits I've found:
</I>&gt;<i> interface=eth1
</I>&gt;<i> interface=lo
</I>&gt;<i> ^^^these 2 lines makes sure that your system doesn't try to take over your
</I>&gt;<i> &quot;real&quot; network
</I>&gt;<i> address=/osm/192.168.56.1
</I>&gt;<i> domain=osm
</I>&gt;<i> ^^^this sets up the &quot;fake&quot; domain osm and configures it so any domain
</I>&gt;<i> ending in .osm will be given the ip address 192.168.56.1  - the virtual
</I>&gt;<i> machines ip address
</I>&gt;<i> dhcp-range=192.168.56.10,192.**168.56.15,255.255.255.0,12h
</I>&gt;<i> ^^^ this gives your fake network a range of addresses, and a long timeout
</I>&gt;<i> dhcp-option=3
</I>&gt;<i> ^^^ makes sure dnsmasq doesn't try to get your computer to route traffic
</I>&gt;<i> through it
</I>&gt;<i> dhcp-option=19,0           # option ip-forwarding off
</I>&gt;<i> dhcp-option=44,192.168.56.1     # set netbios-over-TCP/IP nameserver(s) aka
</I>&gt;<i> WINS server(s)
</I>&gt;<i> dhcp-option=45,192.168.56.1     # netbios datagram distribution server
</I>&gt;<i> dhcp-option=46,8           # netbios node type
</I>&gt;<i> ^^^^helps with the file shareing
</I>&gt;<i> dhcp-authoritative
</I>&gt;<i> ^^^speeds up initialization
</I>&gt;<i> cache-size=1500
</I>&gt;<i> no-negcache
</I>&gt;<i> ^^^helps with lookups
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> As an added bennie, with dnsmasq running, your lame windows box now has the
</I>&gt;<i> full power of a linux domain name caching - so it will speed up your general
</I>&gt;<i> internet usage.
</I>&gt;<i>
</I>&gt;<i> Then, in general, I follow the instructions at
</I>&gt;<i> <A HREF="http://www.metod.si/multiple-**php-versions-with-apache-2-**">http://www.metod.si/multiple-**php-versions-with-apache-2-**</A>
</I>&gt;<i> fastcgi-phpfarm-on-ubuntu/&lt;<A HREF="http://www.metod.si/multiple-php-versions-with-apache-2-fastcgi-phpfarm-on-ubuntu/">http://www.metod.si/multiple-php-versions-with-apache-2-fastcgi-phpfarm-on-ubuntu/</A>&gt;to setup and install apache, mysql, and php 5.2 and 5.3 - with modifications
</I>&gt;<i> for the latest versions of each.
</I>&gt;<i>
</I>&gt;<i> In my virtual hosts configuration the following are important:
</I>&gt;<i> VirtualDocumentRoot /var/www/%-3
</I>&gt;<i>
</I>&gt;<i> %-3 basically means the third element of the domain name and is used to map
</I>&gt;<i> domains to directories.  So for me:
</I>&gt;<i> <A HREF="http://testsite.53.osm">http://testsite.53.osm</A> - the files stored at /var/www/testsite - the THIRD
</I>&gt;<i> element of the domain  name will be used
</I>&gt;<i> also using that directory is <A HREF="http://www.testsite.53.osm">http://www.testsite.53.osm</A> and
</I>&gt;<i> <A HREF="http://testsite.52.home">http://testsite.52.home</A>
</I>&gt;<i>
</I>&gt;<i> Wheras <A HREF="http://mydomain.53.osm">http://mydomain.53.osm</A> will use the files located at
</I>&gt;<i> /var/www/mydomain
</I>&gt;<i>
</I>&gt;<i> Our last bit of magic uses the virtual host configuration:
</I>&gt;<i> &lt;VirtualHost *:80&gt;
</I>&gt;<i>        ServerAdmin <A HREF="http://lists.nyphp.org/mailman/listinfo/talk">webmaster at localhost</A>
</I>&gt;<i>        ServerName 52.osm
</I>&gt;<i>    ServerAlias *.52.osm
</I>&gt;<i>    VirtualDocumentRoot /var/www/%-3
</I>&gt;<i>        DocumentRoot /var/www
</I>&gt;<i> &lt;Directory /var/www/&gt;
</I>&gt;<i>                Options +Indexes +FollowSymLinks +MultiViews +ExecCGI
</I>&gt;<i>                AllowOverride All
</I>&gt;<i>                Order allow,deny
</I>&gt;<i>                allow from all
</I>&gt;<i>                AddHandler php-cgi .php
</I>&gt;<i>                Action php-cgi /php-fcgi/php-cgi-5.2
</I>&gt;<i>
</I>&gt;<i> &lt;/Directory&gt;
</I>&gt;<i>
</I>&gt;<i> &lt;VirtualHost *:80&gt;
</I>&gt;<i>        ServerAdmin <A HREF="http://lists.nyphp.org/mailman/listinfo/talk">webmaster at localhost</A>
</I>&gt;<i>        ServerName 53.osm
</I>&gt;<i>    ServerAlias *.53.osm
</I>&gt;<i>    VirtualDocumentRoot /var/www/%-3
</I>&gt;<i>        DocumentRoot /var/www
</I>&gt;<i> &lt;Directory /var/www/&gt;
</I>&gt;<i>                Options +Indexes +FollowSymLinks +MultiViews +ExecCGI
</I>&gt;<i>                AllowOverride All
</I>&gt;<i>                Order allow,deny
</I>&gt;<i>                allow from all
</I>&gt;<i>                AddHandler php-cgi .php
</I>&gt;<i>                Action php-cgi /php-fcgi/php-cgi-5.3
</I>&gt;<i>
</I>&gt;<i> &lt;/Directory&gt;
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> These 2 configurations are almost identical, the only things that change
</I>&gt;<i> are servername, serveralias, and action
</I>&gt;<i> The servername has to be a full name, so I just use the php version I want
</I>&gt;<i> with the domain tacked on[53.osm].
</I>&gt;<i> The serveralias can have a wildcard, so *.53.osm means that for ANY website
</I>&gt;<i> you try to load which ends in .53.osm use this configuration.
</I>&gt;<i> Lastly, the Action line tells apache which PHP FastCGI server to route the
</I>&gt;<i> request to.  So I have 2 different instances of PHP running, 5.2 and 5.3 and
</I>&gt;<i> route accordingly.
</I>&gt;<i>
</I>&gt;<i> [Note, I share out the /var/www directory using SAMBA, and then map it on
</I>&gt;<i> my windows box to drive letter W:]
</I>&gt;<i>
</I>&gt;<i> So now to edit files on my test website, garyamort, I edit the files
</I>&gt;<i> located at w:/garyamort
</I>&gt;<i> To see the website using PHP 5.2, I go to <A HREF="http://garyamort.52.osm">http://garyamort.52.osm</A>
</I>&gt;<i> To see the website using PHP 5.3 I go to <A HREF="http://garyamort.53.osm">http://garyamort.53.osm</A>
</I>&gt;<i>
</I>&gt;<i> When dealing with oddities like a website which &quot;suddenly&quot; stops working,
</I>&gt;<i> one cause is upgrading to PHP 5.3
</I>&gt;<i> CiviCRM for example has 2 versions, almost identical but one of them will
</I>&gt;<i> run on PHP 5.2 and one runs on PHP 5.3  - so a CiviCRM website that suddenly
</I>&gt;<i> stops working is likely to have a webhost who upgraded PHP from 5.2 to 5.3
</I>&gt;<i>
</I>&gt;<i> It's a fairly simple solution - just copy the 5.3 version files over the
</I>&gt;<i> old version files AND DELETE THE TEMPLATE CACHE DIRECTORIES - and it will
</I>&gt;<i> start working again.
</I>&gt;<i>
</I>&gt;<i> If there is interest, I'm trying to put together a virtual box of all this
</I>&gt;<i> pre-configured, so all you have to do is - with the exception of the part I
</I>&gt;<i> put *** in front of, it would all be plug and play for most home networks.
</I>&gt;<i>
</I>&gt;<i> By the same token, if anyone knows a bit more about DHCP and DNS - I've had
</I>&gt;<i> trouble with this part with windows...since both the home router and my
</I>&gt;<i> virtual box broadcast a DNS server address, Windows will occassionally grab
</I>&gt;<i> the wrong DNS address.  The problem is, I don't want to ALWAYS run the
</I>&gt;<i> virtualbox, so I want some way for the VM to override the DNS address, but
</I>&gt;<i> still allow the client to use the other one.
</I>&gt;<i>
</I>&gt;<i> And for those of you who are really good with IPForwarding, I sometimes
</I>&gt;<i> have to use remove VPN networks.  So I have the VPN client on both my
</I>&gt;<i> windows machine and the virtual machine running.  It would be great if I
</I>&gt;<i> could get the VPN client on the linux machine to dynamically update dnsmasq
</I>&gt;<i> so that when it's running, the DHCP server will tell my windows box to route
</I>&gt;<i> all traffic just for the remote network through it, and do some NAT routing
</I>&gt;<i> on the virtualbox so the connection goes through there.
</I>&gt;<i>
</I>&gt;<i> -Gary
</I>&gt;<i> ______________________________**_________________
</I>&gt;<i> New York PHP Users Group Community Talk Mailing List
</I>&gt;<i> <A HREF="http://lists.nyphp.org/**mailman/listinfo/talk&lt;http://lists.nyphp.org/mailman/listinfo/talk">http://lists.nyphp.org/**mailman/listinfo/talk&lt;http://lists.nyphp.org/mailman/listinfo/talk</A>&gt;
</I>&gt;<i>
</I>&gt;<i> <A HREF="http://www.nyphp.org/Show-**Participation&lt;http://www.nyphp.org/Show-Participation">http://www.nyphp.org/Show-**Participation&lt;http://www.nyphp.org/Show-Participation</A>&gt;
</I>&gt;<i>
</I>-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.nyphp.org/pipermail/talk/attachments/20110902/00cd488b/attachment.html">http://lists.nyphp.org/pipermail/talk/attachments/20110902/00cd488b/attachment.html</A>&gt;
</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="030808.html">[nycphp-talk] Virtualbox as a dev environment
</A></li>
	<LI>Next message: <A HREF="030810.html">[nycphp-talk] Virtualbox as a dev environment
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#30809">[ date ]</a>
              <a href="thread.html#30809">[ thread ]</a>
              <a href="subject.html#30809">[ subject ]</a>
              <a href="author.html#30809">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.nyphp.org/mailman/listinfo/talk">More information about the talk
mailing list</a><br>
</body></html>
