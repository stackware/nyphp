<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-51353372-3"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-51353372-3');
</script>
   <TITLE> [nycphp-talk] xls output: localhost works, www doesn't
   </TITLE>
   <LINK REL="Index" HREF="http://nyphp.org/pipermail/talk/2008-January/index.html" >
   <LINK REL="made" HREF="mailto:talk%40lists.nyphp.org?Subject=Re:%20Re%3A%20%5Bnyphp-talk%5D%20xls%20output%3A%20localhost%20works%2C%20www%20doesn%27t&In-Reply-To=%3C002701c85832%2481858740%240501a8c0%40adam%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="024531.html">
   <LINK REL="Next"  HREF="024562.html">
 <meta name="description" content="PHP jobs stackware web application support and development forums for Mongo LAMP MySQL SQL Windows IIS Linux." />
<meta name="author" content="Stackware Web Development - http://stackware.com" />
<meta name="verify-v1" content="zWMoPwMn/dolscLkjLXTpRqgr9K8bzlzL1vM9WTjpHc=" />
<meta name="msvalidate.01" content="F85F81C1D0BAB5C349E8395628845E27" />
<meta name="y_key" content="265502be3db4fb6e" />
</HEAD>
         <BODY BGCOLOR="#ffffff">
<h1 style="float: right; margin: 0; padding: 0 0 0 15px;"><a href="https://www.meetup.com/new-york-php/">NYCPHP Meetup</a></h1><h1><a href="http://www.nyphp.org">NYPHP.org</a></h1>
   <H1>[nycphp-talk] xls output: localhost works, www doesn't</H1>
    <B>Rick Retzko</B> 
    <A HREF="mailto:talk%40lists.nyphp.org?Subject=Re:%20Re%3A%20%5Bnyphp-talk%5D%20xls%20output%3A%20localhost%20works%2C%20www%20doesn%27t&In-Reply-To=%3C002701c85832%2481858740%240501a8c0%40adam%3E"
       TITLE="[nycphp-talk] xls output: localhost works, www doesn't">rick at click-rick.net
       </A><BR>
    <I>Wed Jan 16 06:25:30 EST 2008</I>
    <P><UL>
        <LI>Previous message: <A HREF="024531.html">[nycphp-talk] xls output: localhost works, www doesn't
</A></li>
        <LI>Next message: <A HREF="024562.html">[nycphp-talk] xls output: localhost works, www doesn't
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#24556">[ date ]</a>
              <a href="thread.html#24556">[ thread ]</a>
              <a href="subject.html#24556">[ subject ]</a>
              <a href="author.html#24556">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Thanks for the recommendation!  I've got it working now (pointing the form
action directly to the file doing the processing, then exit() at the end of
the process), but I'd like to be A LOT more confident that I understand why
its working!
 
Can anyone point me to books/articles/tutorial that focus on how PHP
interprets headers or what's happening in the background when you download
from the server?
 
Thanks - 
 
Rick
============
MFR Holdings, LLC
<A HREF="http://lists.nyphp.org/mailman/listinfo/talk">rick at click-rick.net</A>
201.755.4083
 

  _____  

From: <A HREF="http://lists.nyphp.org/mailman/listinfo/talk">talk-bounces at lists.nyphp.org</A> [mailto:<A HREF="http://lists.nyphp.org/mailman/listinfo/talk">talk-bounces at lists.nyphp.org</A>] On
Behalf Of Adrian Noland
Sent: Tuesday, January 15, 2008 8:18 AM
To: NYPHP Talk
Subject: Re: [nycphp-talk] xls output: localhost works, www doesn't


Try an ob_clean() before sending the header. That way you make sure there
are no extra LF/CR in your output.


On 1/14/08, Rick Retzko &lt; <A HREF="http://lists.nyphp.org/mailman/listinfo/talk">rick at click-rick.net</A> &lt;mailto:<A HREF="http://lists.nyphp.org/mailman/listinfo/talk">rick at click-rick.net</A>&gt; &gt;
wrote: 

Hi all - Hopefully one of you have seen this and can quickly point me to the

error of my ways.

I need to output small files from mysql database to the user via excel
files. I'm using the following class to do this:

private function output_file(){
                //output the file to the user 
                header(&quot;Content-Type: application/vnd.ms-excel;
name='excel'&quot;);
                header(&quot;Content-Disposition: attachment;
filename={$this-&gt;_file_name}&quot;);
                header(&quot;Pragma: no-cache&quot;); 
                header(&quot;Expires:0&quot;);
                echo &quot;{$this-&gt;_export_string}&quot;;
                exit();
        }

This works perfectly on localhost, but when I move it to my www site, it 
outputs the data onto the screen.

I've tried using &quot;header('Content-Type: application/octet-stream');&quot; as
well, with the same results.

All help is appreciated!

Best Regards - 

Rick
============
MFR Holdings, LLC
<A HREF="http://lists.nyphp.org/mailman/listinfo/talk">rick at click-rick.net</A>
201.755.4083

_______________________________________________
New York PHP Community Talk Mailing List 
<A HREF="http://lists.nyphp.org/mailman/listinfo/talk">http://lists.nyphp.org/mailman/listinfo/talk</A>

NYPHPCon 2006 Presentations Online
<A HREF="http://www.nyphpcon.com">http://www.nyphpcon.com</A>

Show Your Participation in New York PHP
<A HREF="http://www.nyphp.org/show_participation.php">http://www.nyphp.org/show_participation.php</A>



-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.nyphp.org/pipermail/talk/attachments/20080116/b558626c/attachment.html">http://lists.nyphp.org/pipermail/talk/attachments/20080116/b558626c/attachment.html</A>&gt;
</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="024531.html">[nycphp-talk] xls output: localhost works, www doesn't
</A></li>
	<LI>Next message: <A HREF="024562.html">[nycphp-talk] xls output: localhost works, www doesn't
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#24556">[ date ]</a>
              <a href="thread.html#24556">[ thread ]</a>
              <a href="subject.html#24556">[ subject ]</a>
              <a href="author.html#24556">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.nyphp.org/mailman/listinfo/talk">More information about the talk
mailing list</a><br>
</body></html>
