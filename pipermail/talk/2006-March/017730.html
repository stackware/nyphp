<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-51353372-3"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-51353372-3');
</script>
   <TITLE> [nycphp-talk] Text file to MySQL entries
   </TITLE>
   <LINK REL="Index" HREF="http://nyphp.org/pipermail/talk/2006-March/index.html" >
   <LINK REL="made" HREF="mailto:talk%40lists.nyphp.org?Subject=Re:%20Re%3A%20%5Bnyphp-talk%5D%20Text%20file%20to%20MySQL%20entries&In-Reply-To=%3Cb76252690603101504v7a81e65dxeb3adc920f7305c4%40mail.gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="017721.html">
   <LINK REL="Next"  HREF="017731.html">
 <meta name="description" content="PHP jobs stackware web application support and development forums for Mongo LAMP MySQL SQL Windows IIS Linux." />
<meta name="author" content="Stackware Web Development - http://stackware.com" />
<meta name="verify-v1" content="zWMoPwMn/dolscLkjLXTpRqgr9K8bzlzL1vM9WTjpHc=" />
<meta name="msvalidate.01" content="F85F81C1D0BAB5C349E8395628845E27" />
<meta name="y_key" content="265502be3db4fb6e" />
</HEAD>
         <BODY BGCOLOR="#ffffff">
<h1 style="float: right; margin: 0; padding: 0 0 0 15px;"><a href="https://www.meetup.com/new-york-php/">NYCPHP Meetup</a></h1><h1><a href="http://www.nyphp.org">NYPHP.org</a></h1>
   <H1>[nycphp-talk] Text file to MySQL entries</H1>
    <B>csnyder</B> 
    <A HREF="mailto:talk%40lists.nyphp.org?Subject=Re:%20Re%3A%20%5Bnyphp-talk%5D%20Text%20file%20to%20MySQL%20entries&In-Reply-To=%3Cb76252690603101504v7a81e65dxeb3adc920f7305c4%40mail.gmail.com%3E"
       TITLE="[nycphp-talk] Text file to MySQL entries">chsnyder at gmail.com
       </A><BR>
    <I>Fri Mar 10 18:04:54 EST 2006</I>
    <P><UL>
        <LI>Previous message: <A HREF="017721.html">[nycphp-talk] Text file to MySQL entries
</A></li>
        <LI>Next message: <A HREF="017731.html">[nycphp-talk] Text file to MySQL entries
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#17730">[ date ]</a>
              <a href="thread.html#17730">[ thread ]</a>
              <a href="subject.html#17730">[ subject ]</a>
              <a href="author.html#17730">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On 3/10/06, Alberto dos Santos &lt;<A HREF="http://lists.nyphp.org/mailman/listinfo/talk">yournway at gmail.com</A>&gt; wrote:
&gt;<i> Hi all.
</I>&gt;<i>
</I>&gt;<i>  Sorry for not knowing my file handling routines 101, but I'm somewhat
</I>&gt;<i> desperate at this stage, so here it goes.
</I>&gt;<i>
</I>&gt;<i>  I have a mail server that sends 200 000 emails daily, no mistake 200K with
</I>&gt;<i> qmail-send, to a mailing list.
</I>&gt;<i>  Sometimes older users just add another email address and fail to erase the
</I>&gt;<i> old one so I need to comb through the mailbox regularly to find which
</I>&gt;<i> addresses  are bouncing so I can delete them.
</I>&gt;<i>  all messages have more or less the same configuration, and we have a shell
</I>&gt;<i> app that compiles the name of the email file and the header onto a text
</I>&gt;<i> file, something like this:
</I>&gt;<i>
</I>&gt;<i>   ./1141578003.21775.ns31756.ovh.net,S=41699
</I>&gt;<i>  Return-Path: &lt;&gt;
</I>&gt;<i>  Delivered-To: <A HREF="http://lists.nyphp.org/mailman/listinfo/talk">root at myserver</A>
</I>&gt;<i>  Received: (qmail 20952 invoked for bounce); 5 Mar 2006 16:59:17 -0000
</I>&gt;<i>  Date: 5 Mar 2006 16:59:17 -0000
</I>&gt;<i>  From: <A HREF="http://lists.nyphp.org/mailman/listinfo/talk">MAILER-DAEMON at myserver</A>
</I>&gt;<i>  To: <A HREF="http://lists.nyphp.org/mailman/listinfo/talk">root at myserver</A>
</I>&gt;<i>  Subject: failure notice
</I>&gt;<i>
</I>&gt;<i>  Hi. This is the qmail-send program at myserver.
</I>&gt;<i>  I'm afraid I wasn't able to deliver your message to the following
</I>&gt;<i> addresses.
</I>&gt;<i>  This is a permanent error; I've given up. Sorry it didn't work out.
</I>&gt;<i>
</I>&gt;<i>  &lt;the recipient&gt;:
</I>&gt;<i>  IPADDRESS does not like recipient.
</I>&gt;<i>  Remote host said: 550 &lt;the recipient&gt; is not a valid mailbox
</I>&gt;<i>  Giving up on IPADDRESS
</I>&gt;<i>
</I>&gt;<i>  --- Below this line is a copy of the message.
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>  Now, I need to extract the file name, the date, the recipient and the error
</I>&gt;<i> onto a database to check which addresses have bounced and why.
</I>&gt;<i>
</I>&gt;<i>  Anybody has some ideas on how I can do that?
</I>&gt;<i>  I looked on the net and the php manual and found some disparate tentatives
</I>&gt;<i> but no solid solution when we are not using an xml file.
</I>&gt;<i>
</I>&gt;<i>  TIA
</I>&gt;<i> --
</I>&gt;<i> Alberto dos Santos
</I>&gt;<i> Consultor em TI
</I>&gt;<i> IT Consultant
</I>&gt;<i>
</I>
If your script handles these as individual emails, then you could use
PEAR's MIME parser or one of the imap functions to parse the headers.

Otherwise, well, each message can be converted to an array of lines
using explode(). Each line of the headers starts with a label. Then
there's a blank line, and then the message body itself.

Liberal use of strpos(), substr(), etc. should be all you need. Maybe
some preg_match() if the regular string functions aren't quite enough.



--
Chris Snyder
<A HREF="http://chxo.com/">http://chxo.com/</A>
</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="017721.html">[nycphp-talk] Text file to MySQL entries
</A></li>
	<LI>Next message: <A HREF="017731.html">[nycphp-talk] Text file to MySQL entries
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#17730">[ date ]</a>
              <a href="thread.html#17730">[ thread ]</a>
              <a href="subject.html#17730">[ subject ]</a>
              <a href="author.html#17730">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.nyphp.org/mailman/listinfo/talk">More information about the talk
mailing list</a><br>
</body></html>
