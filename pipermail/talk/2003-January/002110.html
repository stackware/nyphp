<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-51353372-3"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-51353372-3');
</script>
   <TITLE> [PHP] Cannot show reuploaded image file on page unless manual refresh
   </TITLE>
   <LINK REL="Index" HREF="http://nyphp.org/pipermail/talk/2003-January/index.html" >
   <LINK REL="made" HREF="mailto:talk%40lists.nyphp.org?Subject=Re:%20Re%3A%20%5BPHP%5D%20Cannot%20show%20reuploaded%20image%20file%20on%20page%20unless%20manual%20refresh&In-Reply-To=%3C20030120220329.16223.qmail%40web14304.mail.yahoo.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="002109.html">
   <LINK REL="Next"  HREF="002114.html">
 <meta name="description" content="PHP jobs stackware web application support and development forums for Mongo LAMP MySQL SQL Windows IIS Linux." />
<meta name="author" content="Stackware Web Development - http://stackware.com" />
<meta name="verify-v1" content="zWMoPwMn/dolscLkjLXTpRqgr9K8bzlzL1vM9WTjpHc=" />
<meta name="msvalidate.01" content="F85F81C1D0BAB5C349E8395628845E27" />
<meta name="y_key" content="265502be3db4fb6e" />
</HEAD>
         <BODY BGCOLOR="#ffffff">
<h1 style="float: right; margin: 0; padding: 0 0 0 15px;"><a href="https://www.meetup.com/new-york-php/">NYCPHP Meetup</a></h1><h1><a href="http://www.nyphp.org">NYPHP.org</a></h1>
   <H1>[PHP] Cannot show reuploaded image file on page unless manual refresh</H1>
    <B>Chris Shiflett</B> 
    <A HREF="mailto:talk%40lists.nyphp.org?Subject=Re:%20Re%3A%20%5BPHP%5D%20Cannot%20show%20reuploaded%20image%20file%20on%20page%20unless%20manual%20refresh&In-Reply-To=%3C20030120220329.16223.qmail%40web14304.mail.yahoo.com%3E"
       TITLE="[PHP] Cannot show reuploaded image file on page unless manual refresh">shiflett at php.net
       </A><BR>
    <I>Mon Jan 20 17:03:29 EST 2003</I>
    <P><UL>
        <LI>Previous message: <A HREF="002109.html">Cannot show reuploaded image file on page unless manual refresh
</A></li>
        <LI>Next message: <A HREF="002114.html">[PHP] Cannot show reuploaded image file on page unless manual refresh
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#2110">[ date ]</a>
              <a href="thread.html#2110">[ thread ]</a>
              <a href="subject.html#2110">[ subject ]</a>
              <a href="author.html#2110">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>--- Phil Powell &lt;<A HREF="http://lists.nyphp.org/mailman/listinfo/talk">soazine at erols.com</A>&gt; wrote:
&gt;<i> I am using the following header() functions to force
</I>&gt;<i> view.php to not cache:
</I>&gt;<i> 
</I>&gt;<i> header(&quot;Expires: Mon, 26 Jul 1997 05:00:00 GMT&quot;);
</I>&gt;<i> header(&quot;Last-Modified: &quot; . gmdate(&quot;D, d M Y H:i:s&quot;) .
</I>&gt;<i> &quot; GMT&quot;);
</I>&gt;<i> header(&quot;Cache-Control: no-store, no-cache,
</I>&gt;<i> must-revalidate&quot;);
</I>&gt;<i> header(&quot;Cache-Control: post-check=0, pre-check=0&quot;,
</I>&gt;<i> false);
</I>&gt;<i> header(&quot;Pragma: no-cache&quot;);
</I>
:<i>-)
</I>
I think you killed it.

&gt;<i> However, when a user reuploads a file in manage.php, it
</I>&gt;<i> does a form post onto manage.php and reuploads the file
</I>&gt;<i> (which I verified works).  However, when redirected via
</I>&gt;<i> header() to view.php, they still see their OLD image
</I>&gt;<i> file, NOT the new one!  Unless I manually refresh the
</I>&gt;<i> page, they never see it, until they manually refresh the
</I>&gt;<i> page, then the new image file appears!
</I>
Right.

I think you are forgetting that the image is not really
part of the PHP resource. Meaning, this is the series of
events for a PHP script that refernces a single image
called bar.jpg using the &lt;img&gt; tag:

1. HTTP request sent for foo.php (Web client -&gt; Web server)
2. HTTP response sent that includes the output of foo.php
   (Web server -&gt; Web client)
3. Web client (browser) notices &lt;img&gt; tag referenced in
   the HTML.
4. HTTP request sent for bar.jpg (Web client -&gt; Web server)
5. HTTP response sent that includes bar.jpg

So, the headers that you are setting only matter for the
resource returned in step 2. Meaning, the HTML output of
foo.php is not cached. The image, since it is returned by
the Web server and not your PHP script, is cached.

Chris

</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="002109.html">Cannot show reuploaded image file on page unless manual refresh
</A></li>
	<LI>Next message: <A HREF="002114.html">[PHP] Cannot show reuploaded image file on page unless manual refresh
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#2110">[ date ]</a>
              <a href="thread.html#2110">[ thread ]</a>
              <a href="subject.html#2110">[ subject ]</a>
              <a href="author.html#2110">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.nyphp.org/mailman/listinfo/talk">More information about the talk
mailing list</a><br>
</body></html>
