<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-51353372-3"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-51353372-3');
</script>
   <TITLE> [nycphp-talk] Better Way to Secure HTML Forms with Hash Tokens?
   </TITLE>
   <LINK REL="Index" HREF="http://nyphp.org/pipermail/talk/2014-June/index.html" >
   <LINK REL="made" HREF="mailto:talk%40lists.nyphp.org?Subject=Re:%20Re%3A%20%5Bnyphp-talk%5D%20Better%20Way%20to%20Secure%20HTML%20Forms%20with%20Hash%20Tokens%3F&In-Reply-To=%3CCAGMFw4jYZKz9LAN8t_fn6XOLT_62hFozNu4Ed8ANyi3o9yFQ8g%40mail.gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="031967.html">
   <LINK REL="Next"  HREF="031971.html">
 <meta name="description" content="PHP jobs stackware web application support and development forums for Mongo LAMP MySQL SQL Windows IIS Linux." />
<meta name="author" content="Stackware Web Development - http://stackware.com" />
<meta name="verify-v1" content="zWMoPwMn/dolscLkjLXTpRqgr9K8bzlzL1vM9WTjpHc=" />
<meta name="msvalidate.01" content="F85F81C1D0BAB5C349E8395628845E27" />
<meta name="y_key" content="265502be3db4fb6e" />
</HEAD>
         <BODY BGCOLOR="#ffffff">
<h1 style="float: right; margin: 0; padding: 0 0 0 15px;"><a href="https://www.meetup.com/new-york-php/">NYCPHP Meetup</a></h1><h1><a href="http://www.nyphp.org">NYPHP.org</a></h1>
   <H1>[nycphp-talk] Better Way to Secure HTML Forms with Hash Tokens?</H1>
    <B>Michael B Allen</B> 
    <A HREF="mailto:talk%40lists.nyphp.org?Subject=Re:%20Re%3A%20%5Bnyphp-talk%5D%20Better%20Way%20to%20Secure%20HTML%20Forms%20with%20Hash%20Tokens%3F&In-Reply-To=%3CCAGMFw4jYZKz9LAN8t_fn6XOLT_62hFozNu4Ed8ANyi3o9yFQ8g%40mail.gmail.com%3E"
       TITLE="[nycphp-talk] Better Way to Secure HTML Forms with Hash Tokens?">ioplex at gmail.com
       </A><BR>
    <I>Tue Jun 24 00:08:40 EDT 2014</I>
    <P><UL>
        <LI>Previous message: <A HREF="031967.html">[nycphp-talk] Relax your password rules
</A></li>
        <LI>Next message: <A HREF="031971.html">[nycphp-talk] Better Way to Secure HTML Forms with Hash Tokens?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#31970">[ date ]</a>
              <a href="thread.html#31970">[ thread ]</a>
              <a href="subject.html#31970">[ subject ]</a>
              <a href="author.html#31970">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hey,

I've always used hash tokens in forms to sanity check POST requests.
Meaning a random hash is generated on the server which is both stored
in the session and emitted in a hidden field in the form so that when
the form is submitted the server can remove it from the session and
check it against the hash sumbitted with the form. If the client
doesn't submit the one-time-token, there is no action taken.

Just from Googling around it seems that this is fairly common, if not
standard practice (Windows calls them &quot;AntiForgeryToken&quot;s). I found
one claim that this actually thwarts CSRF and XSS although it seems to
me that an attacker could use an async request to get a valid token
before it submits the CSRF request. So I'm wondering if there is a
better way.

Specifically, my question is, is there anything about the legitimate
request that would be reproducably different from the attacker's
request (even though it was from the same browser instance - just not
a page generated by the legit site) that could then be factored into
the hash on the server?

So does anyone have a clever technique they want to share (perhaps privately)?

Mike

-- 
Michael B Allen
<A HREF="http://www.ioplex.com/">http://www.ioplex.com/</A>
</PRE>


<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="031967.html">[nycphp-talk] Relax your password rules
</A></li>
	<LI>Next message: <A HREF="031971.html">[nycphp-talk] Better Way to Secure HTML Forms with Hash Tokens?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#31970">[ date ]</a>
              <a href="thread.html#31970">[ thread ]</a>
              <a href="subject.html#31970">[ subject ]</a>
              <a href="author.html#31970">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.nyphp.org/mailman/listinfo/talk">More information about the talk
mailing list</a><br>
</body></html>
