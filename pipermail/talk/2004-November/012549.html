<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-51353372-3"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-51353372-3');
</script>
   <TITLE> [nycphp-talk] lazy initialization woes
   </TITLE>
   <LINK REL="Index" HREF="http://nyphp.org/pipermail/talk/2004-November/index.html" >
   <LINK REL="made" HREF="mailto:talk%40lists.nyphp.org?Subject=Re:%20Re%3A%20%5Bnyphp-talk%5D%20lazy%20initialization%20woes&In-Reply-To=%3C4FC7F25A-337C-11D9-8B36-000D932DF2B4%40sneer.org%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="012548.html">
   <LINK REL="Next"  HREF="012550.html">
 <meta name="description" content="PHP jobs stackware web application support and development forums for Mongo LAMP MySQL SQL Windows IIS Linux." />
<meta name="author" content="Stackware Web Development - http://stackware.com" />
<meta name="verify-v1" content="zWMoPwMn/dolscLkjLXTpRqgr9K8bzlzL1vM9WTjpHc=" />
<meta name="msvalidate.01" content="F85F81C1D0BAB5C349E8395628845E27" />
<meta name="y_key" content="265502be3db4fb6e" />
</HEAD>
         <BODY BGCOLOR="#ffffff">
<h1 style="float: right; margin: 0; padding: 0 0 0 15px;"><a href="https://www.meetup.com/new-york-php/">NYCPHP Meetup</a></h1><h1><a href="http://www.nyphp.org">NYPHP.org</a></h1>
   <H1>[nycphp-talk] lazy initialization woes</H1>
    <B>Jason Perkins</B> 
    <A HREF="mailto:talk%40lists.nyphp.org?Subject=Re:%20Re%3A%20%5Bnyphp-talk%5D%20lazy%20initialization%20woes&In-Reply-To=%3C4FC7F25A-337C-11D9-8B36-000D932DF2B4%40sneer.org%3E"
       TITLE="[nycphp-talk] lazy initialization woes">jperkins at sneer.org
       </A><BR>
    <I>Wed Nov 10 19:54:59 EST 2004</I>
    <P><UL>
        <LI>Previous message: <A HREF="012548.html">[nycphp-talk] MySQL modelling tool (as seen in PHPArch?)
</A></li>
        <LI>Next message: <A HREF="012550.html">[nycphp-talk] lazy initialization woes
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#12549">[ date ]</a>
              <a href="thread.html#12549">[ thread ]</a>
              <a href="subject.html#12549">[ subject ]</a>
              <a href="author.html#12549">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>I'm working on a project in PHP with the hopes of releasing it if I can 
get it off of the ground and I've ran into a problem that I'm hoping 
someone can lend a hand with. The basic notion is that a given object 
will potentially contain other objects, but these contained objects 
aren't known (or generated) until runtime.

For example, we'll instantiate a sales_order object and then, using its 
has_a() method, add a customer object to it. To prevent cascades of 
objects being instantiated, I'd plan to use lazy initialization - the 
customer object won't be instantiated until the first time that it's 
accessed through the customer class. The problem that I'm having is 
that lazy initialization in PHP 5 is accomplished via the __get() 
method which is called when an attribute (or contained class in this) 
isn't available - it's passed the name of the property that wasn't 
found and that's not enough information for me to return the attribute 
of the contained object that was being accessed. Here's some quickly 
written code with extra code stripped that'll demonstrate what I mean:

&lt;?

class sales_order {
     ...

   public function has_a( $class ) {
     $this-&gt;relationships[ $class ] = 'has_a';
   }

   public function __get( $class ) {
     if(array_key_exists( $class, $this-&gt;relationships )) {
       if( $this-&gt;relationships[ $class ] == 'has_a') {
         $this-&gt;$class  = new $class( $this-&gt;id );
         return;
       }
     }
   }
}

So if $attribute exists in the relationships array, it's instantiated 
(and, yeah, I plan to move the contained objects into a declared array. 
one thing at a time :) )

$sales_order = new sales_order;
$sales_order-&gt;has_a( customer );
print $sales_order-&gt;customer-&gt;name;

The last line fails, because __get is passed only 'customer' and not 
'customer-&gt;name' - I have no way of knowing what attribute of customer 
was being accessed, so I can't return the requested data. Running this 
code:

$sales_order = new sales_order;
$sales_order-&gt;has_a( customer );
print $sales_order-&gt;customer-&gt;name;
print $sales_order-&gt;customer-&gt;name;

the fourth line works, because the customer object was instantiated 
during line three (line three still fails to return a value). Does 
anyone have any suggestions on how to get this working?

Apologies in advance for the verbosity of this email, I really did try 
to strip out as much as I could.

thanks!


--
Jason N Perkins


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="012548.html">[nycphp-talk] MySQL modelling tool (as seen in PHPArch?)
</A></li>
	<LI>Next message: <A HREF="012550.html">[nycphp-talk] lazy initialization woes
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#12549">[ date ]</a>
              <a href="thread.html#12549">[ thread ]</a>
              <a href="subject.html#12549">[ subject ]</a>
              <a href="author.html#12549">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.nyphp.org/mailman/listinfo/talk">More information about the talk
mailing list</a><br>
</body></html>
