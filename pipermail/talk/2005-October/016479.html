<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-51353372-3"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-51353372-3');
</script>
   <TITLE> [nycphp-talk] getting my head around heirarchical structures
   </TITLE>
   <LINK REL="Index" HREF="http://nyphp.org/pipermail/talk/2005-October/index.html" >
   <LINK REL="made" HREF="mailto:talk%40lists.nyphp.org?Subject=Re:%20Re%3A%20%5Bnyphp-talk%5D%20getting%20my%20head%20around%20heirarchical%20structures&In-Reply-To=%3C40741.38.117.147.25.1130595047.squirrel%4038.117.147.25%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="016477.html">
   <LINK REL="Next"  HREF="016476.html">
 <meta name="description" content="PHP jobs stackware web application support and development forums for Mongo LAMP MySQL SQL Windows IIS Linux." />
<meta name="author" content="Stackware Web Development - http://stackware.com" />
<meta name="verify-v1" content="zWMoPwMn/dolscLkjLXTpRqgr9K8bzlzL1vM9WTjpHc=" />
<meta name="msvalidate.01" content="F85F81C1D0BAB5C349E8395628845E27" />
<meta name="y_key" content="265502be3db4fb6e" />
</HEAD>
         <BODY BGCOLOR="#ffffff">
<h1 style="float: right; margin: 0; padding: 0 0 0 15px;"><a href="https://www.meetup.com/new-york-php/">NYCPHP Meetup</a></h1><h1><a href="http://www.nyphp.org">NYPHP.org</a></h1>
   <H1>[nycphp-talk] getting my head around heirarchical structures</H1>
    <B>Kenneth Downs</B> 
    <A HREF="mailto:talk%40lists.nyphp.org?Subject=Re:%20Re%3A%20%5Bnyphp-talk%5D%20getting%20my%20head%20around%20heirarchical%20structures&In-Reply-To=%3C40741.38.117.147.25.1130595047.squirrel%4038.117.147.25%3E"
       TITLE="[nycphp-talk] getting my head around heirarchical structures">ken at secdat.com
       </A><BR>
    <I>Sat Oct 29 10:10:47 EDT 2005</I>
    <P><UL>
        <LI>Previous message: <A HREF="016477.html">[nycphp-talk] getting my head around heirarchical structures
</A></li>
        <LI>Next message: <A HREF="016476.html">[nycphp-talk] getting my head around heirarchical structures
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#16479">[ date ]</a>
              <a href="thread.html#16479">[ thread ]</a>
              <a href="subject.html#16479">[ subject ]</a>
              <a href="author.html#16479">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Allen,

This is an interesting thread you have started.  I have some suggestions
to add to the thoughts already expressed.

A very big design decision at the start is whether you will support the
validation of the &quot;criteria&quot; values before attempting to execute the
query.  Leaving out the validation makes it simpler to handle the overall
organization, but then the error messages given to users will be SQL
messages that they may or may not be able to figure out.  If you make it
possible to validate the expressions yourself then you can control the
error messages.

One suggestion I would make is that each filter be given a name instead of
an ID, and possibly let the user choose the name.  Then the filters behave
like functions.  This makes nesting more intuitive.  So I can put two
filters into your table:

OVER18 =&gt; 'Age &gt;= 18'
NATIVE =&gt; 'State_where_born = State_where_lives'

Then build up complex functions through composition, so that I can have
this function:

NAT_18 =&gt; OVER18 &amp;&amp; NATIVE

This requires your table to be set up a little differently, but will give
you complete expressive power.

A query is then really a separate thing, not stored in the same table as
the filters.  A query needs to know a table, a list of columns, and a list
of functions.  If your queries can also pull from other queries in JOIN
and UNION then you have a generalized report writer.  If you have a very
sophisticated data dictionary then your report writer can even figure out
when to JOIN and when to UNION.




&gt;<i> All this heirarchical structure talk happens to come up as I'm trying to
</I>&gt;<i> implement a data filtering scheme for an ad-hoc querying interface.
</I>&gt;<i> Basically I want to allow queries as complex as the user wants -- not
</I>&gt;<i> just on one or two fields at a time -- so this has to be open-ended, and
</I>&gt;<i> it seems to be pointing me to a heirarchical structure.  I think I've
</I>&gt;<i> found something that will work, but I wonder a) if I'm just reinventing
</I>&gt;<i> the wheel somehow, and b) if I should go with this, am I doing it right?
</I>&gt;<i>
</I>&gt;<i> Here goes (in English as simple as my gabby self can make it):
</I>&gt;<i>
</I>&gt;<i> We store all the filters using a table with these fields:
</I>&gt;<i> CREATE TABLE `filters` (
</I>&gt;<i>   `filterid` int(11),
</I>&gt;<i>   `parentid` int(11), -- keys to filterid
</I>&gt;<i>   `booltype` enum('and','or'),
</I>&gt;<i>   `criteria` varchar(255),
</I>&gt;<i>   PRIMARY KEY  (`filterid`)
</I>&gt;<i> );
</I>&gt;<i> And then we start filling it with filters. Any 'parent' filter doesn't
</I>&gt;<i> store a `criteria` for itself, just the `booltype` value for all its
</I>&gt;<i> children.
</I>&gt;<i>
</I>&gt;<i> INSERT INTO `filters` (`filterid`, `parentid`, `booltype`, `criteria`)
</I>&gt;<i> VALUES (1, NULL, 'and', NULL);
</I>&gt;<i> INSERT INTO `filters` (`filterid`, `parentid`, `booltype`, `criteria`)
</I>&gt;<i> VALUES (2, 1, NULL, 'hair=''brown''');
</I>&gt;<i> INSERT INTO `filters` (`filterid`, `parentid`, `booltype`, `criteria`)
</I>&gt;<i> VALUES (3, 1, NULL, 'age=''32''');
</I>&gt;<i> INSERT INTO `filters` (`filterid`, `parentid`, `booltype`, `criteria`)
</I>&gt;<i> VALUES (4, 1, 'or', NULL);
</I>&gt;<i> INSERT INTO `filters` (`filterid`, `parentid`, `booltype`, `criteria`)
</I>&gt;<i> VALUES (5, 4, NULL, 'city=''boston''');
</I>&gt;<i> INSERT INTO `filters` (`filterid`, `parentid`, `booltype`, `criteria`)
</I>&gt;<i> VALUES (6, 4, NULL, 'city=''houston''');
</I>&gt;<i>
</I>&gt;<i> So this way I get parent filter 1 joining its children 2, 3 and 4 with
</I>&gt;<i> an 'and' operator; 4 itself also is a parent of 5 and 6, which it joins
</I>&gt;<i> with an 'or' operator.  The result is a filter that says:    hair =
</I>&gt;<i> 'brown' and age='32' and (city='boston' or city='houston')
</I>&gt;<i>
</I>&gt;<i> This seems open-ended enough to be very flexible, and it makes sense to
</I>&gt;<i> my feeble brain, but is there a better way to do it?
</I>&gt;<i>
</I>&gt;<i> - Allen
</I>&gt;<i>
</I>&gt;<i> --
</I>&gt;<i> Allen Shaw
</I>&gt;<i> Polymer (<A HREF="http://polymerdb.org">http://polymerdb.org</A>)
</I>&gt;<i>
</I>&gt;<i> _______________________________________________
</I>&gt;<i> New York PHP Talk Mailing List
</I>&gt;<i> AMP Technology
</I>&gt;<i> Supporting Apache, MySQL and PHP
</I>&gt;<i> <A HREF="http://lists.nyphp.org/mailman/listinfo/talk">http://lists.nyphp.org/mailman/listinfo/talk</A>
</I>&gt;<i> <A HREF="http://www.nyphp.org">http://www.nyphp.org</A>
</I>&gt;<i>
</I>

-- 
Kenneth Downs
Secure Data Software
631-379-0010
<A HREF="http://lists.nyphp.org/mailman/listinfo/talk">ken at secdat.com</A>
PO Box 708
East Setauket, NY 11733


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="016477.html">[nycphp-talk] getting my head around heirarchical structures
</A></li>
	<LI>Next message: <A HREF="016476.html">[nycphp-talk] getting my head around heirarchical structures
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#16479">[ date ]</a>
              <a href="thread.html#16479">[ thread ]</a>
              <a href="subject.html#16479">[ subject ]</a>
              <a href="author.html#16479">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.nyphp.org/mailman/listinfo/talk">More information about the talk
mailing list</a><br>
</body></html>
