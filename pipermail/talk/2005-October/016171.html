<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-51353372-3"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-51353372-3');
</script>
   <TITLE> [nycphp-talk] data modelling vs. db design (was: ER Diagram tool	for MySQL/OS X)
   </TITLE>
   <LINK REL="Index" HREF="http://nyphp.org/pipermail/talk/2005-October/index.html" >
   <LINK REL="made" HREF="mailto:talk%40lists.nyphp.org?Subject=Re:%20Re%3A%20%5Bnyphp-talk%5D%20data%20modelling%20vs.%20db%20design%20%28was%3A%20ER%20Diagram%20tool%0A%09for%20MySQL/OS%20X%29&In-Reply-To=%3C87e6ded30510040946s701ccf5fn45bc1753e84f8fa3%40mail.gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="016170.html">
   <LINK REL="Next"  HREF="016175.html">
 <meta name="description" content="PHP jobs stackware web application support and development forums for Mongo LAMP MySQL SQL Windows IIS Linux." />
<meta name="author" content="Stackware Web Development - http://stackware.com" />
<meta name="verify-v1" content="zWMoPwMn/dolscLkjLXTpRqgr9K8bzlzL1vM9WTjpHc=" />
<meta name="msvalidate.01" content="F85F81C1D0BAB5C349E8395628845E27" />
<meta name="y_key" content="265502be3db4fb6e" />
</HEAD>
         <BODY BGCOLOR="#ffffff">
<h1 style="float: right; margin: 0; padding: 0 0 0 15px;"><a href="https://www.meetup.com/new-york-php/">NYCPHP Meetup</a></h1><h1><a href="http://www.nyphp.org">NYPHP.org</a></h1>
   <H1>[nycphp-talk] data modelling vs. db design (was: ER Diagram tool	for MySQL/OS X)</H1>
    <B>max goldberg</B> 
    <A HREF="mailto:talk%40lists.nyphp.org?Subject=Re:%20Re%3A%20%5Bnyphp-talk%5D%20data%20modelling%20vs.%20db%20design%20%28was%3A%20ER%20Diagram%20tool%0A%09for%20MySQL/OS%20X%29&In-Reply-To=%3C87e6ded30510040946s701ccf5fn45bc1753e84f8fa3%40mail.gmail.com%3E"
       TITLE="[nycphp-talk] data modelling vs. db design (was: ER Diagram tool	for MySQL/OS X)">max.goldberg at gmail.com
       </A><BR>
    <I>Tue Oct  4 12:46:55 EDT 2005</I>
    <P><UL>
        <LI>Previous message: <A HREF="016170.html">[nycphp-talk] data modelling vs. db design (was: ER Diagram tool	for MySQL/OS X)
</A></li>
        <LI>Next message: <A HREF="016175.html">[nycphp-talk] data modelling vs. db design (was: ER Diagram tool for MySQL/OS X)
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#16171">[ date ]</a>
              <a href="thread.html#16171">[ thread ]</a>
              <a href="subject.html#16171">[ subject ]</a>
              <a href="author.html#16171">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>I'm actually running into the point of an application where my completely
normalized database design is just killing my database server. It was fine
during the first few months of my site being up but as my traffic grew, it
really began to take a toll. The first thing I had to do was move from
MyISAM to InnoDB, due to the huge number of locks causing the site to just
screech to a halt. On average I am getting around 5000 hits per minute to
the PHP pages that connect to the database. During the &quot;slow&quot; time at 7am, I
get around 2500. I've managed to lower my average queries per second from
300 to 220, but normalization is still killing me.

This makes doing any sort of database maintenance fairly difficult. InnoDB
has helped a lot, I have a dedicated DB server, but one query that has to
copy to a temp table on each page view means almost certain death. My
temporary solution to this has been to create &quot;digest&quot; tables which are more
or less 5-10 table joins that get refreshed every X minutes via cron. This
obviously causes caching problems as data isn't up to the second, and it
seems like a pain to write code around using this &quot;hack&quot; to make my
application work as it should.

I've considered using InnoDB's cascading update/delete function to keep my
digest tables up to date without a cron job, but I want to play with it more
before I just launch into it. I am starting to wonder how much of this is
just my lack of expertise in database administration and how much is just a
fundamental flaw with normalized database design. Is it possible to have a
large scale production database with a fully normalized design without
extremely expensive hardware?

It seems like it would be worth the extra overhead to keep behind-the-scenes
digest tables of commonly joined tables, is this something that higher end
databases (ie. oracle) do?

-Max

On 10/4/05, Russ Demarest &lt;<A HREF="http://lists.nyphp.org/mailman/listinfo/talk">rsd at electronink.com</A>&gt; wrote:
&gt;<i>
</I>&gt;<i> Another consideration is how you are using the addresses and the
</I>&gt;<i> users. For example if you are going to be joining users with other
</I>&gt;<i> tables then trying to determine which of those users also have an
</I>&gt;<i> address in NY the queries can beat on your server. How many users
</I>&gt;<i> will you have? What with the addresses be used for? Will you need to
</I>&gt;<i> search all addresses for each user related to other tables?
</I>&gt;<i>
</I>&gt;<i> From a data point of view you would normalize it all and I would
</I>&gt;<i> suggest a states and countries table to be linked to addresses as a
</I>&gt;<i> well as address type. But when you are trying to come up with all the
</I>&gt;<i> users with a address in NY who are related to other tables, i.e.
</I>&gt;<i> groups, you may wish you have it all in one table.
</I>&gt;<i>
</I>&gt;<i> If you get really &quot;normal&quot; you could have a &quot;user_addresses&quot; table
</I>&gt;<i> which would contain the address_type field so if you have 2 users at
</I>&gt;<i> the same address the address would only be in the address table once
</I>&gt;<i> but related to both users. :)
</I>&gt;<i>
</I>&gt;<i> Don't get me started if you need to track history. &quot;Where did user X
</I>&gt;<i> live at home 2 years ago?&quot;. Then you have a start_date and end_date
</I>&gt;<i> in the user_addresses.
</I>&gt;<i>
</I>&gt;<i> I have done it both ways and there really is not a clear winner,
</I>&gt;<i> depends on the situation. I am glad I am not tracking user address
</I>&gt;<i> history any more,
</I>&gt;<i>
</I>&gt;<i> Good luck
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> On Oct 4, 2005, at 11:53 AM, Allen Shaw wrote:
</I>&gt;<i>
</I>&gt;<i> &gt; Stephen Musgrave wrote:
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;&gt; This is an interesting topic because I'm approaching a question based
</I>&gt;<i> &gt;&gt; upon this principal. There is an application that I am building
</I>&gt;<i> &gt;&gt; where
</I>&gt;<i> &gt;&gt; the User record can have 5 addresses (home address, work address,
</I>&gt;<i> &gt;&gt; permanent address, international address, etc, etc). I'm considering
</I>&gt;<i> &gt;&gt; making a table called UserAddress and then linking it to address ID
</I>&gt;<i> &gt;&gt; fields in the User table. I'm on the fence about it because while I
</I>&gt;<i> &gt;&gt; don't want a monstrous User table with tons of columns, I also don't
</I>&gt;<i> &gt;&gt; want to over normalize.
</I>&gt;<i> &gt;&gt;
</I>&gt;<i> &gt;&gt;
</I>&gt;<i> &gt;&gt;
</I>&gt;<i> &gt; Here's a great working example to explore the issue. I would let the
</I>&gt;<i> &gt; User table contain no address info, and then let the UserAddress table
</I>&gt;<i> &gt; contain one address per row with an extra column for UserID. This
</I>&gt;<i> &gt; seems
</I>&gt;<i> &gt; like a clear one-to-many relationship between a person and his/her
</I>&gt;<i> &gt; many
</I>&gt;<i> &gt; addresses (also assuming it could be any number between 0 and 5,
</I>&gt;<i> &gt; right?), so adding 5 sets of columns to the User table doesn't seem
</I>&gt;<i> &gt; right...
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; Honestly, the only reason I'm writing here is so someone can
</I>&gt;<i> &gt; correct me
</I>&gt;<i> &gt; if I'm wrong (and if I'm right then this might actually helping
</I>&gt;<i> &gt; somebody
</I>&gt;<i> &gt; -- neat-o ...).
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; --
</I>&gt;<i> &gt; Allen Shaw
</I>&gt;<i> &gt; Polymer (<A HREF="http://polymerdb.org">http://polymerdb.org</A>)
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; _______________________________________________
</I>&gt;<i> &gt; New York PHP Talk Mailing List
</I>&gt;<i> &gt; AMP Technology
</I>&gt;<i> &gt; Supporting Apache, MySQL and PHP
</I>&gt;<i> &gt; <A HREF="http://lists.nyphp.org/mailman/listinfo/talk">http://lists.nyphp.org/mailman/listinfo/talk</A>
</I>&gt;<i> &gt; <A HREF="http://www.nyphp.org">http://www.nyphp.org</A>
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;
</I>&gt;<i>
</I>&gt;<i> _______________________________________________
</I>&gt;<i> New York PHP Talk Mailing List
</I>&gt;<i> AMP Technology
</I>&gt;<i> Supporting Apache, MySQL and PHP
</I>&gt;<i> <A HREF="http://lists.nyphp.org/mailman/listinfo/talk">http://lists.nyphp.org/mailman/listinfo/talk</A>
</I>&gt;<i> <A HREF="http://www.nyphp.org">http://www.nyphp.org</A>
</I>&gt;<i>
</I>-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.nyphp.org/pipermail/talk/attachments/20051004/1605a50d/attachment.html">http://lists.nyphp.org/pipermail/talk/attachments/20051004/1605a50d/attachment.html</A>&gt;
</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="016170.html">[nycphp-talk] data modelling vs. db design (was: ER Diagram tool	for MySQL/OS X)
</A></li>
	<LI>Next message: <A HREF="016175.html">[nycphp-talk] data modelling vs. db design (was: ER Diagram tool for MySQL/OS X)
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#16171">[ date ]</a>
              <a href="thread.html#16171">[ thread ]</a>
              <a href="subject.html#16171">[ subject ]</a>
              <a href="author.html#16171">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.nyphp.org/mailman/listinfo/talk">More information about the talk
mailing list</a><br>
</body></html>
