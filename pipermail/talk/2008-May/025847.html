<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-51353372-3"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-51353372-3');
</script>
   <TITLE> [nycphp-talk] protecting download directory in PHP app on Unix box?
   </TITLE>
   <LINK REL="Index" HREF="http://nyphp.org/pipermail/talk/2008-May/index.html" >
   <LINK REL="made" HREF="mailto:talk%40lists.nyphp.org?Subject=Re:%20Re%3A%20%5Bnyphp-talk%5D%20protecting%20download%20directory%20in%20PHP%20app%20on%20Unix%20box%3F&In-Reply-To=%3C78c6bd860805280939w25f54b2bucf8bbfbe388508c6%40mail.gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="025840.html">
   <LINK REL="Next"  HREF="025841.html">
 <meta name="description" content="PHP jobs stackware web application support and development forums for Mongo LAMP MySQL SQL Windows IIS Linux." />
<meta name="author" content="Stackware Web Development - http://stackware.com" />
<meta name="verify-v1" content="zWMoPwMn/dolscLkjLXTpRqgr9K8bzlzL1vM9WTjpHc=" />
<meta name="msvalidate.01" content="F85F81C1D0BAB5C349E8395628845E27" />
<meta name="y_key" content="265502be3db4fb6e" />
</HEAD>
         <BODY BGCOLOR="#ffffff">
<h1 style="float: right; margin: 0; padding: 0 0 0 15px;"><a href="https://www.meetup.com/new-york-php/">NYCPHP Meetup</a></h1><h1><a href="http://www.nyphp.org">NYPHP.org</a></h1>
   <H1>[nycphp-talk] protecting download directory in PHP app on Unix box?</H1>
    <B>Michael B Allen</B> 
    <A HREF="mailto:talk%40lists.nyphp.org?Subject=Re:%20Re%3A%20%5Bnyphp-talk%5D%20protecting%20download%20directory%20in%20PHP%20app%20on%20Unix%20box%3F&In-Reply-To=%3C78c6bd860805280939w25f54b2bucf8bbfbe388508c6%40mail.gmail.com%3E"
       TITLE="[nycphp-talk] protecting download directory in PHP app on Unix box?">ioplex at gmail.com
       </A><BR>
    <I>Wed May 28 12:39:37 EDT 2008</I>
    <P><UL>
        <LI>Previous message: <A HREF="025840.html">[nycphp-talk] protecting download directory in PHP app on Unix box?
</A></li>
        <LI>Next message: <A HREF="025841.html">[nycphp-talk] protecting download directory in PHP app on Unix box?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#25847">[ date ]</a>
              <a href="thread.html#25847">[ thread ]</a>
              <a href="subject.html#25847">[ subject ]</a>
              <a href="author.html#25847">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On Wed, May 28, 2008 at 11:25 AM, Kristina Anderson
&lt;<A HREF="http://lists.nyphp.org/mailman/listinfo/talk">ka at kacomputerconsulting.com</A>&gt; wrote:
&gt;<i> This might be off topic as well...but I have a PHP app that submits to
</I>&gt;<i> Paypal and then on the &quot;thank you&quot; page, I provide a link to a PDF that
</I>&gt;<i> they bought.
</I>&gt;<i>
</I>&gt;<i> The server is Unix based, and before submitting the sale, I collect
</I>&gt;<i> various information about the user, and then when the transaction is
</I>&gt;<i> complete, I get a unique transaction ID from Paypal.
</I>&gt;<i>
</I>&gt;<i> What's the easiest, quickest way to provide some level of complexity to
</I>&gt;<i> the downloads so that people can't just go back into the directory and
</I>&gt;<i> download every PDF without paying?  It doesn't have to be 100% secure
</I>&gt;<i> but should be secure enough to keep out &quot;most&quot; people.
</I>&gt;<i>
</I>&gt;<i> I've been looking into .htaccess but wondering if that's overkill and
</I>&gt;<i> there isn't some way to authenticate against my DB information before
</I>&gt;<i> allowing the download?
</I>
Hi Kristina,

If you want to allow static downloads (meaning the user directly links
to the file) then your options are fairly limited. Apache might offer
some kind of connection based controls but I'm not aware of anything
that would be applicable. If you allow user's static access to files,
in general, anyone can access any files. About the only thing you
could do with static downloads is make the filename or part of the
path name unique to the user or their session. Meaning you could
create a subdirectory based on the user's username or the session ID
and then place the file or a link to the file in that directory. Then
you could have a cron that deletes directories older than a certain
time.

If you can do scripted downloads (meaning PHP is interpreting the
request and writing the file contents to the client) then your access
control options increase significantly. With script level access
control you can of course check the user's information in the database
to determine definitively if they are permitted access to the
particular file.

Or you could use a combination of both static and scripted access. For
example, you could scramble your filenames using a reversible
transformation such as using mcrypt_{encrypt,decrypt}. Store your
files using the scrambled names. Send the user a link with the
scrambled name. Then when they request the file, de-scramble the name
so that you can send a Content-Disposition header with the friendly
filename.

Of course there are many permutations of this. It really depends on
your specific needs and constraints.

Mike

-- 
Michael B Allen
PHP Active Directory SPNEGO SSO
<A HREF="http://www.ioplex.com/">http://www.ioplex.com/</A>

</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="025840.html">[nycphp-talk] protecting download directory in PHP app on Unix box?
</A></li>
	<LI>Next message: <A HREF="025841.html">[nycphp-talk] protecting download directory in PHP app on Unix box?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#25847">[ date ]</a>
              <a href="thread.html#25847">[ thread ]</a>
              <a href="subject.html#25847">[ subject ]</a>
              <a href="author.html#25847">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.nyphp.org/mailman/listinfo/talk">More information about the talk
mailing list</a><br>
</body></html>
