<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-51353372-3"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-51353372-3');
</script>
   <TITLE> [nycphp-talk] [OT] mySql targeted by worm
   </TITLE>
   <LINK REL="Index" HREF="http://nyphp.org/pipermail/talk/2005-January/index.html" >
   <LINK REL="made" HREF="mailto:talk%40lists.nyphp.org?Subject=Re:%20Re%3A%20%5Bnyphp-talk%5D%20%5BOT%5D%20mySql%20targeted%20by%20worm&In-Reply-To=%3C27915-55598%40sneakemail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="013450.html">
   <LINK REL="Next"  HREF="013453.html">
 <meta name="description" content="PHP jobs stackware web application support and development forums for Mongo LAMP MySQL SQL Windows IIS Linux." />
<meta name="author" content="Stackware Web Development - http://stackware.com" />
<meta name="verify-v1" content="zWMoPwMn/dolscLkjLXTpRqgr9K8bzlzL1vM9WTjpHc=" />
<meta name="msvalidate.01" content="F85F81C1D0BAB5C349E8395628845E27" />
<meta name="y_key" content="265502be3db4fb6e" />
</HEAD>
         <BODY BGCOLOR="#ffffff">
<h1 style="float: right; margin: 0; padding: 0 0 0 15px;"><a href="https://www.meetup.com/new-york-php/">NYCPHP Meetup</a></h1><h1><a href="http://www.nyphp.org">NYPHP.org</a></h1>
   <H1>[nycphp-talk] [OT] mySql targeted by worm</H1>
    <B>inforequest</B> 
    <A HREF="mailto:talk%40lists.nyphp.org?Subject=Re:%20Re%3A%20%5Bnyphp-talk%5D%20%5BOT%5D%20mySql%20targeted%20by%20worm&In-Reply-To=%3C27915-55598%40sneakemail.com%3E"
       TITLE="[nycphp-talk] [OT] mySql targeted by worm">1j0lkq002 at sneakemail.com
       </A><BR>
    <I>Fri Jan 28 13:39:45 EST 2005</I>
    <P><UL>
        <LI>Previous message: <A HREF="013450.html">[nycphp-talk] The speed of a program
</A></li>
        <LI>Next message: <A HREF="013453.html">[nycphp-talk] [OT] mySql targeted by worm
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#13452">[ date ]</a>
              <a href="thread.html#13452">[ thread ]</a>
              <a href="subject.html#13452">[ subject ]</a>
              <a href="author.html#13452">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>In case it hasn't been mentioned:

mysql on windows targeted by worm:

<A HREF="http://isc.sans.org/diary.php?date=2005-01-27&amp;isc=811c8d08470e11fdb8efdabfe5bee079">http://isc.sans.org/diary.php?date=2005-01-27&amp;isc=811c8d08470e11fdb8efdabfe5bee079</A>


quoted:

A &quot;bot&quot;, exploiting vulnerable MySQL installs on Windows systems, has 
been spotted. It infected a few thousand systems so far. Like typical 
for bots, infected systems will connect to an IRC server. The IRC server 
will instruct them to scan various /8 networks for other vulnerable 
mysql servers.

*Infection Method*

The bot uses the &quot;MySQL UDF Dynamic Library Exploit&quot;. In order to launch 
the exploit, the bot first has to authenticate to mysql as 'root' user. 
A long list of passwords is included with the bot, and the bot will 
brute force the password.

Once connected, the bot will create a table called 'bla' using the 
database 'mysql'. The 'mysql' database is typically used to store 
administrative information like passwords, and is part of every mysql 
install. The only field in this database is a BLOB named 'line'.

Once the table is created, the executable is written into the table 
using an insert statement. Then, the content of is written to a file 
called 'app_result.dll' using 'select * from bla into dumpfile 
&quot;app_result.dll&quot;'. The 'bla' table is dropped once the file is created.

In order to execute the 'app_result.dll', the bot creates a mysql 
function called 'app_result' which uses the 'app_result.dll' file saved 
earlier. This function is executed, and as a result the bot is loaded 
and run.

*Post Infection Behavior*

The bot will now try to connect to one out of a number of IRC servers:
dummylandingzone.hn.org -&gt; 212.105.105.214

this have been disabled by respective dynamic dns providers(thanks!!):
landingzone.ath.cx -&gt; 212.105.105.214
dummylandingzone.dyndns.org -&gt; no such name
landingzone.dynamic-ip.us -&gt; was: 212.105.105.214
dummylandingzone.dns2go.com -&gt; 63.64.164.91 and 63.149.6.91
dummylandingzone.hn.org -&gt; 212.105.105.214
dummylandingzone.dynu.com -&gt; 212.105.105.214
zmoker.dns2go.com -&gt; 63.64.164.91
landingzone.dynu.com -&gt; was: 212.105.105.214
dummylandingzone.ipupdater.com -&gt; 212.105.105.214

The bot will connect to the IRC server on port 5002 or 5003. At this 
point, the IRC servers appear busy and unable to accept new connections. 
Note that dynamic DNS services are used. The IP addresses will likely 
change. Last time we where able to connect, about 8,500 hosts where 
connected to the IRC server.

The bot will connect to a channel called '#rampenstampen' using the key 
'gratisporn'. The topic of the channel is set to '!adv.start mysql 80 10 
0 132.x.x.x -a -r -s'. This will instruct the bot to scan random ips in 
'132.0.0.0/8' for mysql server. Throughout our observation, the topic 
was changed regularly. To be scanned networks included 10.0.0.0/8, 
likely an attempt to infect other mysql servers within a local network 
that is otherwise protected by a firewall.

So far, the bot has been identified as a version of 'Wootbot'. It 
appears to include the usual set of bot features like a DDOS engine, 
various scanners, commands to solicit information from infected systems 
(e.g. system stats, software registration keys and such). The bot 
provides an FTP server, and a backdoors (details later. Appears to be 
listening on port 2301/tcp and 2304/tcp, maybe other ports).



</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="013450.html">[nycphp-talk] The speed of a program
</A></li>
	<LI>Next message: <A HREF="013453.html">[nycphp-talk] [OT] mySql targeted by worm
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#13452">[ date ]</a>
              <a href="thread.html#13452">[ thread ]</a>
              <a href="subject.html#13452">[ subject ]</a>
              <a href="author.html#13452">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.nyphp.org/mailman/listinfo/talk">More information about the talk
mailing list</a><br>
</body></html>
