<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-51353372-3"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-51353372-3');
</script>
   <TITLE> [nycphp-talk] [OT] number of files in a directory?
   </TITLE>
   <LINK REL="Index" HREF="http://nyphp.org/pipermail/talk/2006-January/index.html" >
   <LINK REL="made" HREF="mailto:talk%40lists.nyphp.org?Subject=Re:%20Re%3A%20%5Bnyphp-talk%5D%20%5BOT%5D%20number%20of%20files%20in%20a%20directory%3F&In-Reply-To=%3Cop.s2qkb3po6dyt8l%40aum1.aum.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="017144.html">
   <LINK REL="Next"  HREF="017147.html">
 <meta name="description" content="PHP jobs stackware web application support and development forums for Mongo LAMP MySQL SQL Windows IIS Linux." />
<meta name="author" content="Stackware Web Development - http://stackware.com" />
<meta name="verify-v1" content="zWMoPwMn/dolscLkjLXTpRqgr9K8bzlzL1vM9WTjpHc=" />
<meta name="msvalidate.01" content="F85F81C1D0BAB5C349E8395628845E27" />
<meta name="y_key" content="265502be3db4fb6e" />
</HEAD>
         <BODY BGCOLOR="#ffffff">
<h1 style="float: right; margin: 0; padding: 0 0 0 15px;"><a href="https://www.meetup.com/new-york-php/">NYCPHP Meetup</a></h1><h1><a href="http://www.nyphp.org">NYPHP.org</a></h1>
   <H1>[nycphp-talk] [OT] number of files in a directory?</H1>
    <B>Anirudh Zala</B> 
    <A HREF="mailto:talk%40lists.nyphp.org?Subject=Re:%20Re%3A%20%5Bnyphp-talk%5D%20%5BOT%5D%20number%20of%20files%20in%20a%20directory%3F&In-Reply-To=%3Cop.s2qkb3po6dyt8l%40aum1.aum.com%3E"
       TITLE="[nycphp-talk] [OT] number of files in a directory?">arzala at gmail.com
       </A><BR>
    <I>Mon Jan  2 00:32:17 EST 2006</I>
    <P><UL>
        <LI>Previous message: <A HREF="017144.html">[nycphp-talk] [OT] number of files in a directory?
</A></li>
        <LI>Next message: <A HREF="017147.html">[nycphp-talk] [OT] number of files in a directory?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#17145">[ date ]</a>
              <a href="thread.html#17145">[ thread ]</a>
              <a href="subject.html#17145">[ subject ]</a>
              <a href="author.html#17145">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi,

# First of all, do not use word [OT] while discussing such important issues here, because this kind of problems/queries can be part of any programming environment. Seeing [OT] as subject of your query, will reduce chance of your replies upto 50%.

# Anwyay straight to your point:

=&gt; Never, as per my thinking, use only 1 location to store all your images or dynamic contents. Because it increases chance of serving your images slower, and it enhances threat of stealing them from your website without your information.

=&gt; Another thing from your usage point of view is that: Storing all images at only 1 place will slow down serving your images to users, because I am sure you will have usage of php functions like &quot;is_file&quot; or &quot;file_exists&quot; in your script to check whether images actually exists or not before showing them to users. Reason is that when you have almost 100, 000 images at 1 place then above function will take lot of time then scanning 1000 or 5000 images if you store 1000 images in 100 folders approx.

=&gt; Hence split number of images to be stored in each directory by 1000 or so, or consider usage of PRODUCT ID etc. i.e if you have 100 products, then strcture of your directory system will look like below.

\.....
	\images

		\1
			\RECORDID_SOME&gt;10CHARACTERHASH.EXT (i.e 123456_aswe34567bg.jpg)
		\2
			\RECORDID_SOME&gt;10CHARACTERHASH.EXT (i.e 7890_aswertgyuionjui.jpg)
		\3
			\.......
		\4
			\.......
		....

=&gt; As above strcture says; under your main images folder &quot;images&quot;, create folder according to &quot;PRODUCT ID&quot; and store images of number records by &quot;RECORDID_SOME&gt;10DIGITHASH.EXT&quot;. In your table/s of records, you will have unique &quot;RECORDID&quot; for your each record. We also need &gt; 10 character hash as suffix of your images, so that stealers can not ever guess how many images you have in particular folder and if they want to hoover it by automatic script, they can't find what and where to search. But make sure that you will have approx 1000 to 5000 images in each product folder (i.e 1,2,3 etc). If you think number of images will exceed than that, then use slightly different strcuture, like factors of 100s. i.e 1_100, 101_200, 201_300 etc. But make sure that RECORDIF must fall in between factor of 100s i.e if your image name is like &quot;7890_aswertgyuionjui.jpg&quot; them it should go under &quot;7801_7900&quot; folder only.

=&gt; Also disable Directory Index of main image folder &quot;images&quot; so that your server will not expose your whole directory structure  to anyone who tries to access that folder directly from browser. Instead, server will generate error 403 (access forbidden).

=&gt; Please note that by above implementation, do not worry if number of folder reaches &gt; 1000, but numebr of files must be smaller or almost same in each folder, because going into any of 1000 folder and displaying any image from there is far more faster, when server is Linux as you said earlier, than displaying same image from haystack of 1000 X 1000 images.

=&gt; Another suggestion is, if your website is going to have faster movement of records like at a time only 50000 records are active but millions of records are sold or inactive and your vistors/users are surfing with those 50000 records mainly, then split location of images into 2 categories like &quot;images&quot; and &quot;sold_images&quot; so that total number of images in your active images will not exceed certain number, and your website will give consistent performance even if number of records or visitors are increasing.

# Other extra suggestions:

=&gt; If you are using NAS using technologies like NFS etc. then beware of using function like &quot;is_dir&quot; or &quot;file_exists&quot; or any other funcion which check existance of file/folder. So try to avoid using those functions when you have lot of images or folders are to be first checked and only then to be displayed while storing those images on NAS. Because checking above items on same hard drive is very much faster than checking on remote drive.

=&gt; When you have lot of images are to be served, then Bandwidth becomes important issue to be taken into account. Because images can not almost be compressed while sending them to browser for display. Hence they will use full bandiwdth that it needs. In this situation, if you do not need those images to be printed, keep resolution of images upto 72 only, because images to be shown on monitor can be displayed well with 72 resolution than for printing. By this way you can save lot of disk space. But if you need to offer those images for printing as well then you will need to keep 2 versions of images, however only if you have enough storage capacity, 1: for showing in browser only with resolution of 72 and 2: for printing with higher resolution that you require..

=&gt; Finally, of course, &quot;Keep your city clean&quot;. So design a backend script that can match number of records in your database and images required for that. So if records are not there in your db, then no need to keep those images.

Hope these guidelines will help you in solving most of your queries for image storing.


Thanks,

Anirudh Zala


On Sun, 01 Jan 2006 06:23:38 +0530, Marc Antony Vose &lt;<A HREF="http://lists.nyphp.org/mailman/listinfo/talk">suzerain at suzerain.com</A>&gt; wrote:

&gt;<i> Hey all:
</I>&gt;<i>
</I>&gt;<i> First of all:  Happy New Year!
</I>&gt;<i>
</I>&gt;<i> Secondly: I am rebuilding a site that was coded somewhat sloppily,
</I>&gt;<i> and they have product images all stored in one directory (a script
</I>&gt;<i> that I am not writing auto-uploads them to the web server from
</I>&gt;<i> elsewhere).  Presently, this directory contains about 33,000 files.
</I>&gt;<i> It will be more like 75,000 when the site launches, if things remain
</I>&gt;<i> the same.
</I>&gt;<i>
</I>&gt;<i> The question is:  should I be worried about this, or was this only a
</I>&gt;<i> problem several years ago? (I remember people at one time attempting
</I>&gt;<i> to not put too many files in one place.)
</I>&gt;<i>
</I>&gt;<i> If I should be worried, what could happen?  Will we ever reach a hard
</I>&gt;<i> limit of files per directory?
</I>&gt;<i>
</I>&gt;<i> Is it better if each product instead has its own directory inside
</I>&gt;<i> there (i.e., 75,000 directories), each with as many files as we need
</I>&gt;<i> inside, or is that just the same problem?
</I>&gt;<i>
</I>&gt;<i> Cheers,
</I>&gt;<i>
</I>


-- 
-----------------------------------------------------
Anirudh Zala (Production Manager)
ASPL, <A HREF="http://www.aspl.in">http://www.aspl.in</A>
Ph: +91 281 245 1894
arzala at gmail.com
-----------------------------------------------------

</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="017144.html">[nycphp-talk] [OT] number of files in a directory?
</A></li>
	<LI>Next message: <A HREF="017147.html">[nycphp-talk] [OT] number of files in a directory?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#17145">[ date ]</a>
              <a href="thread.html#17145">[ thread ]</a>
              <a href="subject.html#17145">[ subject ]</a>
              <a href="author.html#17145">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.nyphp.org/mailman/listinfo/talk">More information about the talk
mailing list</a><br>
</body></html>
