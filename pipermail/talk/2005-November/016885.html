<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-51353372-3"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-51353372-3');
</script>
   <TITLE> [nycphp-talk] Double Loading PHP as  image - Firefox or PHP?
   </TITLE>
   <LINK REL="Index" HREF="http://nyphp.org/pipermail/talk/2005-November/index.html" >
   <LINK REL="made" HREF="mailto:talk%40lists.nyphp.org?Subject=Re:%20Re%3A%20%5Bnyphp-talk%5D%20Double%20Loading%20PHP%20as%20%20image%20-%20Firefox%20or%20PHP%3F&In-Reply-To=%3C020a01c5f607%245dae38b0%246500a8c0%40enobrev%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="016884.html">
   <LINK REL="Next"  HREF="016887.html">
 <meta name="description" content="PHP jobs stackware web application support and development forums for Mongo LAMP MySQL SQL Windows IIS Linux." />
<meta name="author" content="Stackware Web Development - http://stackware.com" />
<meta name="verify-v1" content="zWMoPwMn/dolscLkjLXTpRqgr9K8bzlzL1vM9WTjpHc=" />
<meta name="msvalidate.01" content="F85F81C1D0BAB5C349E8395628845E27" />
<meta name="y_key" content="265502be3db4fb6e" />
</HEAD>
         <BODY BGCOLOR="#ffffff">
<h1 style="float: right; margin: 0; padding: 0 0 0 15px;"><a href="https://www.meetup.com/new-york-php/">NYCPHP Meetup</a></h1><h1><a href="http://www.nyphp.org">NYPHP.org</a></h1>
   <H1>[nycphp-talk] Double Loading PHP as  image - Firefox or PHP?</H1>
    <B>Mark Armendariz</B> 
    <A HREF="mailto:talk%40lists.nyphp.org?Subject=Re:%20Re%3A%20%5Bnyphp-talk%5D%20Double%20Loading%20PHP%20as%20%20image%20-%20Firefox%20or%20PHP%3F&In-Reply-To=%3C020a01c5f607%245dae38b0%246500a8c0%40enobrev%3E"
       TITLE="[nycphp-talk] Double Loading PHP as  image - Firefox or PHP?">nyphp at enobrev.com
       </A><BR>
    <I>Wed Nov 30 18:39:54 EST 2005</I>
    <P><UL>
        <LI>Previous message: <A HREF="016884.html">[nycphp-talk] PHP vs. new ASP.NET 2.0
</A></li>
        <LI>Next message: <A HREF="016887.html">[nycphp-talk] Double Loading PHP as  image - Firefox or PHP?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#16885">[ date ]</a>
              <a href="thread.html#16885">[ thread ]</a>
              <a href="subject.html#16885">[ subject ]</a>
              <a href="author.html#16885">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>I have a hit counter script that I've been growing in the back yard for a
few months.  I decided to go back and water it today, just after upgrading
to the latest Firefox release (1.5) and while testing I noticed an oddity...
 
Now, the basics of how the script works.  You call count.php as an image
from your site (&lt;img src=&quot;count.php&quot; /&gt;), it adds the hit (and other
wonderful data) to the db and then outputs a 1 px transparent gif.  There's
more to it with js and all kinds of fun stuff, but that has NOTHING to do
with this particular problem...
 
While testing other browsers (IE, FF 1.07, Opera, etc - all pc), Everything
was working great, but with firefox 1.5, I was getting 2 hits every time.  I
removed the image code, and It would hit once.  Put it back... Twice.
 
I combed through my code, found nothing and decided, what the hell, take my
code out... And so here's what's left - nice and simple:

--------------
count.php
--------------
&lt;?php
    require_once 'function.file_put_contents.php';    // PHP5 magic in good
ol' 4
    file_put_contents('./output.txt', date('m/d/Y G:i:s') . ': ' .
$_SERVER['HTTP_USER_AGENT'] . &quot;\n&quot;);
        
    header('Content-Type: image/gif');
    header('Content-Disposition: inline; filename=count.gif'); 
    readfile ('./count.gif');
?&gt;
--------------
 
And when I load count.php into the browser, I get this:
- the first one is FF 1.0.7
- the second is IE whatever (latest from windows update)
- the third and fourth are one load from FF 1.5
- the 5th and 6th are a single refresh on FF 1.5
--------------
output.txt
--------------
11/30/2005 15:26:46: Mozilla/5.0 (Windows; U; Windows NT 5.1; en-US;
rv:1.7.12) Gecko/20050915 Firefox/1.0.7
11/30/2005 15:27:00: Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1; SV1;
.NET CLR 1.1.4322; .NET CLR 2.0.50727; InfoPath.1)
11/30/2005 15:27:04: Mozilla/5.0 (Windows; U; Windows NT 5.1; en-US; rv:1.8)
Gecko/20051111 Firefox/1.5
11/30/2005 15:27:04: Mozilla/5.0 (Windows; U; Windows NT 5.1; en-US; rv:1.8)
Gecko/20051111 Firefox/1.5
11/30/2005 15:32:34: Mozilla/5.0 (Windows; U; Windows NT 5.1; en-US; rv:1.8)
Gecko/20051111 Firefox/1.5
11/30/2005 15:32:35: Mozilla/5.0 (Windows; U; Windows NT 5.1; en-US; rv:1.8)
Gecko/20051111 Firefox/1.5
--------------

So, since it's a brand new version of FF, and my test code's too damned slim
to find anything 'off', AND, with all other browsers I've tested - getting
one hit per load, I'm beginning to figure this to be a bug/feature of the
latest greatest FF.  But before I begin barking up that tree, I wanted to
ask the local gurus if my headers are whacky (I've tried a few combos, this
one's just the shortest - and the original, which I've had for months), or
if for some reason browsers are supposed to do this and they all just
haven't been.

In the end, I figure I'll have to try caching the image for a second or two
and hopefully that'll calm FF's load-crazy ways.  But oh how wrong it would
feel to do so.

Happy belated Turkeys...

Thanks!!!

Mark Armendariz


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="016884.html">[nycphp-talk] PHP vs. new ASP.NET 2.0
</A></li>
	<LI>Next message: <A HREF="016887.html">[nycphp-talk] Double Loading PHP as  image - Firefox or PHP?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#16885">[ date ]</a>
              <a href="thread.html#16885">[ thread ]</a>
              <a href="subject.html#16885">[ subject ]</a>
              <a href="author.html#16885">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.nyphp.org/mailman/listinfo/talk">More information about the talk
mailing list</a><br>
</body></html>
