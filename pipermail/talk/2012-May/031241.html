<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-51353372-3"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-51353372-3');
</script>
   <TITLE> [nycphp-talk] Database Abstraction / ORM
   </TITLE>
   <LINK REL="Index" HREF="http://nyphp.org/pipermail/talk/2012-May/index.html" >
   <LINK REL="made" HREF="mailto:talk%40lists.nyphp.org?Subject=Re:%20Re%3A%20%5Bnyphp-talk%5D%20Database%20Abstraction%20/%20ORM&In-Reply-To=%3CCAFp73Xu5JYZrDkPLEOjF9JcOFxH8GQ82ufGAn%3D2W0stQD732uw%40mail.gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="031239.html">
   <LINK REL="Next"  HREF="031237.html">
 <meta name="description" content="PHP jobs stackware web application support and development forums for Mongo LAMP MySQL SQL Windows IIS Linux." />
<meta name="author" content="Stackware Web Development - http://stackware.com" />
<meta name="verify-v1" content="zWMoPwMn/dolscLkjLXTpRqgr9K8bzlzL1vM9WTjpHc=" />
<meta name="msvalidate.01" content="F85F81C1D0BAB5C349E8395628845E27" />
<meta name="y_key" content="265502be3db4fb6e" />
</HEAD>
         <BODY BGCOLOR="#ffffff">
<h1 style="float: right; margin: 0; padding: 0 0 0 15px;"><a href="https://www.meetup.com/new-york-php/">NYCPHP Meetup</a></h1><h1><a href="http://www.nyphp.org">NYPHP.org</a></h1>
   <H1>[nycphp-talk] Database Abstraction / ORM</H1>
    <B>guilhermeblanco at gmail.com</B> 
    <A HREF="mailto:talk%40lists.nyphp.org?Subject=Re:%20Re%3A%20%5Bnyphp-talk%5D%20Database%20Abstraction%20/%20ORM&In-Reply-To=%3CCAFp73Xu5JYZrDkPLEOjF9JcOFxH8GQ82ufGAn%3D2W0stQD732uw%40mail.gmail.com%3E"
       TITLE="[nycphp-talk] Database Abstraction / ORM">guilhermeblanco at gmail.com
       </A><BR>
    <I>Wed May  9 23:18:13 EDT 2012</I>
    <P><UL>
        <LI>Previous message: <A HREF="031239.html">[nycphp-talk] Database Abstraction / ORM
</A></li>
        <LI>Next message: <A HREF="031237.html">[nycphp-talk] Database Abstraction / ORM
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#31241">[ date ]</a>
              <a href="thread.html#31241">[ thread ]</a>
              <a href="subject.html#31241">[ subject ]</a>
              <a href="author.html#31241">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi Anthony,

It's great to see PHP contributors around. =)
Comments inline.

On Mon, May 7, 2012 at 10:13 AM, Anthony Ferrara &lt;<A HREF="http://lists.nyphp.org/mailman/listinfo/talk">ircmaxell at gmail.com</A>&gt; wrote:
&gt;<i> Hey Justin,
</I>&gt;<i>
</I>&gt;<i> Replies inline;
</I>&gt;<i>
</I>&gt;<i> On Mon, May 7, 2012 at 8:16 AM, Justin Demaris &lt;<A HREF="http://lists.nyphp.org/mailman/listinfo/talk">justin.demaris at gmail.com</A>&gt; wrote:
</I>&gt;&gt;<i> Hello PHP Talkers,
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> How do you guys feel about ORM systems and other database abstraction
</I>&gt;&gt;<i> layers?
</I>&gt;<i>
</I>&gt;<i> Personally, I do not like them. &#160;I find that the ORM layers
</I>&gt;<i> specifically violate SRP (Single Responsibility Principle) and are
</I>&gt;<i> usually not worth while. &#160;Instead, I prefer a light weight Data Mapper
</I>&gt;<i> layer ( <A HREF="http://martinfowler.com/eaaCatalog/dataMapper.html">http://martinfowler.com/eaaCatalog/dataMapper.html</A> ). &#160;I
</I>&gt;<i> usually hard-code SQL in the mapper, but you *could* use an ORM there.
</I>&gt;<i> &#160;But the key is to keep it completely separated from the business
</I>&gt;<i> objects. &#160;That way your data model is free to evolve independently
</I>&gt;<i> from your business objects...
</I>&gt;<i>
</I>&gt;&gt;<i> Is there any ORM system out there
</I>&gt;&gt;<i> that just does it right? Namely, I'd be looking for things like:
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> 1) When I instantiate an object by it's ID multiple times, it doesn't bother
</I>&gt;&gt;<i> to hit up the database after the first time, but just keeps giving me copies
</I>&gt;&gt;<i> of the same object
</I>&gt;<i>
</I>&gt;<i> Well, do you really want this all of the time? &#160;I can see cases where
</I>&gt;<i> you do want to re-query the database (especially in sensitive
</I>&gt;<i> areas)...
</I>
Any good ORM relies on a UnitOfWork.
Under this concept, you can tell it to &quot;forget&quot; about a certain object
or &quot;know&quot; about an object.
Based on that, both perspectives you mentioned are support.

&gt;<i>
</I>&gt;&gt;<i> 2) Lazy load the object values. There are a number of patterns where I've
</I>&gt;&gt;<i> seen people instantiate a bunch of objects and then only use a small subset
</I>&gt;&gt;<i> of them. It would be nice if the object only loaded the data when we try to
</I>&gt;&gt;<i> reference one of its non-ID properties.
</I>&gt;<i>
</I>&gt;<i> Why? &#160;Your business objects should have all the data they need at
</I>&gt;<i> creation time. &#160;Otherwise you can wind up in the situation where
</I>&gt;<i> objects representing the same state have different states. &#160;Which is
</I>&gt;<i> not a good thing...
</I>
As I mentioned in the other email, any good ORM tool should deal with
Proxies/References.
If you want to load, or only load partially, you should have this ability.
I disagree with Anthony that is bad. That's the biggest principle to
avoid (and also to cause if misused) the N+1 problem insanely referred
by beginners or ORM haters.

&gt;<i>
</I>&gt;&gt;<i> 3) Ability to tweak the back end to work with other database systems
</I>&gt;&gt;<i> (especially Riak, Mongo and Cassandra)
</I>&gt;<i>
</I>&gt;<i> Unless you're building a project that you want to distribute to
</I>&gt;<i> others, I find this a bad feature. &#160;Sure, it's nice to know you can
</I>&gt;<i> switch to another storage with a config change. &#160;But practically, how
</I>&gt;<i> often do you do that? &#160;And if you do that, you're going to want to
</I>&gt;<i> tune your data model specifically towards the strengths of the target
</I>&gt;<i> backend. &#160;Otherwise you're constantly stuck with a sub-optimal
</I>&gt;<i> solution, and little way out when you need to scale...
</I>
I disagree with you, unfortunately.
The time needed for certain operations using certain DB drivers may be
huge for functional testing purposes.
By tweaking your application environment, you can use sqlite:memory
for testing and mysql in prod, running the tests quicker.
I hate advertising too much, but unfortunately, PHP lacks so much of
good competitors of Doctrine. You can use ORM and ODM mappers and
almost swap one with the other and your application can still run
smoothly.

&gt;<i>
</I>&gt;&gt;<i> I have had really good luck in the past working with Yii and integrating
</I>&gt;&gt;<i> with Redis to use their Active Record structure, but I'm not sure of the
</I>&gt;&gt;<i> performance there. Also, I've been hearing a lot about Doctrine 2 lately and
</I>&gt;&gt;<i> the necessity of having an extra Data Mapper layer in the middle that
</I>&gt;&gt;<i> separates the classes and properties from the fields and tables that store
</I>&gt;&gt;<i> the data.
</I>&gt;<i>
</I>&gt;<i> That mapper layer is a good thing... &#160;It allows both to vary
</I>&gt;<i> independently of each other. &#160;Which avoids un-needed coupling between
</I>&gt;<i> the layers.
</I>&gt;<i>
</I>&gt;<i> As far as Doctrine 2 goes, IMHO it's the best layer out there. &#160;I use
</I>&gt;<i> it when I have projects that dictate requirements that it helps fill.
</I>&gt;<i> But usually, I just use the database specific layer (MySQLi or
</I>&gt;<i> MongoDB).
</I>
There's a reason why you need a mapping layer.
Depending of your domain problem, you may want for example different
strategies for inheritance. There're 3 types available, but not all of
them are implemented by D2. Class Table Inheritance, Single Table
Inheritance and Concrete Table Inheritance. You can read more about
them at PoEAA of Martin Fowler's book. Each type has pros and cons.
Also, associations may map to a composite foreign-key, you also have
locking strategies to play, etc. All these things must be taken into
account and are not trivial to be done without a mapping layer.

&gt;<i>
</I>&gt;<i> I hope that helps,
</I>&gt;<i>
</I>&gt;<i> Anthony
</I>&gt;<i> _______________________________________________
</I>&gt;<i> New York PHP User Group Community Talk Mailing List
</I>&gt;<i> <A HREF="http://lists.nyphp.org/mailman/listinfo/talk">http://lists.nyphp.org/mailman/listinfo/talk</A>
</I>&gt;<i>
</I>&gt;<i> <A HREF="http://www.nyphp.org/show-participation">http://www.nyphp.org/show-participation</A>
</I>


-- 
Guilherme Blanco
MSN: <A HREF="http://lists.nyphp.org/mailman/listinfo/talk">guilhermeblanco at hotmail.com</A>
GTalk: guilhermeblanco
Toronto - ON/Canada

</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="031239.html">[nycphp-talk] Database Abstraction / ORM
</A></li>
	<LI>Next message: <A HREF="031237.html">[nycphp-talk] Database Abstraction / ORM
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#31241">[ date ]</a>
              <a href="thread.html#31241">[ thread ]</a>
              <a href="subject.html#31241">[ subject ]</a>
              <a href="author.html#31241">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.nyphp.org/mailman/listinfo/talk">More information about the talk
mailing list</a><br>
</body></html>
