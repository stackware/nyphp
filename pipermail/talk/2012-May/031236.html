<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-51353372-3"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-51353372-3');
</script>
   <TITLE> [nycphp-talk] Database Abstraction / ORM
   </TITLE>
   <LINK REL="Index" HREF="http://nyphp.org/pipermail/talk/2012-May/index.html" >
   <LINK REL="made" HREF="mailto:talk%40lists.nyphp.org?Subject=Re:%20Re%3A%20%5Bnyphp-talk%5D%20Database%20Abstraction%20/%20ORM&In-Reply-To=%3CCAMMfqL3fbok_-GeKpba4WZXfxCC2104H%2BAqMG32eG%3DQ5KwHSaw%40mail.gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="031235.html">
   <LINK REL="Next"  HREF="031238.html">
 <meta name="description" content="PHP jobs stackware web application support and development forums for Mongo LAMP MySQL SQL Windows IIS Linux." />
<meta name="author" content="Stackware Web Development - http://stackware.com" />
<meta name="verify-v1" content="zWMoPwMn/dolscLkjLXTpRqgr9K8bzlzL1vM9WTjpHc=" />
<meta name="msvalidate.01" content="F85F81C1D0BAB5C349E8395628845E27" />
<meta name="y_key" content="265502be3db4fb6e" />
</HEAD>
         <BODY BGCOLOR="#ffffff">
<h1 style="float: right; margin: 0; padding: 0 0 0 15px;"><a href="https://www.meetup.com/new-york-php/">NYCPHP Meetup</a></h1><h1><a href="http://www.nyphp.org">NYPHP.org</a></h1>
   <H1>[nycphp-talk] Database Abstraction / ORM</H1>
    <B>Justin Demaris</B> 
    <A HREF="mailto:talk%40lists.nyphp.org?Subject=Re:%20Re%3A%20%5Bnyphp-talk%5D%20Database%20Abstraction%20/%20ORM&In-Reply-To=%3CCAMMfqL3fbok_-GeKpba4WZXfxCC2104H%2BAqMG32eG%3DQ5KwHSaw%40mail.gmail.com%3E"
       TITLE="[nycphp-talk] Database Abstraction / ORM">justin.demaris at gmail.com
       </A><BR>
    <I>Mon May  7 10:35:42 EDT 2012</I>
    <P><UL>
        <LI>Previous message: <A HREF="031235.html">[nycphp-talk] Database Abstraction / ORM
</A></li>
        <LI>Next message: <A HREF="031238.html">[nycphp-talk] Database Abstraction / ORM
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#31236">[ date ]</a>
              <a href="thread.html#31236">[ thread ]</a>
              <a href="subject.html#31236">[ subject ]</a>
              <a href="author.html#31236">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Thank you for the thorough reply Anthony. My replies are also in line here:

On Mon, May 7, 2012 at 10:13 AM, Anthony Ferrara &lt;<A HREF="http://lists.nyphp.org/mailman/listinfo/talk">ircmaxell at gmail.com</A>&gt;wrote:

&gt;<i> Hey Justin,
</I>&gt;<i>
</I>&gt;<i> Replies inline;
</I>&gt;<i>
</I>&gt;<i> On Mon, May 7, 2012 at 8:16 AM, Justin Demaris &lt;<A HREF="http://lists.nyphp.org/mailman/listinfo/talk">justin.demaris at gmail.com</A>&gt;
</I>&gt;<i> wrote:
</I>&gt;<i> &gt; Hello PHP Talkers,
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; How do you guys feel about ORM systems and other database abstraction
</I>&gt;<i> &gt; layers?
</I>&gt;<i>
</I>&gt;<i> Personally, I do not like them.  I find that the ORM layers
</I>&gt;<i> specifically violate SRP (Single Responsibility Principle) and are
</I>&gt;<i> usually not worth while.  Instead, I prefer a light weight Data Mapper
</I>&gt;<i> layer ( <A HREF="http://martinfowler.com/eaaCatalog/dataMapper.html">http://martinfowler.com/eaaCatalog/dataMapper.html</A> ).  I
</I>&gt;<i> usually hard-code SQL in the mapper, but you *could* use an ORM there.
</I>&gt;<i>  But the key is to keep it completely separated from the business
</I>&gt;<i> objects.  That way your data model is free to evolve independently
</I>&gt;<i> from your business objects...
</I>&gt;<i>
</I>&gt;<i> &gt; Is there any ORM system out there
</I>&gt;<i> &gt; that just does it right? Namely, I'd be looking for things like:
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; 1) When I instantiate an object by it's ID multiple times, it doesn't
</I>&gt;<i> bother
</I>&gt;<i> &gt; to hit up the database after the first time, but just keeps giving me
</I>&gt;<i> copies
</I>&gt;<i> &gt; of the same object
</I>&gt;<i>
</I>&gt;<i> Well, do you really want this all of the time?  I can see cases where
</I>&gt;<i> you do want to re-query the database (especially in sensitive
</I>&gt;<i> areas)...
</I>&gt;<i>
</I>
My issue ends up being that we can't always expect everyone on the team
(it's a pretty large team) to deeply understand the proper way of doing
everything. I want this feature as a way to help prevent people from
shooting themselves in the foot, so yes, I do want this all of the time. I
have seen a lot of code that pretty much assumes the ORM objects are just
like any other variable and the objects can be instantiated very often to
make the logic of a for loop simpler.


&gt;<i>
</I>&gt;<i> &gt; 2) Lazy load the object values. There are a number of patterns where I've
</I>&gt;<i> &gt; seen people instantiate a bunch of objects and then only use a small
</I>&gt;<i> subset
</I>&gt;<i> &gt; of them. It would be nice if the object only loaded the data when we try
</I>&gt;<i> to
</I>&gt;<i> &gt; reference one of its non-ID properties.
</I>&gt;<i>
</I>&gt;<i> Why?  Your business objects should have all the data they need at
</I>&gt;<i> creation time.  Otherwise you can wind up in the situation where
</I>&gt;<i> objects representing the same state have different states.  Which is
</I>&gt;<i> not a good thing...
</I>&gt;<i>
</I>
See above. Retraining everyone is not an option, and I've seen a lot of
people assume that if they aren't accessing the data, then the object
should be a very cheap call and they instantiate it frivolously. We can all
argue that you need to know your platform in detail in order to really use
it right and it certain things will be better in optimal cases, but these
are the variables I have to work with. The other issue is that at small
scale, most of the time the performance is still quite acceptable, but as
the product grows and the scale grows, these cases become more obvious.
These kind of lazy loads enable me to pass objects around to functions that
may need them, but only incur the database hit if the function does end up
needing them.

At the same time, I do welcome best practice recommendations for myself and
for the rare cases when I get complete control of the architecture and
implementation :)


&gt;<i>
</I>&gt;<i> &gt; 3) Ability to tweak the back end to work with other database systems
</I>&gt;<i> &gt; (especially Riak, Mongo and Cassandra)
</I>&gt;<i>
</I>&gt;<i> Unless you're building a project that you want to distribute to
</I>&gt;<i> others, I find this a bad feature.  Sure, it's nice to know you can
</I>&gt;<i> switch to another storage with a config change.  But practically, how
</I>&gt;<i> often do you do that?  And if you do that, you're going to want to
</I>&gt;<i> tune your data model specifically towards the strengths of the target
</I>&gt;<i> backend.  Otherwise you're constantly stuck with a sub-optimal
</I>&gt;<i> solution, and little way out when you need to scale...
</I>&gt;<i>
</I>
This isn't so much something that I want to consider as &quot;completely
extensible&quot; or that I would want other people to extend my platform for.
This is because I actually use hybrid MySQL/Mongo/Redis, MySql/Cassandra,
and MySQL/Riak/Redis environments for my projects and I need it to work
that way now. If Doctrine is awesome for all things MySQL, but very painful
to work in Cassandra support, then it wouldn't be my choice for that
project. The fact that it has some Mongo support already is wonderful news!


&gt;<i>
</I>&gt;<i> &gt; I have had really good luck in the past working with Yii and integrating
</I>&gt;<i> &gt; with Redis to use their Active Record structure, but I'm not sure of the
</I>&gt;<i> &gt; performance there. Also, I've been hearing a lot about Doctrine 2 lately
</I>&gt;<i> and
</I>&gt;<i> &gt; the necessity of having an extra Data Mapper layer in the middle that
</I>&gt;<i> &gt; separates the classes and properties from the fields and tables that
</I>&gt;<i> store
</I>&gt;<i> &gt; the data.
</I>&gt;<i>
</I>&gt;<i> That mapper layer is a good thing...  It allows both to vary
</I>&gt;<i> independently of each other.  Which avoids un-needed coupling between
</I>&gt;<i> the layers.
</I>&gt;<i>
</I>&gt;<i> As far as Doctrine 2 goes, IMHO it's the best layer out there.  I use
</I>&gt;<i> it when I have projects that dictate requirements that it helps fill.
</I>&gt;<i> But usually, I just use the database specific layer (MySQLi or
</I>&gt;<i> MongoDB).
</I>&gt;<i>
</I>
When working with Mongo, do you just pass around the stdClass / array
representation of the document to do work on it? Do you do anything at the
code level to force a standard attribute list for it?


&gt;<i>
</I>&gt;<i> I hope that helps,
</I>&gt;<i>
</I>
That does help, quite a bit :-D thanks for the time spent on the reply.


&gt;<i>
</I>&gt;<i> Anthony
</I>&gt;<i> _______________________________________________
</I>&gt;<i> New York PHP User Group Community Talk Mailing List
</I>&gt;<i> <A HREF="http://lists.nyphp.org/mailman/listinfo/talk">http://lists.nyphp.org/mailman/listinfo/talk</A>
</I>&gt;<i>
</I>&gt;<i> <A HREF="http://www.nyphp.org/show-participation">http://www.nyphp.org/show-participation</A>
</I>&gt;<i>
</I>-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.nyphp.org/pipermail/talk/attachments/20120507/cf2ebc68/attachment.html">http://lists.nyphp.org/pipermail/talk/attachments/20120507/cf2ebc68/attachment.html</A>&gt;
</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="031235.html">[nycphp-talk] Database Abstraction / ORM
</A></li>
	<LI>Next message: <A HREF="031238.html">[nycphp-talk] Database Abstraction / ORM
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#31236">[ date ]</a>
              <a href="thread.html#31236">[ thread ]</a>
              <a href="subject.html#31236">[ subject ]</a>
              <a href="author.html#31236">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.nyphp.org/mailman/listinfo/talk">More information about the talk
mailing list</a><br>
</body></html>
