<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-51353372-3"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-51353372-3');
</script>
   <TITLE> [nycphp-talk] memory problems
   </TITLE>
   <LINK REL="Index" HREF="http://nyphp.org/pipermail/talk/2009-June/index.html" >
   <LINK REL="made" HREF="mailto:talk%40lists.nyphp.org?Subject=Re:%20Re%3A%20%5Bnyphp-talk%5D%20memory%20problems&In-Reply-To=%3C6434C666-7A89-4DFB-BADD-53F12BF562DD%40insite-out.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="028217.html">
   <LINK REL="Next"  HREF="028220.html">
 <meta name="description" content="PHP jobs stackware web application support and development forums for Mongo LAMP MySQL SQL Windows IIS Linux." />
<meta name="author" content="Stackware Web Development - http://stackware.com" />
<meta name="verify-v1" content="zWMoPwMn/dolscLkjLXTpRqgr9K8bzlzL1vM9WTjpHc=" />
<meta name="msvalidate.01" content="F85F81C1D0BAB5C349E8395628845E27" />
<meta name="y_key" content="265502be3db4fb6e" />
</HEAD>
         <BODY BGCOLOR="#ffffff">
<h1 style="float: right; margin: 0; padding: 0 0 0 15px;"><a href="https://www.meetup.com/new-york-php/">NYCPHP Meetup</a></h1><h1><a href="http://www.nyphp.org">NYPHP.org</a></h1>
   <H1>[nycphp-talk] memory problems</H1>
    <B>Rahmin Pavlovic</B> 
    <A HREF="mailto:talk%40lists.nyphp.org?Subject=Re:%20Re%3A%20%5Bnyphp-talk%5D%20memory%20problems&In-Reply-To=%3C6434C666-7A89-4DFB-BADD-53F12BF562DD%40insite-out.com%3E"
       TITLE="[nycphp-talk] memory problems">rahmin at insite-out.com
       </A><BR>
    <I>Thu Jun  4 11:48:40 EDT 2009</I>
    <P><UL>
        <LI>Previous message: <A HREF="028217.html">[nycphp-talk] Periodic Browsercam.com group availability
</A></li>
        <LI>Next message: <A HREF="028220.html">[nycphp-talk] memory problems
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#28219">[ date ]</a>
              <a href="thread.html#28219">[ thread ]</a>
              <a href="subject.html#28219">[ subject ]</a>
              <a href="author.html#28219">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Heya,

So, I have this script that does the following:

1.  Requests jpeg from origin CDN via cURL
2.  If file doesnt exist... log error, continue.
3.  Write jpeg to temp file
4.  Resize original image (GD lib) to temp file. FTP to directory on  
new CDN.  Create directory structure if not present.  Repeat seven  
times per image.

Not sure how many, but we're talking about 10k; maybe 15k images.

The script works, but problem we're running into is the memory limit.   
We got about 31% through the images, and hit:

PHP Fatal error: Allowed memory size of 524288000 bytes exhausted  
(tried to allocate 41760 bytes) in /web/lib/php/populate_images.php on  
line 135

Maybe it's me, but if we have to allot more than 500 MB of memory,  
something is wrong.

Any ideas?  Maybe sleep the script after each image?

We're running the script in shell.

</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="028217.html">[nycphp-talk] Periodic Browsercam.com group availability
</A></li>
	<LI>Next message: <A HREF="028220.html">[nycphp-talk] memory problems
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#28219">[ date ]</a>
              <a href="thread.html#28219">[ thread ]</a>
              <a href="subject.html#28219">[ subject ]</a>
              <a href="author.html#28219">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.nyphp.org/mailman/listinfo/talk">More information about the talk
mailing list</a><br>
</body></html>
