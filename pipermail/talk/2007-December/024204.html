<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-51353372-3"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-51353372-3');
</script>
   <TITLE> [nycphp-talk] Tamperproof URLs and PHP slides posted
   </TITLE>
   <LINK REL="Index" HREF="http://nyphp.org/pipermail/talk/2007-December/index.html" >
   <LINK REL="made" HREF="mailto:talk%40lists.nyphp.org?Subject=Re:%20Re%3A%20%5Bnyphp-talk%5D%20Tamperproof%20URLs%20and%20PHP%20slides%20posted&In-Reply-To=%3C47602563.4080109%40phpwerx.net%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="024203.html">
   <LINK REL="Next"  HREF="024207.html">
 <meta name="description" content="PHP jobs stackware web application support and development forums for Mongo LAMP MySQL SQL Windows IIS Linux." />
<meta name="author" content="Stackware Web Development - http://stackware.com" />
<meta name="verify-v1" content="zWMoPwMn/dolscLkjLXTpRqgr9K8bzlzL1vM9WTjpHc=" />
<meta name="msvalidate.01" content="F85F81C1D0BAB5C349E8395628845E27" />
<meta name="y_key" content="265502be3db4fb6e" />
</HEAD>
         <BODY BGCOLOR="#ffffff">
<h1 style="float: right; margin: 0; padding: 0 0 0 15px;"><a href="https://www.meetup.com/new-york-php/">NYCPHP Meetup</a></h1><h1><a href="http://www.nyphp.org">NYPHP.org</a></h1>
   <H1>[nycphp-talk] Tamperproof URLs and PHP slides posted</H1>
    <B>Dan Cech</B> 
    <A HREF="mailto:talk%40lists.nyphp.org?Subject=Re:%20Re%3A%20%5Bnyphp-talk%5D%20Tamperproof%20URLs%20and%20PHP%20slides%20posted&In-Reply-To=%3C47602563.4080109%40phpwerx.net%3E"
       TITLE="[nycphp-talk] Tamperproof URLs and PHP slides posted">dcech at phpwerx.net
       </A><BR>
    <I>Wed Dec 12 13:16:03 EST 2007</I>
    <P><UL>
        <LI>Previous message: <A HREF="024203.html">[nycphp-talk] Tamperproof URLs and PHP slides posted
</A></li>
        <LI>Next message: <A HREF="024207.html">[nycphp-talk] Tamperproof URLs and PHP slides posted
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#24204">[ date ]</a>
              <a href="thread.html#24204">[ thread ]</a>
              <a href="subject.html#24204">[ subject ]</a>
              <a href="author.html#24204">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>csnyder wrote:
&gt;<i> On Dec 12, 2007 10:32 AM, John Campbell &lt;<A HREF="http://lists.nyphp.org/mailman/listinfo/talk">jcampbell1 at gmail.com</A>&gt; wrote:
</I>&gt;<i> 
</I>&gt;&gt;<i> Initially the scores were send as a simple post request, e.g.
</I>&gt;&gt;<i> name=john&amp;score=1000.  This is a problem because it is trivial to
</I>&gt;&gt;<i> forge the request.  So my solution was to create the post request as
</I>&gt;&gt;<i> follows:
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> name=john&amp;score=1000&amp;checksum= . md5(md5(&quot;My secret&quot;) . name . score)
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> on the server side, I can verify the checksum.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> This works well enough, but an enterprising hacker can download my swf
</I>&gt;&gt;<i> file and run `strings game.swf` to extract &quot;My secret&quot;, and then they
</I>&gt;&gt;<i> can forge the request. Is there any cryptography method that
</I>&gt;&gt;<i> guarantees the request is coming from my code?
</I>&gt;&gt;<i>
</I>&gt;<i> 
</I>&gt;<i> Yes there is, John, but you may need to seriously consider whether
</I>&gt;<i> implementation is worth it.
</I>&gt;<i> 
</I>&gt;<i> You can use a public/private key pair to perform asymmetric
</I>&gt;<i> encryption. That means that a value encrypted using one key can only
</I>&gt;<i> be decrypted using the other. This is the encryption scheme used for
</I>&gt;<i> SSL, where your browser uses the server's public key (aka Certificate)
</I>&gt;<i> to encrypt the request.
</I>&gt;<i> 
</I>&gt;<i> So you would use the game's public key to encrypt hash-of-score:random
</I>&gt;<i> on the client side. And then on the server, you would use the game's
</I>&gt;<i> private key to decrypt the value and check the hash.
</I>
Unfortunately this won't help.  If a malicious user wished to fake a
high score it would simply be a matter of extracting the public key from
the game and using it to create a bogus hash.

I do not know of any way to secure against a user with the capability to
disassemble the .swf.  Regardless of the mechanism used to create the
'secure' string for submission, the code to create that string must be
present in the .swf, and therefore vulnerable.

The degree of protection offered is really not dependent on the
encryption/hash method you use, but rather on how difficult it is for a
would-be cheater to figure out how to create the appropriate POST.

Without knowing the impact of a forged high score (eg can a user win
money by faking a high score?) it is difficult to make any
recommendation, but combining a simple checksum (using one of the
suggested methods to obfuscate the source of the secret portion) with
obfuscation of the .swf itself should give enough protection to thwart
casual attacks.

Dan

</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="024203.html">[nycphp-talk] Tamperproof URLs and PHP slides posted
</A></li>
	<LI>Next message: <A HREF="024207.html">[nycphp-talk] Tamperproof URLs and PHP slides posted
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#24204">[ date ]</a>
              <a href="thread.html#24204">[ thread ]</a>
              <a href="subject.html#24204">[ subject ]</a>
              <a href="author.html#24204">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.nyphp.org/mailman/listinfo/talk">More information about the talk
mailing list</a><br>
</body></html>
