<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-51353372-3"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-51353372-3');
</script>
   <TITLE> [nycphp-talk] Proper Form Processing Techniques
   </TITLE>
   <LINK REL="Index" HREF="http://nyphp.org/pipermail/talk/2014-May/index.html" >
   <LINK REL="made" HREF="mailto:talk%40lists.nyphp.org?Subject=Re:%20Re%3A%20%5Bnyphp-talk%5D%20Proper%20Form%20Processing%20Techniques&In-Reply-To=%3C537A4211.4010105%40gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="031924.html">
   <LINK REL="Next"  HREF="031927.html">
 <meta name="description" content="PHP jobs stackware web application support and development forums for Mongo LAMP MySQL SQL Windows IIS Linux." />
<meta name="author" content="Stackware Web Development - http://stackware.com" />
<meta name="verify-v1" content="zWMoPwMn/dolscLkjLXTpRqgr9K8bzlzL1vM9WTjpHc=" />
<meta name="msvalidate.01" content="F85F81C1D0BAB5C349E8395628845E27" />
<meta name="y_key" content="265502be3db4fb6e" />
</HEAD>
         <BODY BGCOLOR="#ffffff">
<h1 style="float: right; margin: 0; padding: 0 0 0 15px;"><a href="https://www.meetup.com/new-york-php/">NYCPHP Meetup</a></h1><h1><a href="http://www.nyphp.org">NYPHP.org</a></h1>
   <H1>[nycphp-talk] Proper Form Processing Techniques</H1>
    <B>Gary Mort</B> 
    <A HREF="mailto:talk%40lists.nyphp.org?Subject=Re:%20Re%3A%20%5Bnyphp-talk%5D%20Proper%20Form%20Processing%20Techniques&In-Reply-To=%3C537A4211.4010105%40gmail.com%3E"
       TITLE="[nycphp-talk] Proper Form Processing Techniques">garyamort at gmail.com
       </A><BR>
    <I>Mon May 19 13:40:33 EDT 2014</I>
    <P><UL>
        <LI>Previous message: <A HREF="031924.html">[nycphp-talk] Proper Form Processing Techniques
</A></li>
        <LI>Next message: <A HREF="031927.html">[nycphp-talk] Proper Form Processing Techniques
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#31926">[ date ]</a>
              <a href="thread.html#31926">[ thread ]</a>
              <a href="subject.html#31926">[ subject ]</a>
              <a href="author.html#31926">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>
On 05/18/2014 01:43 AM, Michael B Allen wrote:
&gt;<i> Hi All,
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> My current technique seems a little hackish because I'm using the
</I>&gt;<i> hidden form element &quot;cmd&quot; to modify the action. In practice it might
</I>&gt;<i> seem purer to modify the action to call /purchase/remove or
</I>&gt;<i> /purchase/update for use with modern routing on the server.
</I>
Whether you are adding an item, removing an item, adding a code, or 
whatnot - all those actions are based on &quot;updating&quot; the order.

There is no need to do &quot;different&quot; processing for each one, you can do 
all of that processing in one process.

IE: &quot;removing&quot; an item is equivalent to setting the item quantity to 0 
or less[just for that joker who decides to put -1000 in the quantity 
field and force a submit].   So for every item that is submitted on the 
form, you can check the quantities, if zero or negative then if the 
product id is in the order list, remove it.

If positive, then either add or update the quantity.

If an item currently in the cart was not submitted, leave it alone.

This allows for submission updates that only change a single item, 
delete items, add multiple items, etc.

Coupon codes work in the same manner.  If there is no coupon code 
submitted, then you use the coupon code currently stored in the 
session.  If a coupon code is added, then add it to the session.  If 
there is an existing coupon code and a new one was entered, decide what 
you want to do[ie you might allow multiple codes, you might not.... ]

Basically each of these steps can be encapsulated into your class and 
processed in one step:

Class cart

function updateItems(....$itemInfoList);
function updateCoupon(...$couponInfo);

function update()
{
// get the info submitted
$this-&gt;updateItems($itemList);
$this-&gt;updateCoupon($coupon);
....
}

Up to you how you want to handle error checking - check between each 
step, check at the end, etc.  If storing data into an SQL database, you 
can use transactions to undo updates on an error.


Technically, you really should use PUT instead of POST, since POST 
implies all the information is on the form, wheras PUT implies that your 
are only submitting changes.

Not relevant is DELETE.  For MOST &quot;deletions&quot; your really doing an 
update.  IE your not &quot;deleting&quot; an item from the cart, you are updating 
the cart and removing that item.   Even if you &quot;delete&quot; the entire cart, 
all visitors have a cart, what your really doing is &quot;emptying&quot; the cart.
</PRE>



<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="031924.html">[nycphp-talk] Proper Form Processing Techniques
</A></li>
	<LI>Next message: <A HREF="031927.html">[nycphp-talk] Proper Form Processing Techniques
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#31926">[ date ]</a>
              <a href="thread.html#31926">[ thread ]</a>
              <a href="subject.html#31926">[ subject ]</a>
              <a href="author.html#31926">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.nyphp.org/mailman/listinfo/talk">More information about the talk
mailing list</a><br>
</body></html>
