<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-51353372-3"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-51353372-3');
</script>
   <TITLE> [nycphp-talk] OT: Apache access_log integrity
   </TITLE>
   <LINK REL="Index" HREF="http://nyphp.org/pipermail/talk/2003-October/index.html" >
   <LINK REL="made" HREF="mailto:talk%40lists.nyphp.org?Subject=Re:%20Re%3A%20%5Bnyphp-talk%5D%20OT%3A%20Apache%20access_log%20integrity&In-Reply-To=%3CBAY2-F105ELi1UdHqn5000063fb%40hotmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="005755.html">
   <LINK REL="Next"  HREF="005758.html">
 <meta name="description" content="PHP jobs stackware web application support and development forums for Mongo LAMP MySQL SQL Windows IIS Linux." />
<meta name="author" content="Stackware Web Development - http://stackware.com" />
<meta name="verify-v1" content="zWMoPwMn/dolscLkjLXTpRqgr9K8bzlzL1vM9WTjpHc=" />
<meta name="msvalidate.01" content="F85F81C1D0BAB5C349E8395628845E27" />
<meta name="y_key" content="265502be3db4fb6e" />
</HEAD>
         <BODY BGCOLOR="#ffffff">
<h1 style="float: right; margin: 0; padding: 0 0 0 15px;"><a href="https://www.meetup.com/new-york-php/">NYCPHP Meetup</a></h1><h1><a href="http://www.nyphp.org">NYPHP.org</a></h1>
   <H1>[nycphp-talk] OT: Apache access_log integrity</H1>
    <B>D C Krook</B> 
    <A HREF="mailto:talk%40lists.nyphp.org?Subject=Re:%20Re%3A%20%5Bnyphp-talk%5D%20OT%3A%20Apache%20access_log%20integrity&In-Reply-To=%3CBAY2-F105ELi1UdHqn5000063fb%40hotmail.com%3E"
       TITLE="[nycphp-talk] OT: Apache access_log integrity">dkrook at hotmail.com
       </A><BR>
    <I>Thu Oct  2 00:59:29 EDT 2003</I>
    <P><UL>
        <LI>Previous message: <A HREF="005755.html">[nycphp-talk] cURL install
</A></li>
        <LI>Next message: <A HREF="005758.html">[nycphp-talk] OT: Apache access_log integrity
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#5756">[ date ]</a>
              <a href="thread.html#5756">[ thread ]</a>
              <a href="subject.html#5756">[ subject ]</a>
              <a href="author.html#5756">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Folks,

I'm trying to trim the fat from Apache's access_log: removing my own IP 
addresses from the log; stripping referer spam; bots; etc.

While I understand that I can exclude known IP addresses and other common 
patterns via mod_setenvif, I'd like to be able to do this on an ad hoc basis 
when I notice certain spikes in useless records in the log and/or when my IP 
changes when hitting my own site from various wireless points.

My first idea was to grep the logs by using a shell or Perl script that I 
could add to my daily cron or call arbitrarily like so:

#!/bin/sh
grep -v &quot;192.168.1.1&quot; /var/log/apache/access_log &gt; 
/var/log/apache/access_log.tmp
mv /var/log/apache/access_log.tmp /var/log/apache/access_log
/export/home/krook/bin/restart-apache.sh

Of course, this has the drawback of restarting Apache everytime the 
access_log is changed by the script, but the second or two of down time is 
acceptable if it means logs that can be regularly analyzed for useful 
reports that don't have &quot;<A HREF="http://jeff-knights-online-viagra-megastore">http://jeff-knights-online-viagra-megastore</A>&quot; as my 
top referer.

I'd like to know if anyone else had addressed this problem in a sucessful 
way or has any best practice, either via mod_setenvif, Perl, CLI PHP, cron 
etc.

I've Googled the following topics without any good results:
&quot;strip line from access_log perl&quot;
&quot;clean access_log&quot;
&quot;setEnvIf&quot;
&quot;eliminate referer spam access_log&quot;
&quot;remove line from log&quot;


Thanks in advance for any tips.

-Dan

_________________________________________________________________
MSN 8 helps eliminate e-mail viruses. Get 2 months FREE*. 
<A HREF="http://join.msn.com/?page=features/virus">http://join.msn.com/?page=features/virus</A>


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="005755.html">[nycphp-talk] cURL install
</A></li>
	<LI>Next message: <A HREF="005758.html">[nycphp-talk] OT: Apache access_log integrity
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#5756">[ date ]</a>
              <a href="thread.html#5756">[ thread ]</a>
              <a href="subject.html#5756">[ subject ]</a>
              <a href="author.html#5756">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.nyphp.org/mailman/listinfo/talk">More information about the talk
mailing list</a><br>
</body></html>
