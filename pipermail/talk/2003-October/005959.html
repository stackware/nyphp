<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-51353372-3"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-51353372-3');
</script>
   <TITLE> [nycphp-talk] Problem trying to convert HTML to Word/Excel/Etc.
   </TITLE>
   <LINK REL="Index" HREF="http://nyphp.org/pipermail/talk/2003-October/index.html" >
   <LINK REL="made" HREF="mailto:talk%40lists.nyphp.org?Subject=Re:%20Re%3A%20%5Bnyphp-talk%5D%20Problem%20trying%20to%20convert%20HTML%20to%20Word/Excel/Etc.&In-Reply-To=%3C006101c395d4%24f26693c0%245c096444%40philofsoa%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="005967.html">
   <LINK REL="Next"  HREF="005968.html">
 <meta name="description" content="PHP jobs stackware web application support and development forums for Mongo LAMP MySQL SQL Windows IIS Linux." />
<meta name="author" content="Stackware Web Development - http://stackware.com" />
<meta name="verify-v1" content="zWMoPwMn/dolscLkjLXTpRqgr9K8bzlzL1vM9WTjpHc=" />
<meta name="msvalidate.01" content="F85F81C1D0BAB5C349E8395628845E27" />
<meta name="y_key" content="265502be3db4fb6e" />
</HEAD>
         <BODY BGCOLOR="#ffffff">
<h1 style="float: right; margin: 0; padding: 0 0 0 15px;"><a href="https://www.meetup.com/new-york-php/">NYCPHP Meetup</a></h1><h1><a href="http://www.nyphp.org">NYPHP.org</a></h1>
   <H1>[nycphp-talk] Problem trying to convert HTML to Word/Excel/Etc.</H1>
    <B>Phil Powell</B> 
    <A HREF="mailto:talk%40lists.nyphp.org?Subject=Re:%20Re%3A%20%5Bnyphp-talk%5D%20Problem%20trying%20to%20convert%20HTML%20to%20Word/Excel/Etc.&In-Reply-To=%3C006101c395d4%24f26693c0%245c096444%40philofsoa%3E"
       TITLE="[nycphp-talk] Problem trying to convert HTML to Word/Excel/Etc.">soazine at erols.com
       </A><BR>
    <I>Sat Oct 18 20:07:11 EDT 2003</I>
    <P><UL>
        <LI>Previous message: <A HREF="005967.html">[nycphp-talk] Session woes
</A></li>
        <LI>Next message: <A HREF="005968.html">[nycphp-talk] Microsoft faces open-source revolt
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#5959">[ date ]</a>
              <a href="thread.html#5959">[ thread ]</a>
              <a href="subject.html#5959">[ subject ]</a>
              <a href="author.html#5959">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Based on the information I read in www.php.net on the header command I wrote a dummy test script to try to convert the contents of $stuff to MS Word downloadable format:

<A HREF="http://www.php.net/header">http://www.php.net/header</A>

Code:


  $stuff = '&lt;html&gt;&lt;head&gt;&lt;title&gt;stuff&lt;/title&gt;&lt;/head&gt;&lt;body&gt;&lt;b&gt;Hello&lt;/b&gt; World&lt;/body&gt;&lt;/html&gt;';

  header(&quot;Expires: Mon, 26 Jul 1997 05:00:00 GMT&quot;);               // Date in the past
  header(&quot;Last-Modified: &quot; . gmdate(&quot;D, d M Y H:i:s&quot;) . &quot; GMT&quot;);  // always modified
  header(&quot;Cache-Control: no-store, no-cache, must-revalidate&quot;);   // HTTP/1.1
  header(&quot;Cache-Control: post-check=0, pre-check=0&quot;, false);
  header(&quot;Pragma: no-cache&quot;);                                     // HTTP/1.0 

  header(&quot;Content-type: application/msword; filename=stuff.doc&quot;);
  //header(&quot;Content-Disposition: attachment; filename=stuff.doc&quot;);
  echo $stuff;


However, upon attempting to run this script I ran into the following error in IE:

Internet Explorer could not open this script: test.php (note: I am trying to change it to be &quot;stuff.doc&quot;).  Nothing ever showed up.

test.php (the code you see) is in a Linux environment in a folder protected by .htaccess.  

In NS 7.0 it produces no errors but it tries to save the downloaded file as &quot;test.php&quot; and not &quot;stuff.doc&quot;.

I am unsure how to do this in PHP although I can do it in TCL and have done it that way before, that, however, is not an option here.

Please help, I'm stuck at the very beginning of attempting customized simple reporting.

Thanx
Phil
-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.nyphp.org/pipermail/talk/attachments/20031018/ecbf6cc7/attachment.html">http://lists.nyphp.org/pipermail/talk/attachments/20031018/ecbf6cc7/attachment.html</A>&gt;
</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="005967.html">[nycphp-talk] Session woes
</A></li>
	<LI>Next message: <A HREF="005968.html">[nycphp-talk] Microsoft faces open-source revolt
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#5959">[ date ]</a>
              <a href="thread.html#5959">[ thread ]</a>
              <a href="subject.html#5959">[ subject ]</a>
              <a href="author.html#5959">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.nyphp.org/mailman/listinfo/talk">More information about the talk
mailing list</a><br>
</body></html>
