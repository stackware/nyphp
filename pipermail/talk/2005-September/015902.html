<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-51353372-3"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-51353372-3');
</script>
   <TITLE> [nycphp-talk] worm/virus's hammering feedback scripts?
   </TITLE>
   <LINK REL="Index" HREF="http://nyphp.org/pipermail/talk/2005-September/index.html" >
   <LINK REL="made" HREF="mailto:talk%40lists.nyphp.org?Subject=Re:%20Re%3A%20%5Bnyphp-talk%5D%20worm/virus%27s%20hammering%20feedback%20scripts%3F&In-Reply-To=%3C4325CB1F.20602%40billyreisinger.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="015900.html">
   <LINK REL="Next"  HREF="015903.html">
 <meta name="description" content="PHP jobs stackware web application support and development forums for Mongo LAMP MySQL SQL Windows IIS Linux." />
<meta name="author" content="Stackware Web Development - http://stackware.com" />
<meta name="verify-v1" content="zWMoPwMn/dolscLkjLXTpRqgr9K8bzlzL1vM9WTjpHc=" />
<meta name="msvalidate.01" content="F85F81C1D0BAB5C349E8395628845E27" />
<meta name="y_key" content="265502be3db4fb6e" />
</HEAD>
         <BODY BGCOLOR="#ffffff">
<h1 style="float: right; margin: 0; padding: 0 0 0 15px;"><a href="https://www.meetup.com/new-york-php/">NYCPHP Meetup</a></h1><h1><a href="http://www.nyphp.org">NYPHP.org</a></h1>
   <H1>[nycphp-talk] worm/virus's hammering feedback scripts?</H1>
    <B>Billy Reisinger</B> 
    <A HREF="mailto:talk%40lists.nyphp.org?Subject=Re:%20Re%3A%20%5Bnyphp-talk%5D%20worm/virus%27s%20hammering%20feedback%20scripts%3F&In-Reply-To=%3C4325CB1F.20602%40billyreisinger.com%3E"
       TITLE="[nycphp-talk] worm/virus's hammering feedback scripts?">mail at billyreisinger.com
       </A><BR>
    <I>Mon Sep 12 14:38:23 EDT 2005</I>
    <P><UL>
        <LI>Previous message: <A HREF="015900.html">[nycphp-talk] worm/virus's hammering feedback scripts?
</A></li>
        <LI>Next message: <A HREF="015903.html">[nycphp-talk] worm/virus's hammering feedback scripts?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#15902">[ date ]</a>
              <a href="thread.html#15902">[ thread ]</a>
              <a href="subject.html#15902">[ subject ]</a>
              <a href="author.html#15902">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>This eregi() is a good start - but like I said in a previous post, ALL 
variables should be checked this way, including subject and message!  
The cruel nature of this hack is that it works anywhere in the mail() 
function. 
Cheers,
Billy Reisinger

Daniel Convissor wrote:

&gt;<i>Hi Michael:
</I>&gt;<i>
</I>&gt;<i>On Mon, Sep 12, 2005 at 12:41:12PM -0400, Michael Southwell wrote:
</I>&gt;<i>  
</I>&gt;<i>
</I>&gt;&gt;<i>At 12:20 PM 9/12/2005, you wrote:
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>    
</I>&gt;&gt;<i>
</I>&gt;&gt;&gt;<i>A list of addresses is the wrong approach.  The email addresses are
</I>&gt;&gt;&gt;<i>variable and easy to change.  More importantly, the content is the issue,
</I>&gt;&gt;&gt;<i>not the email address.
</I>&gt;&gt;&gt;<i>      
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;<i>The point is simply to identify which scripts have sent emails to the 
</I>&gt;&gt;<i>known-bad addresses; those are the vulnerable ones.
</I>&gt;&gt;<i>    
</I>&gt;&gt;<i>
</I>&gt;<i>
</I>&gt;<i>I'm afraid that will lead people into both a false sense of security and 
</I>&gt;<i>using email address blacklists.  Folks should audit their email scripts, 
</I>&gt;<i>period.
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>  
</I>&gt;<i>
</I>&gt;&gt;<i>There were other problems as well, which I noted in my polished 
</I>&gt;&gt;<i>version.  We need an officially sanctioned version of the function 
</I>&gt;&gt;<i>before we can post anything.
</I>&gt;&gt;<i>    
</I>&gt;&gt;<i>
</I>&gt;<i>
</I>&gt;<i>Agreed.  Here's what I think is a good starting point for discussion...
</I>&gt;<i>
</I>&gt;<i>&lt;?php
</I>&gt;<i>// untested!!!!
</I>&gt;<i>// MUST do is_set() checks on all of these for first!
</I>&gt;<i>// left out for brevity.
</I>&gt;<i>
</I>&gt;<i>if (eregi('^[a-z0-9_.=+-]+@([a-z0-9-]+\.)+([a-z]{2,6})$', $_POST['address'])) {
</I>&gt;<i>    $address = $_POST['address'];
</I>&gt;<i>} else {
</I>&gt;<i>    echo 'bad email';
</I>&gt;<i>    exit;
</I>&gt;<i>}
</I>&gt;<i>
</I>&gt;<i>$name = eregi_replace(&quot;[^a-z .'-]&quot;, $_POST['name']);
</I>&gt;<i>$subject = eregi_replace(&quot;[^a-z .'-]&quot;, $_POST['subject']);
</I>&gt;<i>$message = htmlspecialchars($_POST['message']);
</I>&gt;<i>
</I>&gt;<i>@mail('<A HREF="http://lists.nyphp.org/mailman/listinfo/talk">me at example.com</A>', $subject, $message, &quot;From: $name &lt;$address&gt;&quot;);
</I>&gt;<i>?&gt;
</I>&gt;<i>
</I>&gt;<i>--Dan
</I>&gt;<i>
</I>&gt;<i>  
</I>&gt;<i>
</I>

</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="015900.html">[nycphp-talk] worm/virus's hammering feedback scripts?
</A></li>
	<LI>Next message: <A HREF="015903.html">[nycphp-talk] worm/virus's hammering feedback scripts?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#15902">[ date ]</a>
              <a href="thread.html#15902">[ thread ]</a>
              <a href="subject.html#15902">[ subject ]</a>
              <a href="author.html#15902">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.nyphp.org/mailman/listinfo/talk">More information about the talk
mailing list</a><br>
</body></html>
