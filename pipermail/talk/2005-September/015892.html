<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-51353372-3"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-51353372-3');
</script>
   <TITLE> [nycphp-talk] worm/virus's hammering feedback scripts?
   </TITLE>
   <LINK REL="Index" HREF="http://nyphp.org/pipermail/talk/2005-September/index.html" >
   <LINK REL="made" HREF="mailto:talk%40lists.nyphp.org?Subject=Re:%20Re%3A%20%5Bnyphp-talk%5D%20worm/virus%27s%20hammering%20feedback%20scripts%3F&In-Reply-To=%3C43259BC2.4050604%40omnistep.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="015889.html">
   <LINK REL="Next"  HREF="015893.html">
 <meta name="description" content="PHP jobs stackware web application support and development forums for Mongo LAMP MySQL SQL Windows IIS Linux." />
<meta name="author" content="Stackware Web Development - http://stackware.com" />
<meta name="verify-v1" content="zWMoPwMn/dolscLkjLXTpRqgr9K8bzlzL1vM9WTjpHc=" />
<meta name="msvalidate.01" content="F85F81C1D0BAB5C349E8395628845E27" />
<meta name="y_key" content="265502be3db4fb6e" />
</HEAD>
         <BODY BGCOLOR="#ffffff">
<h1 style="float: right; margin: 0; padding: 0 0 0 15px;"><a href="https://www.meetup.com/new-york-php/">NYCPHP Meetup</a></h1><h1><a href="http://www.nyphp.org">NYPHP.org</a></h1>
   <H1>[nycphp-talk] worm/virus's hammering feedback scripts?</H1>
    <B>Rolan Yang</B> 
    <A HREF="mailto:talk%40lists.nyphp.org?Subject=Re:%20Re%3A%20%5Bnyphp-talk%5D%20worm/virus%27s%20hammering%20feedback%20scripts%3F&In-Reply-To=%3C43259BC2.4050604%40omnistep.com%3E"
       TITLE="[nycphp-talk] worm/virus's hammering feedback scripts?">rolan at omnistep.com
       </A><BR>
    <I>Mon Sep 12 11:16:18 EDT 2005</I>
    <P><UL>
        <LI>Previous message: <A HREF="015889.html">[nycphp-talk] worm/virus's hammering feedback scripts?
</A></li>
        <LI>Next message: <A HREF="015893.html">[nycphp-talk] worm/virus's hammering feedback scripts? POLISHED VERSION
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#15892">[ date ]</a>
              <a href="thread.html#15892">[ thread ]</a>
              <a href="subject.html#15892">[ subject ]</a>
              <a href="author.html#15892">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hans Zaunere wrote:

&gt;<i>Another address I've seen is <A HREF="http://lists.nyphp.org/mailman/listinfo/talk">mhkoch321 at aol.com</A>
</I>&gt;<i>
</I>&gt;<i>Rolan, and I think you're right about this problem not getting enough
</I>&gt;<i>exposure.  If you can write-up a couple of paragraphs about it, I'll post it
</I>&gt;<i>on nyphp.org's frontpage.
</I>&gt;<i>
</I>Ok, here's the bulletin. If anyone would like to polish it up, feel free 
to do so. I'm not good at writing this stuff.

Problem:
Bot-net scanning underway to detect and log php scripts which are 
vulnerable to a email header injection exploit.

What is vulnerable:
PHP scripts which send email based on cgi input data should be inspected 
for the vulnerability.

Discussion:
A large scale distributed network of machines are currently being 
employed to scan php based websites in search of scripts which are 
vulnerable to a injection-style security exploit. The exploit permits an 
attacker to send emails to arbitrary destinations. A common target is 
the web based feedback form which submits an email to a designated 
address, but could be any form which results in an email being sent.  
The method used to exploit the vulnerability is by injection of email 
headers into cgi form fields which are passed to the mail server. The 
mail server then parses the headers and sends the email to the 
address(es) designated in the maliciously injected headers.

Exploit:
The bot-net script currently probes vulnerable scripts by injecting 
malicious headers into cgi form fields. The headers forward an email 
response to one of several target email address to which the hacker has 
access. We assume the attacker is collecting a list of vulnerable sites 
which may be used later as an open relay for spam or  large scale 
deployment of viruses/worms.

For more information about the attack, please refer to:
<A HREF="http://securephp.damonkohler.com/index.php/Email_Injection">http://securephp.damonkohler.com/index.php/Email_Injection</A> (thank's to 
Billy Reisinger for the link)

A google search for the target emails reveals that scans have been 
taking place since at least July 8, 2005

Detection and Solution:
The current bot-net probe is known to send its reply to one of several 
known email addresses on the following list.

Grep through your mail server logs for the list of emails. If any are 
found, cross reference the time of the mailing to times in your web 
server logs to help determine the exploitable script.

grep -f exploitemails.txt /var/log/maillog (or wherever your mail log is 
located)

Vulnerable scripts should be modified to properly filter input fields. 
Ken Robinson has posted a
php example at: 
<A HREF="http://lists.nyphp.org/pipermail/talk/2005-September/016124.html">http://lists.nyphp.org/pipermail/talk/2005-September/016124.html</A>

To follow the mailing list thread on this topic, please visit:
<A HREF="http://lists.nyphp.org/pipermail/talk/2005-September/thread.html#16123">http://lists.nyphp.org/pipermail/talk/2005-September/thread.html#16123</A>

(we should build a list of these emails and publish them along with this 
notification)

Current list:
<A HREF="http://lists.nyphp.org/mailman/listinfo/talk">jrubin3546 at aol.com</A>
<A HREF="http://lists.nyphp.org/mailman/listinfo/talk">mkoch321 at aol.com</A>
<A HREF="http://lists.nyphp.org/mailman/listinfo/talk">wnacyiplay at aol.com</A>
<A HREF="http://lists.nyphp.org/mailman/listinfo/talk">kshmng at aol.com</A>
<A HREF="http://lists.nyphp.org/mailman/listinfo/talk">Homeiragtime at aol.com</A>
<A HREF="http://lists.nyphp.org/mailman/listinfo/talk">bergkoch8 at aol.com</A>

~Rolan Yang

</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="015889.html">[nycphp-talk] worm/virus's hammering feedback scripts?
</A></li>
	<LI>Next message: <A HREF="015893.html">[nycphp-talk] worm/virus's hammering feedback scripts? POLISHED VERSION
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#15892">[ date ]</a>
              <a href="thread.html#15892">[ thread ]</a>
              <a href="subject.html#15892">[ subject ]</a>
              <a href="author.html#15892">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.nyphp.org/mailman/listinfo/talk">More information about the talk
mailing list</a><br>
</body></html>
