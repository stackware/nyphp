<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-51353372-3"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-51353372-3');
</script>
   <TITLE> [nycphp-talk] worm/virus's hammering feedback scripts?	POLISHED	VERSION
   </TITLE>
   <LINK REL="Index" HREF="http://nyphp.org/pipermail/talk/2005-September/index.html" >
   <LINK REL="made" HREF="mailto:talk%40lists.nyphp.org?Subject=Re:%20Re%3A%20%5Bnyphp-talk%5D%20worm/virus%27s%20hammering%20feedback%20scripts%3F%0A%09POLISHED%09VERSION&In-Reply-To=%3COF00101133.FE4DE49A-ON8525707B.0014407F-8525707B.001465D7%40us.ibm.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="015913.html">
   <LINK REL="Next"  HREF="015916.html">
 <meta name="description" content="PHP jobs stackware web application support and development forums for Mongo LAMP MySQL SQL Windows IIS Linux." />
<meta name="author" content="Stackware Web Development - http://stackware.com" />
<meta name="verify-v1" content="zWMoPwMn/dolscLkjLXTpRqgr9K8bzlzL1vM9WTjpHc=" />
<meta name="msvalidate.01" content="F85F81C1D0BAB5C349E8395628845E27" />
<meta name="y_key" content="265502be3db4fb6e" />
</HEAD>
         <BODY BGCOLOR="#ffffff">
<h1 style="float: right; margin: 0; padding: 0 0 0 15px;"><a href="https://www.meetup.com/new-york-php/">NYCPHP Meetup</a></h1><h1><a href="http://www.nyphp.org">NYPHP.org</a></h1>
   <H1>[nycphp-talk] worm/virus's hammering feedback scripts?	POLISHED	VERSION</H1>
    <B>Daniel Krook</B> 
    <A HREF="mailto:talk%40lists.nyphp.org?Subject=Re:%20Re%3A%20%5Bnyphp-talk%5D%20worm/virus%27s%20hammering%20feedback%20scripts%3F%0A%09POLISHED%09VERSION&In-Reply-To=%3COF00101133.FE4DE49A-ON8525707B.0014407F-8525707B.001465D7%40us.ibm.com%3E"
       TITLE="[nycphp-talk] worm/virus's hammering feedback scripts?	POLISHED	VERSION">krook at us.ibm.com
       </A><BR>
    <I>Mon Sep 12 23:43:01 EDT 2005</I>
    <P><UL>
        <LI>Previous message: <A HREF="015913.html">[nycphp-talk] worm/virus's hammering feedback scripts? POLISHED	VERSION
</A></li>
        <LI>Next message: <A HREF="015916.html">[nycphp-talk] worm/virus's hammering feedback	scripts?	POLISHED	VERSION
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#15915">[ date ]</a>
              <a href="thread.html#15915">[ thread ]</a>
              <a href="subject.html#15915">[ subject ]</a>
              <a href="author.html#15915">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>&gt;<i> Is this exploit PHP specific?  Although I haven't 
</I>&gt;<i> confirmed, the nature of
</I>&gt;<i> the vulnerability would appear to effect any mailing web 
</I>&gt;<i> form, in nearly any
</I>&gt;<i> language.  Can anyone provide additional details?
</I>

Hmm,

An interesting question...

&gt;<i>From my experience developing feedback forms in Java using the JavaMail 
</I>API, the &quot;to&quot; or &quot;from&quot; email addresses are of the type 
javax.mail.internet.InternetAddress, which takes a String in its 
constructor and throws an exception (javax.mail.internet.AddressException) 
if the address can not be parsed in RFC822 format (the default):

<A HREF="http://java.sun.com/products/javamail/javadocs/javax/mail/internet/InternetAddress.html#InternetAddress(java.lang.String">http://java.sun.com/products/javamail/javadocs/javax/mail/internet/InternetAddress.html#InternetAddress(java.lang.String</A>)

These InternetAddress objects are normally given to an instance of type 
javax.mail.internet.MimeMessage which is itself given an instance of 
javax.mail.Session.   You often set MimeMessage's recipients with methods 
which take InternetAddresses, but can also take raw Strings.

The setSubject method of MimeMessage takes Strings, and it explicitly 
notes in the Javadoc that &quot;The application must ensure that the subject 
does not contain any line breaks&quot;, which seems to suggest that it is also 
known to be vulnerable to an exploit of this nature.

<A HREF="http://java.sun.com/products/javamail/javadocs/javax/mail/internet/MimeMessage.html#setSubject(java.lang.String">http://java.sun.com/products/javamail/javadocs/javax/mail/internet/MimeMessage.html#setSubject(java.lang.String</A>)

So it would seem if you ventured past the parts of the JavaMail API which 
allow you to use Strings, instead of creating InternetAddress objects and 
hardcoding the subject, you would be &quot;safe&quot; from the exploit, but you 
should double check any methods that you are using that expect Strings.





Daniel Krook, Advisory IT Specialist 
Application Development, Production Services - Tools, ibm.com

Personal: <A HREF="http://info.krook.org/">http://info.krook.org/</A>
BluePages: <A HREF="http://bluepages.redirect.webahead.ibm.com/">http://bluepages.redirect.webahead.ibm.com/</A>
BlogPages: <A HREF="http://blogpages.redirect.webahead.ibm.com/">http://blogpages.redirect.webahead.ibm.com/</A>



</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="015913.html">[nycphp-talk] worm/virus's hammering feedback scripts? POLISHED	VERSION
</A></li>
	<LI>Next message: <A HREF="015916.html">[nycphp-talk] worm/virus's hammering feedback	scripts?	POLISHED	VERSION
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#15915">[ date ]</a>
              <a href="thread.html#15915">[ thread ]</a>
              <a href="subject.html#15915">[ subject ]</a>
              <a href="author.html#15915">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.nyphp.org/mailman/listinfo/talk">More information about the talk
mailing list</a><br>
</body></html>
