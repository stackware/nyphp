<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-51353372-3"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-51353372-3');
</script>
   <TITLE> [nycphp-talk] Phundamentals Title Change: Email Header Injection
   </TITLE>
   <LINK REL="Index" HREF="http://nyphp.org/pipermail/talk/2005-September/index.html" >
   <LINK REL="made" HREF="mailto:talk%40lists.nyphp.org?Subject=Re:%20Re%3A%20%5Bnyphp-talk%5D%20Phundamentals%20Title%20Change%3A%20Email%20Header%20Injection&In-Reply-To=%3C432EADFB.8040907%40phpwerx.net%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="016005.html">
   <LINK REL="Next"  HREF="016070.html">
 <meta name="description" content="PHP jobs stackware web application support and development forums for Mongo LAMP MySQL SQL Windows IIS Linux." />
<meta name="author" content="Stackware Web Development - http://stackware.com" />
<meta name="verify-v1" content="zWMoPwMn/dolscLkjLXTpRqgr9K8bzlzL1vM9WTjpHc=" />
<meta name="msvalidate.01" content="F85F81C1D0BAB5C349E8395628845E27" />
<meta name="y_key" content="265502be3db4fb6e" />
</HEAD>
         <BODY BGCOLOR="#ffffff">
<h1 style="float: right; margin: 0; padding: 0 0 0 15px;"><a href="https://www.meetup.com/new-york-php/">NYCPHP Meetup</a></h1><h1><a href="http://www.nyphp.org">NYPHP.org</a></h1>
   <H1>[nycphp-talk] Phundamentals Title Change: Email Header Injection</H1>
    <B>Dan Cech</B> 
    <A HREF="mailto:talk%40lists.nyphp.org?Subject=Re:%20Re%3A%20%5Bnyphp-talk%5D%20Phundamentals%20Title%20Change%3A%20Email%20Header%20Injection&In-Reply-To=%3C432EADFB.8040907%40phpwerx.net%3E"
       TITLE="[nycphp-talk] Phundamentals Title Change: Email Header Injection">dcech at phpwerx.net
       </A><BR>
    <I>Mon Sep 19 08:24:27 EDT 2005</I>
    <P><UL>
        <LI>Previous message: <A HREF="016005.html">[nycphp-talk] Phundamentals Title Change: Email Header Injection
</A></li>
        <LI>Next message: <A HREF="016070.html">[nycphp-talk] Phundamentals Title Change: Email Header Injection
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#16006">[ date ]</a>
              <a href="thread.html#16006">[ thread ]</a>
              <a href="subject.html#16006">[ subject ]</a>
              <a href="author.html#16006">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Jeff &amp; list,

I believe I managed to avoid weighing into the various debates raging 
back and forth in the thread.

The idea of checking for particular email addresses in the mail logs 
does seem pretty naive, especially as they are such a throwaway item 
these days.

Personally I'm of the opinion that these kinds of forms should require 
inputs that are supposed to be email addresses to look like email 
addresses.  Not only will that remove the possibility of this exploit, 
it will also cut down (ever so slightly) on malformed addresses being 
sent through to the mail subsystem.  Good user feedback for 'invalid' 
addresses should allow anyone using the form to 'correct' them, so I see 
little point in blindly accepting something that isn't obviously an 
email address.

The other common vulnerable field seems to be the Subject, though I see 
very little reason not to restrict that (or any other non-address) field 
to something like /^([-a-z0-9!@#$%^&amp;*()_\[\]{}\\|;:'&quot;,.&lt;&gt;\/?+= ]+)$/i, 
especially considering the fact that non-ascii characters are usually 
frowned upon in email headers.

Also, correct me if I'm wrong but I believe the %0A encoding is purely 
used in the request string, once it gets into PHP it will just see 
either \n or \r, the literal string %0A does not pose any risk to emails 
as a string itself.

Dan

Jeff Siegel wrote:
&gt;<i> Point well taken and I believe it was Dan C. who noted the need to not rely
</I>&gt;<i> on that list of &quot;known&quot; email addresses.
</I>&gt;<i>  
</I>&gt;<i> Jeff
</I>
</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="016005.html">[nycphp-talk] Phundamentals Title Change: Email Header Injection
</A></li>
	<LI>Next message: <A HREF="016070.html">[nycphp-talk] Phundamentals Title Change: Email Header Injection
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#16006">[ date ]</a>
              <a href="thread.html#16006">[ thread ]</a>
              <a href="subject.html#16006">[ subject ]</a>
              <a href="author.html#16006">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.nyphp.org/mailman/listinfo/talk">More information about the talk
mailing list</a><br>
</body></html>
