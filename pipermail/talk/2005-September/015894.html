<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-51353372-3"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-51353372-3');
</script>
   <TITLE> [nycphp-talk] worm/virus's hammering feedback scripts?
   </TITLE>
   <LINK REL="Index" HREF="http://nyphp.org/pipermail/talk/2005-September/index.html" >
   <LINK REL="made" HREF="mailto:talk%40lists.nyphp.org?Subject=Re:%20Re%3A%20%5Bnyphp-talk%5D%20worm/virus%27s%20hammering%20feedback%20scripts%3F&In-Reply-To=%3C20050912162018.GA22938%40panix.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="015898.html">
   <LINK REL="Next"  HREF="015896.html">
 <meta name="description" content="PHP jobs stackware web application support and development forums for Mongo LAMP MySQL SQL Windows IIS Linux." />
<meta name="author" content="Stackware Web Development - http://stackware.com" />
<meta name="verify-v1" content="zWMoPwMn/dolscLkjLXTpRqgr9K8bzlzL1vM9WTjpHc=" />
<meta name="msvalidate.01" content="F85F81C1D0BAB5C349E8395628845E27" />
<meta name="y_key" content="265502be3db4fb6e" />
</HEAD>
         <BODY BGCOLOR="#ffffff">
<h1 style="float: right; margin: 0; padding: 0 0 0 15px;"><a href="https://www.meetup.com/new-york-php/">NYCPHP Meetup</a></h1><h1><a href="http://www.nyphp.org">NYPHP.org</a></h1>
   <H1>[nycphp-talk] worm/virus's hammering feedback scripts?</H1>
    <B>Daniel Convissor</B> 
    <A HREF="mailto:talk%40lists.nyphp.org?Subject=Re:%20Re%3A%20%5Bnyphp-talk%5D%20worm/virus%27s%20hammering%20feedback%20scripts%3F&In-Reply-To=%3C20050912162018.GA22938%40panix.com%3E"
       TITLE="[nycphp-talk] worm/virus's hammering feedback scripts?">danielc at analysisandsolutions.com
       </A><BR>
    <I>Mon Sep 12 12:20:18 EDT 2005</I>
    <P><UL>
        <LI>Previous message: <A HREF="015898.html">[nycphp-talk] worm/virus's hammering feedback scripts?
</A></li>
        <LI>Next message: <A HREF="015896.html">[nycphp-talk] worm/virus's hammering feedback scripts?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#15894">[ date ]</a>
              <a href="thread.html#15894">[ thread ]</a>
              <a href="subject.html#15894">[ subject ]</a>
              <a href="author.html#15894">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hey Folks:

On Mon, Sep 12, 2005 at 11:16:18AM -0400, Rolan Yang wrote:

&gt;<i> Detection and Solution:
</I>&gt;<i> The current bot-net probe is known to send its reply to one of several 
</I>&gt;<i> known email addresses on the following list.
</I>
A list of addresses is the wrong approach.  The email addresses are 
variable and easy to change.  More importantly, the content is the issue, 
not the email address.


&gt;<i> Vulnerable scripts should be modified to properly filter input fields. 
</I>&gt;<i> Ken Robinson has posted a
</I>&gt;<i> php example at: 
</I>&gt;<i> <A HREF="http://lists.nyphp.org/pipermail/talk/2005-September/016124.html">http://lists.nyphp.org/pipermail/talk/2005-September/016124.html</A>
</I>
That solution is less than perfect.  First, it's case sensitive, so misses 
things like &quot;BcC&quot;, meaning str_ireplace() would be better.  Second, it 
catches things that don't need to be.

The mere existence of &quot;content-type&quot; or &quot;bcc&quot; in the inputs isn't a 
problem.  The danger is having those at the beginning of a line and only 
in fields that get put into the email headers.  So, this vulnerability can 
be solved by removing white space characters other than regular spaces 
from any field going into the email headers.  Or better yet, only allowing 
letters, numbers, spaces and a few punctuation type characters.

Non Issue:
$var = &quot;Content-type: crack&quot;;
$subject = &quot;Subject: $var&quot;;

Real Issue:
$var = &quot;You're about to be cracked\r\nContent-type: crack&quot;;
$subject = &quot;Subject: $var&quot;;

--Dan

-- 
 T H E   A N A L Y S I S   A N D   S O L U T I O N S   C O M P A N Y
            data intensive web and database programming
                <A HREF="http://www.AnalysisAndSolutions.com/">http://www.AnalysisAndSolutions.com/</A>
 4015 7th Ave #4, Brooklyn NY 11232  v: 718-854-0335 f: 718-854-0409

</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="015898.html">[nycphp-talk] worm/virus's hammering feedback scripts?
</A></li>
	<LI>Next message: <A HREF="015896.html">[nycphp-talk] worm/virus's hammering feedback scripts?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#15894">[ date ]</a>
              <a href="thread.html#15894">[ thread ]</a>
              <a href="subject.html#15894">[ subject ]</a>
              <a href="author.html#15894">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.nyphp.org/mailman/listinfo/talk">More information about the talk
mailing list</a><br>
</body></html>
