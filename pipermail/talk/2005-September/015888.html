<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-51353372-3"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-51353372-3');
</script>
   <TITLE> [nycphp-talk] worm/virus's hammering feedback scripts?
   </TITLE>
   <LINK REL="Index" HREF="http://nyphp.org/pipermail/talk/2005-September/index.html" >
   <LINK REL="made" HREF="mailto:talk%40lists.nyphp.org?Subject=Re:%20Re%3A%20%5Bnyphp-talk%5D%20worm/virus%27s%20hammering%20feedback%20scripts%3F&In-Reply-To=%3COF5DF984F9.3FB9FD24-ON8525707A.0049C9FA-8525707A.004A5324%40us.ibm.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="015904.html">
   <LINK REL="Next"  HREF="015890.html">
 <meta name="description" content="PHP jobs stackware web application support and development forums for Mongo LAMP MySQL SQL Windows IIS Linux." />
<meta name="author" content="Stackware Web Development - http://stackware.com" />
<meta name="verify-v1" content="zWMoPwMn/dolscLkjLXTpRqgr9K8bzlzL1vM9WTjpHc=" />
<meta name="msvalidate.01" content="F85F81C1D0BAB5C349E8395628845E27" />
<meta name="y_key" content="265502be3db4fb6e" />
</HEAD>
         <BODY BGCOLOR="#ffffff">
<h1 style="float: right; margin: 0; padding: 0 0 0 15px;"><a href="https://www.meetup.com/new-york-php/">NYCPHP Meetup</a></h1><h1><a href="http://www.nyphp.org">NYPHP.org</a></h1>
   <H1>[nycphp-talk] worm/virus's hammering feedback scripts?</H1>
    <B>Daniel Krook</B> 
    <A HREF="mailto:talk%40lists.nyphp.org?Subject=Re:%20Re%3A%20%5Bnyphp-talk%5D%20worm/virus%27s%20hammering%20feedback%20scripts%3F&In-Reply-To=%3COF5DF984F9.3FB9FD24-ON8525707A.0049C9FA-8525707A.004A5324%40us.ibm.com%3E"
       TITLE="[nycphp-talk] worm/virus's hammering feedback scripts?">krook at us.ibm.com
       </A><BR>
    <I>Mon Sep 12 09:32:02 EDT 2005</I>
    <P><UL>
        <LI>Previous message: <A HREF="015904.html">[nycphp-talk] worm/virus's hammering feedback scripts?
</A></li>
        <LI>Next message: <A HREF="015890.html">[nycphp-talk] worm/virus's hammering feedback scripts?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#15888">[ date ]</a>
              <a href="thread.html#15888">[ thread ]</a>
              <a href="subject.html#15888">[ subject ]</a>
              <a href="author.html#15888">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>&gt;<i> It's a particularly ingenuous method of taking advantage 
</I>&gt;<i> of primarily the MIME standard.  I typically look for the 
</I>&gt;<i> string 'Content-Type:' in any submitted fields, and if 
</I>&gt;<i> it's found, the script records the IP and notifies me.
</I>
This is important, I found injections in ALL my fields, not just the 
obvious textarea fields.  Hidden and regular text boxes have been used as 
well, since this attack is automated and doesn't function as a normal 
browser would.


&gt;<i> Since it's my understanding that the exploitation can't 
</I>&gt;<i> happen without the use of Content-Type: (the MIME header 
</I>&gt;<i> that dictates part of a message's structure), something 
</I>&gt;<i> like this has worked well:
</I>&gt;<i> 
</I>&gt;<i> foreach( $form_fields as $value )
</I>&gt;<i> {
</I>&gt;<i>   if( stripos($value,'Content-Type:') !== FALSE )
</I>&gt;<i>   {
</I>&gt;<i>     mail('<A HREF="http://lists.nyphp.org/mailman/listinfo/talk">admin at my.com</A>','Spam Attempt',$_SERVER['REMOTE_ADDR']);
</I>&gt;<i>     exit(&quot;{$_SERVER['REMOTE_ADDR']} Has been Recorded&quot;);
</I>&gt;<i>   }
</I>&gt;<i> }
</I>&gt;<i> 
</I>
A PHP4 version of the above looks something like this, and seems to work:

if (strpos(strtolower($someField), 'content-type:') !== false) {
        mail('<A HREF="http://lists.nyphp.org/mailman/listinfo/talk">admin at example.net</A>', 'Spam attempt from example.net', 
$_SERVER['REMOTE_ADDR']);
} else {
        mail('<A HREF="http://lists.nyphp.org/mailman/listinfo/talk">customerservice at example.net</A>', 'Customer submission from 
example.net', $msg, $headers);
}


&gt;<i> Of course complete input filtering might be the better 
</I>&gt;<i> solution to this.
</I>
Agreed.




Daniel Krook, Advisory IT Specialist 
Application Development, Production Services - Tools, ibm.com

Personal: <A HREF="http://info.krook.org/">http://info.krook.org/</A>
BluePages: <A HREF="http://bluepages.redirect.webahead.ibm.com/">http://bluepages.redirect.webahead.ibm.com/</A>
BlogPages: <A HREF="http://blogpages.redirect.webahead.ibm.com/">http://blogpages.redirect.webahead.ibm.com/</A>


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="015904.html">[nycphp-talk] worm/virus's hammering feedback scripts?
</A></li>
	<LI>Next message: <A HREF="015890.html">[nycphp-talk] worm/virus's hammering feedback scripts?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#15888">[ date ]</a>
              <a href="thread.html#15888">[ thread ]</a>
              <a href="subject.html#15888">[ subject ]</a>
              <a href="author.html#15888">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.nyphp.org/mailman/listinfo/talk">More information about the talk
mailing list</a><br>
</body></html>
