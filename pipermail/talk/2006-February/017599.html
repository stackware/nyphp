<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-51353372-3"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-51353372-3');
</script>
   <TITLE> [nycphp-talk] Preventing spam with php mail function
   </TITLE>
   <LINK REL="Index" HREF="http://nyphp.org/pipermail/talk/2006-February/index.html" >
   <LINK REL="made" HREF="mailto:talk%40lists.nyphp.org?Subject=Re:%20Re%3A%20%5Bnyphp-talk%5D%20Preventing%20spam%20with%20php%20mail%20function&In-Reply-To=%3C9442-15870%40sneakemail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="017598.html">
   <LINK REL="Next"  HREF="017612.html">
 <meta name="description" content="PHP jobs stackware web application support and development forums for Mongo LAMP MySQL SQL Windows IIS Linux." />
<meta name="author" content="Stackware Web Development - http://stackware.com" />
<meta name="verify-v1" content="zWMoPwMn/dolscLkjLXTpRqgr9K8bzlzL1vM9WTjpHc=" />
<meta name="msvalidate.01" content="F85F81C1D0BAB5C349E8395628845E27" />
<meta name="y_key" content="265502be3db4fb6e" />
</HEAD>
         <BODY BGCOLOR="#ffffff">
<h1 style="float: right; margin: 0; padding: 0 0 0 15px;"><a href="https://www.meetup.com/new-york-php/">NYCPHP Meetup</a></h1><h1><a href="http://www.nyphp.org">NYPHP.org</a></h1>
   <H1>[nycphp-talk] Preventing spam with php mail function</H1>
    <B>inforequest</B> 
    <A HREF="mailto:talk%40lists.nyphp.org?Subject=Re:%20Re%3A%20%5Bnyphp-talk%5D%20Preventing%20spam%20with%20php%20mail%20function&In-Reply-To=%3C9442-15870%40sneakemail.com%3E"
       TITLE="[nycphp-talk] Preventing spam with php mail function">1j0lkq002 at sneakemail.com
       </A><BR>
    <I>Thu Feb 23 17:46:35 EST 2006</I>
    <P><UL>
        <LI>Previous message: <A HREF="017598.html">[nycphp-talk] Preventing spam with php mail function
</A></li>
        <LI>Next message: <A HREF="017612.html">[nycphp-talk] Preventing spam with php mail function
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#17599">[ date ]</a>
              <a href="thread.html#17599">[ thread ]</a>
              <a href="subject.html#17599">[ subject ]</a>
              <a href="author.html#17599">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hans Zaunere lists-at-zaunere.com |nyphp dev/internal group use| wrote:

&gt;<i> If I understand correctly, we have a PHundamentals article available for
</I>&gt;<i>
</I>&gt;<i>this:
</I>&gt;<i>
</I>&gt;<i><A HREF="http://www.nyphp.org/phundamentals/email_header_injection.php">http://www.nyphp.org/phundamentals/email_header_injection.php</A>
</I>&gt;<i>
</I>&gt;<i>  
</I>&gt;<i>
</I>
Hans beat me to it. IMHO that article is one of the best on the web for 
addressing multi-part MIME exploits using contact forms. It is an 
advanced topic, though, but as with every &quot;exploit&quot;  if the coder 
suffered through the advanced topics early,  the learning process would 
be much less painful.

Basically it shows how even if you build a &quot;safer&quot; contact form, it may 
be used to insert spam because Internet mail systems permit mail 
messages to be inserted into other mail messages. The bottom line is 
that you have to filter every field of the mail your form will create 
and send, even if you don't collect those fields on your form (default 
fields and the like). Most people are filtering every field their form 
collects (which is not enough... you have to filter/control the defaults 
as well). That article also highlights the need to filter out newlines 
that might indictate an inserted message-within-a-message. It's a good 
article.

Chris' reply is excellent for the way it suggests you review the bigger 
picture of your security (not just the technology of the contact form). 
I completely agree, and would like to add more. Consider these ideas as 
a start:

Can your form be used to spoof an email so that it appears to come from 
someone within your company even though it really originated on your 
website, created by an outsider?

Could I use your form to send an email to the person who handles 
user-submitted requests, perhaps looking like an email from your web 
hosting company directing an update of shell account username/passwords etc?

Can your &quot;change my password&quot; form be used to change another user's 
password withoit prior permission/approval?

Does your contact-us form CC others in your organization prior to any 
adminsitrative review? You don't want obscene or harassing statements 
circulated within the company, or you could open up the company to civil 
liabilities. Similarly, if your organization is regulated (HIPAA, 
banking and finance, securities, etc) un-reviewed user submissions 
should not be circulated (copied to multiple places onclient machines etc).

Hope this helps.

-=johnandrews
<A HREF="http://www.seo-fun.com">http://www.seo-fun.com</A>




</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="017598.html">[nycphp-talk] Preventing spam with php mail function
</A></li>
	<LI>Next message: <A HREF="017612.html">[nycphp-talk] Preventing spam with php mail function
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#17599">[ date ]</a>
              <a href="thread.html#17599">[ thread ]</a>
              <a href="subject.html#17599">[ subject ]</a>
              <a href="author.html#17599">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.nyphp.org/mailman/listinfo/talk">More information about the talk
mailing list</a><br>
</body></html>
