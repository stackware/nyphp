<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-51353372-3"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-51353372-3');
</script>
   <TITLE> [nycphp-talk] filewhatevertime for Windows folder
   </TITLE>
   <LINK REL="Index" HREF="http://nyphp.org/pipermail/talk/2007-June/index.html" >
   <LINK REL="made" HREF="mailto:talk%40lists.nyphp.org?Subject=Re:%20Re%3A%20%5Bnyphp-talk%5D%20filewhatevertime%20for%20Windows%20folder&In-Reply-To=%3C4677E773.8030004%40gmx.net%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="022158.html">
   <LINK REL="Next"  HREF="022163.html">
 <meta name="description" content="PHP jobs stackware web application support and development forums for Mongo LAMP MySQL SQL Windows IIS Linux." />
<meta name="author" content="Stackware Web Development - http://stackware.com" />
<meta name="verify-v1" content="zWMoPwMn/dolscLkjLXTpRqgr9K8bzlzL1vM9WTjpHc=" />
<meta name="msvalidate.01" content="F85F81C1D0BAB5C349E8395628845E27" />
<meta name="y_key" content="265502be3db4fb6e" />
</HEAD>
         <BODY BGCOLOR="#ffffff">
<h1 style="float: right; margin: 0; padding: 0 0 0 15px;"><a href="https://www.meetup.com/new-york-php/">NYCPHP Meetup</a></h1><h1><a href="http://www.nyphp.org">NYPHP.org</a></h1>
   <H1>[nycphp-talk] filewhatevertime for Windows folder</H1>
    <B>David Krings</B> 
    <A HREF="mailto:talk%40lists.nyphp.org?Subject=Re:%20Re%3A%20%5Bnyphp-talk%5D%20filewhatevertime%20for%20Windows%20folder&In-Reply-To=%3C4677E773.8030004%40gmx.net%3E"
       TITLE="[nycphp-talk] filewhatevertime for Windows folder">ramons at gmx.net
       </A><BR>
    <I>Tue Jun 19 10:25:55 EDT 2007</I>
    <P><UL>
        <LI>Previous message: <A HREF="022158.html">[nycphp-talk] filewhatevertime for Windows folder
</A></li>
        <LI>Next message: <A HREF="022163.html">[nycphp-talk] Stored MS Access procedures &gt; PHP/MySQL?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#22161">[ date ]</a>
              <a href="thread.html#22161">[ thread ]</a>
              <a href="subject.html#22161">[ subject ]</a>
              <a href="author.html#22161">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>pyurt wrote:
&gt;<i> David 	
</I>&gt;<i> 
</I>&gt;<i> Can you provide a little more detail. 
</I>&gt;<i> How are you testing file time? 
</I>&gt;<i> What OS? 
</I>&gt;<i> Are you getting increasing times from the files with just the wrong time or
</I>&gt;<i> complete random values? 
</I>&gt;<i> 
</I>&gt;<i> Paul 
</I>
I tested this on XP and the reported times are always the same.


This is what I used to have as code:

// Clean up stale login data
// Make time stamp for 24 hours in the past
$timestamp = time() - 24 * 60 * 60;

// Read temp dir
if ($handle = 
opendir($_SESSION['filepathtoroot'].DIRECTORY_SEPARATOR.&quot;temp&quot;)) {
     while (false !== ($file = readdir($handle))) {
         if ($file != &quot;.&quot; &amp;&amp; $file != &quot;..&quot;) {
             // Check file time of directory
             $filetime = 
fileatime($_SESSION['filepathtoroot'].DIRECTORY_SEPARATOR.&quot;temp&quot;.DIRECTORY_SEPARATOR.$file);
             if ($filetime &lt; $timestamp) $oldsessionids[] = $file;
         }
     }
     closedir($handle);
}


The problem was that opening the directory for read changes the access 
time of all subdirectories. I changed the code to use filemtime and that 
  appears to work better and gives sufficient accuracy for my needs. I 
now have to add some code at significant points where the script checks 
when the login occured so that I don't end up writing to a directory 
that some other login just deleted. That should be easy enough by 
checking against my login table and forcing everyone to login again when 
their login was more than 24 hours ago.

I may make this more lenient/configurable as I can see some value for 
allowing someone to hanng around in the system for more than 24 hours 
assuming that the session lives that long, which I doubt.

Does anyone know for how long session data is kept when idling?


David

</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="022158.html">[nycphp-talk] filewhatevertime for Windows folder
</A></li>
	<LI>Next message: <A HREF="022163.html">[nycphp-talk] Stored MS Access procedures &gt; PHP/MySQL?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#22161">[ date ]</a>
              <a href="thread.html#22161">[ thread ]</a>
              <a href="subject.html#22161">[ subject ]</a>
              <a href="author.html#22161">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.nyphp.org/mailman/listinfo/talk">More information about the talk
mailing list</a><br>
</body></html>
